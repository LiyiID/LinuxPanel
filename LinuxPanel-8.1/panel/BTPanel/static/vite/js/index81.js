import{_ as e}from"./index52.js?v=1714377894636";import{_ as t}from"./index53.js?v=1714377894636";import{_ as a}from"./index39.js?v=1714377894636";import{_ as s}from"./index57.js?v=1714377894636";import{q as r,s as n,u as i}from"./element-lib.js?v=1714377894636";import{f as l,l as o,g as c,a2 as m,e as u,n as p,a as d,F as v}from"./main.js?v=1714377894636";import{_ as b}from"./index77.js?v=1714377894636";import{_ as f}from"./index58.js?v=1714377894636";import{_ as h}from"./index59.js?v=1714377894636";import{_ as g}from"./index45.js?v=1714377894636";import{_}from"./index60.js?v=1714377894636";import{b as x,H as y,e as k,A as C,v as S,h as j,j as L}from"./vue-lib.js?v=1714377894636";import{g as D,e as P,f as w}from"./index38.js?v=1714377894636";import{g as E,r as A,d as R}from"./index28.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{_ as B}from"./preload-helper.js?v=1714377894636";E();const V=({restoreBackEvent:e,deleteBackEvent:t})=>x([{label:"名称",prop:"name"},{label:"路径",prop:"filepath"},{label:"备份时间",prop:"mtime",render:function(e){return y("span",l(e.mtime))}},w({prop:"size"}),P([{onClick:e,title:"恢复"},{onClick:t,title:"删除"}])]),G=e=>o({isAsync:!0,component:()=>B((()=>import("./CloudServer.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]),import.meta.url),title:"远程数据库",area:86,compData:e,showFooter:!1}),T=e=>o({isAsync:!0,component:()=>B((()=>import("./AddRedis.js?v=1714377894636")),__vite__mapDeps([32,33,4,5,2,3,6,7,8,9,10,34,35,36,25,26,27,28,15,14]),import.meta.url),title:e?"编辑key":"添加key",area:42,compData:{...e},showFooter:!0});const $=p(k({__name:"index",setup(e){const{refs:{authType:t,mainHeight:a}}=c(),{getDbValue:s,checkDbStatus:r,getDbList:n,getServerList:i}=A(),{tableParam:l,redisStatus:p}=C(A()),{proxy:d}=L(),v=x(!1),b=x(String(l.value.db_idx)),f=x(0),h=x(!1),g=x([{active:!0,content:d.$t("BtnGroup.AddKey"),event:()=>{T()}},{content:d.$t("BtnGroup.RemoteServer"),event:()=>{G(l.value.serverList)}},{content:d.$t("BtnGroup.BackupList"),hide:()=>0!==f.value,event:()=>{o({isAsync:!0,component:()=>B((()=>import("./RedisBackList.js?v=1714377894636")),__vite__mapDeps([37,10,3,2,9,4,5,6,7,8,35,11,12,13,25,26,27,28,15,14,38,30,31,39,40,41,42,43,44,45,18,46,24]),import.meta.url),title:"备份列表",area:92})}}]),_=x([{content:d.$t("BtnGroup.ClearDatabase"),event:()=>{o({isAsync:!0,component:()=>B((()=>import("./ClearRedis.js?v=1714377894636")),__vite__mapDeps([47,4,5,2,3,6,7,8,9,10,48,34,36,25,26,27,28,15,14]),import.meta.url),title:"清空数据库",area:42,showFooter:!0})}}]);let k=[],w=0;const E=x([{label:"删除",value:"delete"}]),V=S({isRecurrence:!0,describe:{title:"批量删除数据库文件",th:"数据库名",message:"批量删除已选数据库文件，是否继续？",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>y("span",{class:0===k.length?"text-warning":k.includes(e.name)?"text-primary":"text-danger"},(()=>{if(0===k.length)return"等待执行";{let t=k.includes(e.name)?"执行成功":"执行失败";return w===2*k.length?(k=[],w=0):w++,t}})())}}),$=async e=>{try{T(e)}catch(t){}},N=async(e,t=!1)=>{"boolean"!=typeof t&&(t=!1);try{!t&&await d.$confirm({title:"删除键值",message:"是否删除【".concat(e.name,"】?"),icon:"warning"});const a=await R({data:JSON.stringify({key:e.name,db_idx:l.value.db_idx,sid:l.value.sid})});a.status&&t&&k.push(e.name),!t&&d.$message.request(a),!t&&s(),!t&&n()}catch(a){}},z=(({editDataEvent:e,deleteDataEvent:t})=>x([D(),{label:"键",prop:"name"},{label:"值",prop:"val"},{label:"数据类型",prop:"type"},{label:"数据长度",prop:"len"},{label:"有效期",prop:"endtime",render:function(e){return 0===e.endtime?y("span","永久"):y("span","".concat(e.endtime,"秒"))}},P([{onClick:e,title:"编辑"},{onClick:t,title:"删除"}])]))({editDataEvent:$,deleteDataEvent:N});return j((async()=>{var e;await i(),f.value=l.value.sid,(null==(e=l.value.serverList)?void 0:e.length)||(h.value=!0),h.value||(await r(),await n())})),{__sfc:!0,authType:t,mainHeight:a,getDbValue:s,checkDbStatus:r,getDbList:n,getServerList:i,tableParam:l,redisStatus:p,vm:d,tableLoad:v,activeName:b,selectValue:f,maskLayer:h,tableBtnGroup:g,tableBtnGroupRight:_,resList:k,index:w,batchGroup:E,batchConfig:V,pageChange:e=>{l.value.p=e,s()},sizeChange:e=>{l.value.limit=e,s()},batchEvent:(e,t,a)=>N(t,!0),searchSubmit:e=>{l.value.search=e,void 0===e&&(l.value.search=""),s()},editDataEvent:$,redisTabClick:e=>{var t;l.value.p=1;const a=null==(t=l.value.keyList[e.index])?void 0:t.id;l.value.db_idx=a,s()},deleteDataEvent:N,changeServer:async e=>{const t=d.$load("正在获取服务器数据信息，请稍候...");l.value.sid=Number(e),f.value=Number(e),await r(),await n(),t.close()},openAddServer:()=>{G(l.value.serverList)},installLocal:async()=>{const{data:e}=await m({sName:"redis"});u({name:null==e?void 0:e.name,type:null==e?void 0:e.type,pluginInfo:e})},tableColumn:z}}}),(function(){var l=this,o=l._self._c,c=l._self._setupProxy;return o("div",[o(_,{attrs:{visible:c.maskLayer,width:"52rem"}},[l._v(" 当前未安装Redis环境/远程数据库， "),o(d,{staticClass:"!text-[1.4rem]",on:{click:c.openAddServer}},[l._v("添加远程数据库")]),o(d,{staticClass:"!text-[1.4rem]",on:{click:c.installLocal}},[o(g),l._v("安装Redis环境")],1)],1),o(h,{scopedSlots:l._u([{key:"header-left",fn:function(){return[o("div",{staticClass:"flex items-center"},[o(f,{attrs:{group:c.tableBtnGroup}}),o("div",{staticClass:"bg-[#ececec] w-[1px] h-10 mx-[1.2rem]"}),o(f,{attrs:{group:c.tableBtnGroupRight}})],1)]},proxy:!0},{key:"header-right",fn:function(){return[o("div",{staticClass:"flex items-center mx-4x"},[o("span",{staticClass:"text-warning"},[o("i",{staticClass:"el-icon-info"}),l._v("当前所有操作都关联至 ")]),o(r,{staticClass:"w-[12rem] mx-4x",on:{change:c.changeServer},model:{value:c.selectValue,callback:function(e){c.selectValue=e},expression:"selectValue"}},l._l(c.tableParam.serverList,(function(e){return o(n,{key:e.ps,attrs:{label:e.ps,value:e.id}})})),1)],1),o("div",{staticClass:"flex items-center"},[o(v,{staticClass:"mr-4x",attrs:{size:"1.6",name:c.redisStatus.status?"icon-success":"icon-error"}}),o("div",{staticClass:"mr-[1.6rem] text-[1.2rem]"},[o("span",[l._v("状态：")]),o(d,{class:c.redisStatus.status?"":"!text-[#ef0808]"},[l._v(" "+l._s(c.redisStatus.status?"正常":c.redisStatus.msg)+" ")])],1)],1)]},proxy:!0},{key:"content",fn:function(){return[o(b,{attrs:{type:"card"},on:{"tab-click":c.redisTabClick},model:{value:c.activeName,callback:function(e){c.activeName=e},expression:"activeName"}},l._l(c.tableParam.keyList,(function(e,t){return o(i,{key:t,staticClass:"h-0 !p-0",attrs:{label:e.name+"【"+e.keynum+"】",name:String(e.id)}})})),1),o(s,{staticClass:"float-right mb-8x",attrs:{placeholder:"请输入键名称"},on:{clear:c.searchSubmit,search:c.searchSubmit},model:{value:c.tableParam.search,callback:function(e){l.$set(c.tableParam,"search",e)},expression:"tableParam.search"}}),o(a,{directives:[{name:"loading",rawName:"v-loading",value:c.tableLoad,expression:"tableLoad"}],ref:"redisTable",attrs:{"max-height":c.mainHeight-346,column:c.tableColumn,data:c.tableParam.valueList}})]},proxy:!0},{key:"footer-left",fn:function(){return[o(t,{attrs:{data:c.batchGroup,config:c.batchConfig,"batch-fn":c.batchEvent},on:{"handle-complete":function(e){return c.changeServer(c.selectValue)}}})]},proxy:!0},{key:"footer-right",fn:function(){return[o(e,{attrs:{total:c.tableParam.total,"current-page":c.tableParam.p,"page-size":c.tableParam.limit},on:{"update:currentPage":function(e){return l.$set(c.tableParam,"p",e)},"update:current-page":function(e){return l.$set(c.tableParam,"p",e)},"size-change":c.sizeChange,"current-change":c.pageChange}})]},proxy:!0}])})],1)}),[],!1,null,"14cd33a3",null,null).exports,N=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));export{N as i,V as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./CloudServer.js?v=1714377894636","./index118.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./index59.js?v=1714377894636","./mysql.store.js?v=1714377894636","./check.js?v=1714377894636","./element-lib.js?v=1714377894636","./index.vue_vue_type_style_index_0_lang.js?v=1714377894636","./index45.js?v=1714377894636","./element-ui.common.js?v=1714377894636","./date-util.js?v=1714377894636","./vdom.js?v=1714377894636","./index62.js?v=1714377894636","./cascader-panel.js?v=1714377894636","./index38.js?v=1714377894636","./index28.js?v=1714377894636","./index77.js?v=1714377894636","./element-lib.js?v=1714377894636","./index42.js?v=1714377894636","./database.popup.js?v=1714377894636","./confirm.js?v=1714377894636","./config.js?v=1714377894636","./AddRedis.js?v=1714377894636","./index85.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./RedisBackList.js?v=1714377894636","./mysql.api.js?v=1714377894636","./index52.js?v=1714377894636","./index53.js?v=1714377894636","./element-lib.js?v=1714377894636","./index57.js?v=1714377894636","./element-lib.js?v=1714377894636","./index58.js?v=1714377894636","./element-lib.js?v=1714377894636","./index60.js?v=1714377894636","./ClearRedis.js?v=1714377894636","./element-lib.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
