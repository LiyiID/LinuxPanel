import{_ as a}from"./index118.js?v=1714377894636";import{_ as e}from"./index52.js?v=1714377894636";import{_ as t}from"./index39.js?v=1714377894636";import{g as s,J as o,l as n,n as l,q as r,F as i}from"./main.js?v=1714377894636";import{_ as c}from"./index59.js?v=1714377894636";import{_ as m}from"./preload-helper.js?v=1714377894636";import{e as p,b as u,v as g,f as v,h as f,j as y}from"./vue-lib.js?v=1714377894636";import{g as d,B as h,C as _,D as b,E as w,F as j,G as x}from"./logs.table.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./request-lib.js?v=1714377894636";const D=l(p({__name:"WebLogAnalysis",props:{type:{default:"logs"},name:{default:""}},setup(a,{expose:e}){const t=a,{proxy:l}=y(),{refs:{webSiteName:r,webSiteLogTabActive:i}}=d(),{refs:{mainHeight:c}}=s(),p=u(""),D=u([]),S=u([]),P=u(""),L=g({p:1,row:10,path:""}),A=u(0),T=u(!1),C=u([{useHtml:!0,content:'日志安全分析：扫描网站(.log)日志中含有攻击类型的请求(类型包含：<span style="color:red">xss,sql,san,php</span>)'},{text:"分析的日志数据包含已拦截的请求"},{text:"如日志文件过大，扫描可能等待时间较长，请耐心等待"}]),E=async()=>{try{T.value=!0;const a=await _({siteName:p.value});if(!a.status)return T.value=!1,D.value=[],A.value=0,void l.$message.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:a.msg,type:"error",duration:0,showClose:!0});P.value=a.log_file,await N(),T.value=!1,L.path=P.value;const e=await b({...L});D.value=e.data.data,A.value=o(e.data.page)}catch(a){}},H=async(a,e)=>{n({title:"日志详情",area:72,isAsync:!0,compData:{row:a,type:e},component:()=>m((()=>import("./AnalysisDetail.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)})},N=async()=>{try{const a=await x({path:P.value});S.value=a}catch(a){}};v((()=>r.value),(()=>{p.value=r.value,"WebLogAnalysis"===i.value&&E()})),v((()=>i.value),(()=>{"WebLogAnalysis"===i.value&&E()}));const $=h({openDiaNum:H}),k=async()=>{await E()};return f((async()=>{p.value=r.value,"site"===t.type&&(p.value=t.name),await E()})),e({cutTab:k}),{__sfc:!0,props:t,vm:l,webSiteName:r,webSiteLogTabActive:i,mainHeight:c,name:p,tableData:D,scanData:S,logPath:P,tableParam:L,pagtTotal:A,loading:T,helpList:C,getLogs:E,logScan:async()=>{await l.$confirm({title:"日志扫描",icon:"warning",message:"建议在服务器负载较低时进行安全分析，本次将对【".concat(p.value,".log】文件进行扫描，可能等待时间较长，是否继续？")});const a=l.$load("正在扫描中...");try{const a=await w({path:P.value});if(!a.status)return l.$message.error(a.msg);const e=setInterval((async()=>{100===(await j({path:P.value})).msg&&(clearInterval(e),l.$message.success("扫描完成"),E(),N())}),1e3)}catch(e){}finally{a.close()}},openDiaNum:H,changePage:a=>{L.p=a,E()},changeSize:a=>{L.row=a,E()},openPeriodicScan:()=>{""!==P.value?n({title:"定期扫描",area:48,isAsync:!0,showFooter:!0,compData:{scan:S.value,refreshEvent:N,name:p.value},component:()=>m((()=>import("./PeriodicScan.js?v=1714377894636")),__vite__mapDeps([15,6,7,4,3,8,9,10,5,2,16,17,18,19,20,21,22,23,24,25,14]),import.meta.url)}):l.$message.error("配置文件丢失")},getScanData:N,controlColumn:$,cutTab:k}}}),(function(){var s=this,o=s._self._c,n=s._self._setupProxy;return o("div",{staticClass:"py-20x"},[o(c,{scopedSlots:s._u([{key:"header-left",fn:function(){return[o(r,{on:{click:n.logScan}},[s._v("日志扫描")]),o(r,{class:{"not-status":!Boolean(n.scanData.status)},attrs:{type:"default"},on:{click:n.openPeriodicScan}},[s._v("定期扫描 "),o(i,{attrs:{name:"icon-"+(Boolean(n.scanData.status)?"pause":"start"),size:"1.2"}})],1)]},proxy:!0},{key:"content",fn:function(){return[o(t,{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],attrs:{"max-height":n.mainHeight-416,column:n.controlColumn,data:n.tableData}})]},proxy:!0},{key:"footer-right",fn:function(){return[o(e,{attrs:{total:n.pagtTotal,"current-page":n.tableParam.p,"page-size":n.tableParam.row},on:{"current-change":n.changePage,"size-change":n.changeSize}})]},proxy:!0}])}),o(a,{attrs:{list:n.helpList}})],1)}),[],!1,null,"d05fae6d",null,null).exports;export{D as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./AnalysisDetail.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./vue-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./software2.js?v=1714377894636","./logs.table.js?v=1714377894636","./PeriodicScan.js?v=1714377894636","./element-lib.js?v=1714377894636","./index40.js?v=1714377894636","./element-lib.js?v=1714377894636","./config.js?v=1714377894636","./index85.js?v=1714377894636","./index46.js?v=1714377894636","./element-lib.js?v=1714377894636","./index.vue_vue_type_style_index_0_lang.js?v=1714377894636","./element-lib.js?v=1714377894636","./confirm.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
