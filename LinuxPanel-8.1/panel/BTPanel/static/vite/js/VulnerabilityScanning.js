import{g as s,aY as e,c0 as t,f as a,n as i,F as n,a as l,_ as c}from"./main.js?v=1714377894636";import{_ as r,L as o,C as m,D as p,E as u}from"./element-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import{e as v,b as d,v as f,j as _}from"./vue-lib.js?v=1714377894636";import{c as C}from"./firewall.popup.js?v=1714377894636";import{g as b}from"./site.store.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./check.js?v=1714377894636";const h=i(v({__name:"VulnerabilityScanning",props:{compData:{default:()=>({isSiteModule:!1})}},setup(i){const{refs:{authType:n}}=s(),{refs:{scanData:l}}=b(),{proxy:c}=_(),r=d(!0),o=d(!1),m=d({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),p=d(["1"]),u=d([]),v=f({4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]}),h=d("success"),x=d(!1);return{__sfc:!0,authType:n,scanDataStore:l,vm:c,contentShow:r,scanResShow:o,scanInfo:m,activeNames:p,tableData:u,tagType:v,scanLoad:h,loading:x,scanData:async()=>{if("ltd"!==n.value)return c.$message.error("抱歉！该功能为企业版专享功能！");h.value="loading",m.value.scanTitle="正在扫描中，请稍后...";try{x.value=!0;const{data:s}=await t();m.value.scanTitle="扫描完成",m.value.scanTime="扫描时间：".concat(a(s.time)),m.value.scanCheckButton="重新检测",r.value=!1,s.info.length?(o.value=!1,u.value=s.info,h.value="danger",m.value.scanCheckButton="重新检测",m.value.scanTitle="全部【".concat(s.site_num,"个】网站存在风险项<span class='text-danger'>").concat(s.loophole_num,"</span>个")):(o.value=!0,m.value.scanTitle="当前网站没有风险项"),!1!==(null==s?void 0:s.status)&&(l.value=s)}catch(s){h.value="success"}finally{x.value=!1}},onlineServiceDialog:e,safeScanAlertDialog:C}}}),(function(){var s=this,e=s._self._c,t=s._self._setupProxy;return e("div",{staticClass:"p-28x"},[e("div",{staticClass:"head mb-[4.2rem]"},[e("div",{staticClass:"scan-header flex flex-row flex-wrap items-center justify-between"},[e("div",{staticClass:"flex flex-row flex-wrap justify-center items-center"},["loading"===t.scanLoad?e("div",{staticClass:"relative scan-header-cont"},[t.loading?e("div",{staticClass:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"}):s._e(),e(n,{attrs:{name:"scanning-scan",size:"6"}})],1):s._e(),"success"===t.scanLoad?e(n,{attrs:{name:"scanning-success",size:"8"}}):s._e(),"danger"===t.scanLoad?e(n,{attrs:{name:"scanning-danger",size:"8"}}):s._e(),e("div",{staticClass:"scan-header-cont flex justify-between flex-col px-[2rem]"},[e("div",{staticClass:"scan-title text-[2rem] font-bold",domProps:{innerHTML:s._s(t.scanInfo.scanTitle)}}),e("div",{staticClass:"scan-subtitle text-[1.6rem] mt-12x"},[s._v(s._s(t.scanInfo.scanTime))])])],1),e("div",{staticClass:"scan-header-cont justify-end relative"},[e(l,{staticClass:"btlink setScanAlarm absolute top-[6.4rem] right-0",on:{click:function(s){return t.safeScanAlertDialog()}}},[s._v("自动扫描>>")]),e(r,{staticClass:"scan-btn h-[4rem] w-[12rem]",attrs:{type:"loading"===t.scanLoad||"danger"===t.scanLoad?"default":"primary",size:"small"},on:{click:t.scanData}},[e("span",{staticClass:"text-[1.5rem]"},[s._v(s._s(t.scanInfo.scanCheckButton))])]),"danger"===t.scanLoad?e(r,{staticClass:"scan-btn h-[4rem] w-[12rem]",attrs:{type:"primary",size:"small"},on:{click:function(s){return t.onlineServiceDialog()}}},[e("span",{staticClass:"text-[1.5rem]"},[s._v("立即修复")])]):s._e()],1)])]),e(o),e("div",{staticClass:"content"},[t.contentShow?e("div",{staticClass:"info"},[e("div",{staticClass:"webedit-con flex items-center justify-center"},[e(c,{class:s.compData.isSiteModule?"w-[34rem] mr-[4rem]":"max-w-[90rem] mr-[4rem]",attrs:{src:s.compData.isSiteModule?"preview/site_scanning.png":"/firewall/safe_detect_scanning.png"}}),e("div",{staticClass:"thumbnail-introduce mt-[0rem]"},[e("span",{staticClass:"text-[1.8rem] font-bold"},[s._v("漏洞扫描工具介绍：")]),e("ul",{staticClass:"block leading-[3rem] mx-[2rem] list-square mt-[2rem]",class:s.compData.isSiteModule?"text-[1.2rem]":"text-[1.6rem]"},[s._m(0),e("li",[s._v("可扫描网站中存在的漏洞")]),e("li",[s._v("提供修复/提供付费解决方案")])])])],1)]):e("div",{staticClass:"scan"},[t.scanResShow?e("div",{staticClass:"scan-success border-[0.1rem] p-[2rem] h-[49rem] border-[#e8e8e8] flex items-center justify-center"},[e("div",{staticClass:"flex flex-column items-center"},[e(c,{staticClass:"w-[34.0rem] h-[30.1rem]",attrs:{src:"/firewall/secure.png"}}),e("span",{staticClass:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"},[s._v("当前处于【安全状态】，请继续保持！")])],1)]):e("div",{staticClass:"scan-dangerous"},[s._m(1),e("div",{class:s.compData.isSiteModule?"overflow-auto h-[42rem]":""},[e(m,{attrs:{accordion:""},model:{value:t.activeNames,callback:function(s){t.activeNames=s},expression:"activeNames"}},s._l(t.tableData,(function(a,i){return e(p,{key:i},[e("template",{slot:"title"},[e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"w-[26rem]"},[e(u,{attrs:{type:a.cms.length>0?"warning":"success",effect:"dark"}},[s._v(" "+s._s(a.cms.length)+"项 ")]),e("span",{staticClass:"ml-12x"},[s._v(s._s(a.name))])],1),e("span",[s._v(s._s(a.cms_name+"--"+a.version_info))]),e("div",{staticClass:"text-[#666] text-[1.2rem] ml-[6rem]"},[s._v(" 无法自动修复，请手动处理或"),e(l,{on:{click:function(s){return s.stopPropagation(),t.onlineServiceDialog()}}},[s._v("联系人工")])],1)])]),e(m,{attrs:{accordion:""}},s._l(a.cms,(function(a,i){return e(p,{key:i},[e("template",{slot:"title"},[e("div",{staticClass:"flex items-center justify-between w-full"},[e("div",{staticClass:"flex items-center ml-12x"},[e(u,{attrs:{type:t.tagType[a.dangerous][0]}},[s._v(s._s(t.tagType[a.dangerous][1]))]),e("span",{staticClass:"text-[#999] ml-12x"},[s._v(s._s(a.ps))])],1),e(l,{staticClass:"mb-2x mr-16x"},[s._v("详情")])],1)]),e("div",{staticClass:"bg-[#f6f6f6] text-[#999] p-20x ml-12x"},[s._v(" 修复建议："+s._s(a.repair)+" ")])],2)})),1)],2)})),1)],1)])]),e("div",{staticClass:"mt-12x"},[e("span",[s._v("如需支持其他cms程序，请发帖反馈："),e(l,{attrs:{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"}},[s._v("https://www.bt.cn/bbs/thread-89149-1-1.html")])],1)])])],1)}),[function(){var s=this,e=s._self._c;return s._self._setupProxy,e("li",[s._v(" 可识别多款开源CMS程序，支持如下："),e("br"),s._v(" 迅睿CMS、pbootcms、苹果CMS、eyoucms、"),e("br"),s._v(" 海洋CMS、ThinkCMF、zfaka、dedecms、"),e("br"),s._v(" MetInfo、emlog、帝国CMS、discuz、"),e("br"),s._v(" Thinkphp、Wordpress、Z-Blog、极致CMS、"),e("br"),s._v(" ShopXO、HYBBS、ECShop、SchoolCMS、"),e("br"),s._v(" phpcms、likeshop、iCMS、WellCMS、"),e("br"),s._v(" chanzhiEPS、PHPOK、LaySNS、骑士CMS、"),e("br"),s._v(" openSNS、齐博CMS、ZZZCMS、prestashop、"),e("br"),s._v(" ThinkphpSHOP、DouPHP、cmseasy、"),e("br"),s._v(" piwigo、phpwind、行云海CMS ")])},function(){var s=this,e=s._self._c;return s._self._setupProxy,e("div",{staticClass:"flex items-center mb-20x text-[#333]"},[e("span",{staticClass:"w-[26rem]"},[s._v("网站")]),e("span",[s._v("类型")])])}],!1,null,"1eb6134e",null,null).exports;export{h as default};
