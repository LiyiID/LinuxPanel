import{_ as e}from"./index53.js?v=1714377894636";import{_ as t}from"./index39.js?v=1714377894636";import{_ as a}from"./index58.js?v=1714377894636";import{_ as n}from"./index59.js?v=1714377894636";import{e as o,b as r,v as i,H as s,h as l,j as c}from"./vue-lib.js?v=1714377894636";import{ar as m,as as p,at as d}from"./docker.api.js?v=1714377894636";import{m as u}from"./docker.table.js?v=1714377894636";import{q as f}from"./docker.popup.js?v=1714377894636";import{n as g}from"./main.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./check.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";const j=g(o({__name:"ContainerBackupsDialog",props:{compData:{default:()=>({})}},setup(e){const t=e,{proxy:a}=c(),n=r(t.compData.row),o=i({loading:!1,list:[]}),g=r([{active:!0,content:"容器备份",event:()=>h()}]),j=r([{label:"删除",value:"delete"}]),b=i({isRecurrence:!0,describe:{title:"批量删除容器备份",th:"文件名",message:"批量删除后备份文件将无法恢复，是否继续？",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>s("span",{class:0!==w.length||v?w.includes(e.name)?"text-primary":"text-danger":"text-warning"},(()=>{if(0!==w.length||v){let t=w.includes(e.name)?"执行成功":"执行失败";return C++,t}return"等待执行"})())}}),h=async()=>{try{const e=await m({container_id:n.value.id});e.status?(await y(),await f(!0),a.$message.success(e.msg)):a.$message.error(e.msg)}catch(e){}},_=async e=>{try{await a.$confirm({icon:"warning",title:"删除备份文件",width:"45rem",message:"删除[".concat(e.name,"]备份文件后，该备份文件将永久消失，是否继续操作？")});const t=await d({container_id:e.container_id,container_name:e.container_name,name:e.name});t.status?(await y(),a.$message.success(t.msg)):a.$message.error(t.msg)}catch(t){}},x=async e=>{window.open("/download?filename="+encodeURIComponent(e.filename))},y=async()=>{o.loading=!0;try{const{data:e}=await p({container_id:n.value.id});o.list=e}catch(e){}o.loading=!1};let w=[],v=!1,C=0;const k=async({container_id:e,container_name:t,name:a})=>{try{const{data:n}=await d({data:JSON.stringify({container_id:e,container_name:t,name:a})});if(n.status)return w.push(a),n;Promise.reject(n)}catch(n){Promise.reject(!1)}},B=u({downContainerFile:x,deleteContainerBackup:_});return l((()=>{y()})),{__sfc:!0,vm:a,props:t,row:n,tableData:o,tableBtnGroup:g,batchGroup:j,batchConfig:b,addBackup:h,deleteContainerBackup:_,downContainerFile:x,getContainerBackup:y,list:w,isComplete:v,index:C,batchDeleteData:k,handleBatch:e=>{v=!1,w=[],C=0},batchEvent:(e,t,a)=>{if("delete"===e)return k(t)},tableColumn:B}}}),(function(){var o=this,r=o._self._c,i=o._self._setupProxy;return r("div",{staticClass:"p-16x"},[r(n,{scopedSlots:o._u([{key:"header-left",fn:function(){return[r(a,{attrs:{group:i.tableBtnGroup}})]},proxy:!0},{key:"content",fn:function(){return[r(t,{directives:[{name:"loading",rawName:"v-loading",value:i.tableData.loading,expression:"tableData.loading"}],ref:"backupTable",attrs:{column:i.tableColumn,"max-height":"220",data:i.tableData.list,description:"备份列表为空","element-loading-text":"正在加载镜像列表，请稍后..."}})]},proxy:!0},{key:"footer-left",fn:function(){return[r(e,{attrs:{data:i.batchGroup,config:i.batchConfig,"batch-fn":i.batchEvent},on:{"handle-batch":i.handleBatch,"handle-complete":i.getContainerBackup}})]},proxy:!0}])})],1)}),[],!1,null,null,null,null).exports;export{j as default};
