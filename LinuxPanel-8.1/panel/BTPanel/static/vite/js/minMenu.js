import{_ as e}from"./index39.js?v=1714377894636";import{e as t,A as a,b as i,H as n,j as s}from"./vue-lib.js?v=1714377894636";import{a1 as l,n as o}from"./main.js?v=1714377894636";import{f as r,h as m}from"./config.js?v=1714377894636";import{_ as p}from"./index46.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";const d=o(t({__name:"minMenu",props:{compData:{default:()=>({})}},setup(e,{expose:t}){const o=e,d=l(),{routesMenu:u}=a(d),{proxy:c}=s(),h=i([]),g=i(!1),f=i([{label:"菜单栏目",prop:"title"},{label:"是否显示",showOverflowTooltip:!1,align:"right",render:(e,t)=>["首页","软件商店","面板设置","退出"].includes(e.title)?"不可操作":n(p,{attrs:{value:e.show,size:"mini"},on:{change:()=>{v(e)}}})}]),w=async()=>{try{g.value=!0;const e=await m(),t=e.data.find((e=>_(e.id)==o.compData.menu)),a=t.children.map((({id:e,show:a,title:i})=>{let n=e;return"proxy"===n&&(n="nginx"),{name:n,show:a,title:i,parentId:t.id,id:e}}));h.value=a;const i=e.data.map((({id:e,show:t,title:a,children:i})=>{let n=_(e);return i&&(i=i.map((t=>{let a=t.id;return"proxy"===a&&(a="nginx"),{...t,parentId:e,name:a}}))),{name:n,show:t,title:a,id:e,children:i}}));u.value=u.value.map(((e,t)=>(e.children&&e.children.length&&(e.children=e.children.map((e=>{const a=i[t].children.find((t=>t.name===e.name));return{...e,show:void 0!==a?a.show:e.show}}))),{...e,show:i[t].show}))),sessionStorage.setItem("MENU-LIST",JSON.stringify(i))}catch(e){}finally{g.value=!1}},_=e=>{var t;let a=null==(t=e.replace(/memu([A|_]?)/,"")||"home")?void 0:t.toLowerCase();return"dologin"===a&&(a="exit"),"btwaf"===a&&(a="waf"),a},v=async e=>{try{let t={hide_list:JSON.stringify([e.id])};e.parentId&&(t.site_menu=1);const a=await r(t);c.$message.request(a),await w()}catch(t){}},b=async()=>{await w()};return t({onOpen:b}),{__sfc:!0,props:o,globalStore:d,routesMenu:u,vm:c,menuList:h,loading:g,tableColumn:f,updateMenuItems:w,getName:_,handleMenuChange:v,onOpen:b}}}),(function(){var t=this._self._c,a=this._self._setupProxy;return t("div",{staticClass:"p-[1.6rem]"},[t(e,{directives:[{name:"bt-loading",rawName:"v-bt-loading",value:a.loading,expression:"loading"},{name:"bt-loading",rawName:"v-bt-loading:title",value:"正在加载菜单列表，请稍后...",expression:"'正在加载菜单列表，请稍后...'",arg:"title"}],attrs:{"max-height":"360","row-key":"id","tree-props":{children:"children"},column:a.tableColumn,data:a.menuList}})],1)}),[],!1,null,"02cd7f28",null,null).exports;export{d as default};
