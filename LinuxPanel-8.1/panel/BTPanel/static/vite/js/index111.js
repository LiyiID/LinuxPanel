import{_ as t}from"./index51.js?v=1714377894636";import{_ as e}from"./index52.js?v=1714377894636";import{_ as a}from"./index53.js?v=1714377894636";import{_ as r}from"./index39.js?v=1714377894636";import{_ as i}from"./index57.js?v=1714377894636";import{g as s,J as n,l as o,n as l,q as c}from"./main.js?v=1714377894636";import{_ as m}from"./index59.js?v=1714377894636";import{e as p,b as d,v as u,h as g,j as h,H as f}from"./vue-lib.js?v=1714377894636";import{g as b,u as v,e as y,t as j,a as x,b as _}from"./index35.js?v=1714377894636";import{r as w,p as E,g as k,t as D,q as S}from"./crontab.api.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index77.js?v=1714377894636";import"./index42.js?v=1714377894636";import"./index43.js?v=1714377894636";import"./upload.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./index61.js?v=1714377894636";const C=l(p({__name:"index",setup(t){const{proxy:e}=h(),{refs:{scriptLibraryData:a}}=b(),{refs:{authType:r,mainHeight:i}}=s(),l=d([]),c=u({p:1,rows:20,search:""}),m=d(0),p=d(!1),C=d([]);let L=[];const P=u({isRecurrence:!0,describe:{title:"批量删除任务",th:"任务名",message:"批量删除后不再执行任务规则，是否继续？",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:t=>{var e;return f("span",{class:0===L.length?"text-warning":1===(null==(e=L.find((e=>e.id===t.trigger_id)))?void 0:e.status)?"text-primary":"text-danger"},(()=>{var e;if(0===L.length)return"等待执行";return null==(e=L.find((e=>e.id===t.trigger_id)))?void 0:e.msg})())}}}),T=u({title:"任务编排-功能介绍",ps:"脚本库含有：服务管理、进程监控、告警通知、负载监控、网站监控等常用脚本任务，可以实现自动化的脚本定时执行、服务器状态监控和任务追踪功能。",source:22,desc:["脚本定时执行","监控服务器状态","任务追踪"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/crontab/crontab_trigger.png"}]}),H=d([{label:"删除",value:"delete"}]),$=async({trigger_id:t,name:e})=>{try{const a=await w({trigger_id:t});return L.push({id:t,status:a.status,name:e,msg:a.msg}),a}catch(a){}},q=async()=>{try{p.value=!0;const t=await E({data:JSON.stringify(c)});l.value=t.data.data,m.value=n(t.data.page)}catch(t){}finally{p.value=!1}},z=async()=>{try{const t=await k();C.value=t.data,a.value=t.data}catch(t){}},J=async({trigger_id:t,name:a})=>{let r;try{await e.$confirm({title:"执行脚本",width:"35rem",icon:"warning",message:"立即执行【".concat(a,"】中的脚本任务，执行过程可能等待时间较长，请耐心等待。是否继续？")}),r=e.$load(e.$t("正在执行脚本，请稍后..."));const{data:i}=await D({data:JSON.stringify({trigger_id:t})});let s="object"==typeof i.value?i.value.join("\n"):i.status&&i.value||i.msg;o({title:"执行结果",area:40,showFooter:!1,component:{render:t=>t("pre",{class:"min-h-[20rem] bg-[#333] overflow-auto text-white w-full break-all"},[s])}})}catch(i){}finally{r&&r.close()}},N=t=>{y(t)},G=t=>{j(C.value,t,(()=>{q()}))},O=t=>{const e=x({});_((async e=>(await S({trigger_id:t.trigger_id})).data),e)},B=async({trigger_id:t})=>{try{await e.$confirm({title:"删除任务",width:"35rem",icon:"warning",message:"删除后不再执行任务规则,是否继续操作？"});const a=await w({trigger_id:t});e.$message.request(a),q()}catch(a){}},F=v({executionEvent:J,showEvent:N,editEvent:G,openLogEvent:O,deleteDataEvent:B});return g((async()=>{await z(),q()})),{__sfc:!0,vm:e,scriptLibraryData:a,authType:r,mainHeight:i,tableData:l,tableParam:c,total:m,loading:p,scriptData:C,resList:L,batchConfig:P,productData:T,batchGroup:H,batchEvent:(t,e,a)=>$(e),delBackEvent:$,getTaskList:q,getScriptData:z,executionEvent:J,showEvent:N,editEvent:G,openLogEvent:O,deleteDataEvent:B,changePage:t=>{c.p=t,q()},changeSize:t=>{c.rows=t,q()},searchSubmit:t=>{c.search=t,q()},createTask:()=>{j(C.value,null,(()=>{q()}))},tableColumns:F}}}),(function(){var s=this,n=s._self._c,o=s._self._setupProxy;return n("div",["ltd"===o.authType?n(m,{scopedSlots:s._u([{key:"header-left",fn:function(){return[n(c,{on:{click:o.createTask}},[s._v("创建任务")])]},proxy:!0},{key:"header-right",fn:function(){return[n(i,{staticClass:"ml-12x",attrs:{placeholder:"请输入任务名称"},on:{search:o.searchSubmit,clear:o.searchSubmit}})]},proxy:!0},{key:"content",fn:function(){return[n(r,{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],attrs:{"max-height":o.mainHeight-216,"element-loading-text":"正在加载中..",column:o.tableColumns,data:o.tableData}})]},proxy:!0},{key:"footer-left",fn:function(){return[n(a,{attrs:{data:o.batchGroup,config:o.batchConfig,"batch-fn":o.batchEvent},on:{"handle-complete":o.getTaskList}})]},proxy:!0},{key:"footer-right",fn:function(){return[n(e,{attrs:{total:o.total,"current-page":o.tableParam.p,"page-size":o.tableParam.limit},on:{"current-change":o.changePage,"size-change":o.changeSize}})]},proxy:!0}],null,!1,764241565)}):n(t,{staticClass:"px-[20%] my-[8rem]",attrs:{data:o.productData}})],1)}),[],!1,null,"a6c821ca",null,null).exports;export{C as default};
