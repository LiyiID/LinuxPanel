import{z as s,A as t}from"./vue-lib.js?v=1714377894636";import{S as e,T as a,U as o,V as i,W as c,X as r,Y as n}from"./main.js?v=1714377894636";const p=s("HOME-STORE",{state:()=>({system:"",simpleSystem:"",runningDays:"0天",isBeta:!1,isUpgrade:!1,cloudBeta:!1,betaInfo:null,officialInfo:null,grayscale:1,updatePush:!1,modulePush:[],monitorRender:!1,isSetup:!1,siteTotal:0,ftpTotal:0,databaseTotal:0,riskWarnTotal:0,diskInfoList:[],diskQuota:[],memory:{memRealUsed:0,memTotal:0},network:{},iostat:{},cpu:{occupy:"",framework:"",coresOccupy:[0,0,0],cpuNumber:0,logicCores:0,cores:0,process:[0,0]},cpuTimes:{},load:{one:0,max:0,five:0,fifteen:0},specificResource:{cpuBaseInfo:{active_processes:0,cpu_name:"Common KVM processor * 2",load_avg:{},logical_cpu:0,num_phys_cores:0,physical_cpu:0,total_processes:0},cpuProcess:[],memProcess:[]},statePopoverTimr:0,overviewShowList:[],overviewTemplateList:[],refreshTime:0}),getters:{panelVersion:()=>window.vite_public_version,versionType(){return this.isBeta?"测试版":"正式版"},systemIcon(){var s;return this.system?null==(s=this.system.split(" ")[0])?void 0:s.toLowerCase():""}},actions:{async getSystemInfo(){try{const{data:s}=await e();this.setSystemInfo(s)}catch(s){}},setSystemInfo(s){const{site_total:t,ftp_total:e,database_total:a,disk:o,mem:i,network:c,iostat:r,cpu:n,cpu_times:p,load:u,down:l,up:m,downPackets:d,upPackets:h,downTotal:f,upTotal:y,system:w,simple_system:g,time:_}=s,v={ALL:{down:l,up:m,downPackets:d,upPackets:h,downTotal:f,upTotal:y},...c},T={occupy:n[0],cores:n[1],coresOccupy:n[2],framework:n[3],logicCores:n[4],cpuNumber:n[5],process:[p["活动进程数"],p["总进程数"]]};this.createDiskInfo(o),this.$patch({siteTotal:t,ftpTotal:e,databaseTotal:a,memory:i,network:v,iostat:r,cpu:T,simpleSystem:g,cpuTimes:p,load:u,system:w,runningDays:_,refreshTime:Date.now()})},createDiskInfo(s){const t=[],e=[];s.forEach(((s,a)=>{const{path:o,size:i}=s,c=parseFloat(i[3].substring(0,i[3].lastIndexOf("%"))),r="".concat(i[1]," / ").concat(i[0]);t.push({show:!1,data:s,info:{title:o,range:c,desc:r}}),e.push({diskName:o,diskQuota:Number.parseFloat(i[0].split("G")[0])})})),this.diskInfoList=t,this.diskQuota=e},async getUpdateInfo(s={}){try{const{status:t,msg:e}=await a(s);return"string"!=typeof e&&this.setUpdateInfo(e),e}catch(t){}},setUpdateInfo(s){const t=window.vite_public_version.split(".").pop(),e=parseInt(t).toString()===t&&2===t.length,{is_beta:a,version:i,beta:c,downUrl:r,updateMsg:n,uptime:p,grayscale_test:u}=s;this.$patch({cloudBeta:a,isBeta:e,betaInfo:c,officialInfo:{downUrl:r,updateMsg:n,version:i,uptime:p},isUpgrade:!o(this.panelVersion,e?c.version:i),grayscale:u})},async getUpdatePushInfo(s){try{const{data:{status:s,module:t}}=await i({id:"panel_update",name:"site_push"});this.$patch({updatePush:s,modulePush:t.split(",")})}catch(t){}},async getHomeProcessInfo(){try{const{data:{info:s,CPU_high_occupancy_software_list:t,memory_high_occupancy_software_list:e}}=await c();this.specificResource.cpuBaseInfo=s,this.specificResource.cpuProcess=t,this.specificResource.memProcess=e,this.specificResource.refresh=Date.now()}catch(s){}},async getOverviewData(){try{const{data:s}=await r();this.overviewShowList=s}catch(s){}},async getOverviewTemplateData(){try{let{data:s}=await n();this.overviewTemplateList=s}catch(s){}}}}),u=()=>{const s=p();return{refs:t(s),...s}};export{u as g};
