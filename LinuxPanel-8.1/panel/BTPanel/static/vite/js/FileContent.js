import{_ as t}from"./index120.js?v=1714377894636";import{f as a,a as e,n as s,q as o,b as i}from"./main.js?v=1714377894636";import{_ as n}from"./index39.js?v=1714377894636";import{_ as l}from"./index118.js?v=1714377894636";import{L as r}from"./element-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import{e as c,f as p,b as m,H as d,j as u}from"./vue-lib.js?v=1714377894636";import{cq as h,ai as f,cr as v,al as g}from"./site.store.js?v=1714377894636";import{a as y}from"./confirm.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./check.js?v=1714377894636";import"./config.js?v=1714377894636";const x=s(c({__name:"FileContent",props:{compData:{default:()=>({})}},setup(t,{expose:s}){const o=t,{proxy:i}=u();p((()=>o.compData),(()=>{k()}),{deep:!0});const n=m(""),l=m(!1),c=m(!1),x=m(!1),b=m(""),C=m(!1),j=m({}),w=m(!1),_=m([]),D=m([{label:"文件名",render:t=>d("span",[a(t)])},{label:"操作",align:"right",render:t=>d("div",[d(e,{on:{click:async()=>{try{const a=await h({filename:o.compData.path,history:t});b.value=a.data.data,j.value=t,x.value=!0}catch(a){}}}},["查看"]),d(r,{attrs:{direction:"vertical"}}),d(e,{on:{click:async()=>{T(t)}}},["恢复"])])}]),L=m({mode:"ace/mode/nginx",theme:"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!1,fontSize:"12px"}),S=m({mode:"ace/mode/nginx",theme:"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!0,fontSize:"12px"}),P=m([{text:"此处为站点主配置文件,若您不了解配置规则,请勿随意修改."}]),k=async()=>{try{l.value=!0;const{data:t}=await f({path:o.compData.path});n.value=t.data,l.value=!1,_.value=t.historys,x.value=!1}catch(t){}finally{l.value=!1}},T=async t=>{y({confirm:{title:"恢复历史文件",message:"是否恢复历史文件 ".concat(a(t)),icon:"warning"},loading:"正在恢复，请稍后...",request:async()=>await v({filename:o.compData.path,history:t}),complete:k})};return s({getConfigData:k}),{__sfc:!0,vm:i,props:o,staticContent:n,textLoading:l,otherSavePopup:c,historyPopup:x,historyText:b,historyLoading:C,itemData:j,tableLoad:w,tableData:_,tableColumn:D,config:L,historyConfig:S,helpList:P,getConfigData:k,saveData:async()=>{let t=i.$load("正在保存内容，请稍候...");try{const t=await g({data:n.value,encoding:"utf-8",path:o.compData.path});i.$message.msg({dangerouslyUseHTMLString:!0,message:t.msg,type:t.status?"success":"error",duration:t.status?2e3:0,showClose:!t.status}),k()}catch(a){}finally{t.close()}},recoverFile:T}}}),(function(){var a=this,e=a._self._c,s=a._self._setupProxy;return e("div",{staticClass:"h-full"},[e("div",[e("span",{staticClass:"my-4x text-[#666]"},[a._v("提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换")]),e(t,{directives:[{name:"loading",rawName:"v-loading",value:s.textLoading,expression:"textLoading"}],staticClass:"!h-[54rem] !w-full my-12x",attrs:{id:"configContent".concat(s.props.compData.index),"file-path":a.compData.path,config:s.config},model:{value:s.staticContent,callback:function(t){s.staticContent=t},expression:"staticContent"}}),e("div",[e(o,{on:{click:s.saveData}},[a._v("保存")]),e(o,{attrs:{type:"default"},on:{click:function(t){s.otherSavePopup=!0}}},[a._v("历史文件")])],1),e(l,{staticClass:"ml-20x mt-20x",attrs:{list:s.helpList}})],1),e(i,{attrs:{title:"配置文件历史版本",visible:s.otherSavePopup,area:42},on:{"update:visible":function(t){s.otherSavePopup=t}}},[e("div",{staticClass:"p-20x"},[e(n,{directives:[{name:"loading",rawName:"v-loading",value:s.tableLoad,expression:"tableLoad"}],attrs:{column:s.tableColumn,data:s.tableData}})],1)]),e(i,{attrs:{title:"查看文件历史版本",visible:s.historyPopup,area:62},on:{"update:visible":function(t){s.historyPopup=t}}},[e("div",{staticClass:"p-20x"},[e(o,{on:{click:function(t){return s.recoverFile(s.itemData)}}},[a._v("恢复文件")]),e(t,{directives:[{name:"loading",rawName:"v-loading",value:s.historyLoading,expression:"historyLoading"}],staticClass:"!h-[54rem] !w-full my-12x",attrs:{id:"history",config:s.historyConfig},model:{value:s.historyText,callback:function(t){s.historyText=t},expression:"historyText"}})],1)])],1)}),[],!1,null,"eda2a984",null,null).exports;export{x as default};
