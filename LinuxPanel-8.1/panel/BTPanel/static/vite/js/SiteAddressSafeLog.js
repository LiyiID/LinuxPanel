import{f as t,ei as a,n as s,a as e,q as l}from"./main.js?v=1714377894636";import{_ as i,a as o}from"./descriptions.js?v=1714377894636";import{e as r,j as c}from"./vue-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";const n=s(r({__name:"SiteAddressSafeLog",props:{compData:{default:{}}},setup(s){const e=s,{proxy:l}=c();return{__sfc:!0,props:e,vm:l,addIpWhite:()=>{e.compData.addIpWhiteEvent(e.compData.row)},addUrlWhite:async()=>{let t;try{await l.$confirm({title:"加入URL白名单",message:"加入URL白名单后此URL将不再进行防御，是否继续操作？",icon:"warning"}),t=l.$load("正在加入URL白名单...");const s=await a({url_rule:e.compData.row.url});l.$message.request(s)}catch(s){}finally{t.close()}},formatTime:t}}}),(function(){var t=this,a=t._self._c,s=t._self._setupProxy;return a("div",{staticClass:"p-20x"},[a(i,{staticClass:"mb-12x",attrs:{title:"",direction:"vertical",column:4,border:""}},[a(o,{attrs:{label:"时间"}},[t._v(t._s(s.formatTime(t.compData.row.addtime)))]),a(o,{attrs:{label:"用户Ip"}},[a(e,{on:{click:s.addIpWhite}},[t._v(t._s(t.compData.row.address))])],1),a(o,{attrs:{label:"触发函数"}},[t._v(t._s(t.compData.row.fun_name))]),a(o,{attrs:{label:"过滤器"}},[t._v(t._s(t.compData.row.intercept)+" ")])],1),a("div",{staticClass:"mb-12x flex flex-col"},[a("span",{staticClass:"detail-title"},[t._v("URL地址")]),a("span",{staticClass:"detail-content"},[t._v(" "+t._s(t.compData.row.url)+" ")])]),a("div",{staticClass:"mb-12x flex flex-col"},[a("span",{staticClass:"detail-title"},[t._v("User-Agent")]),a("span",{staticClass:"detail-content"},[t._v(" "+t._s(t.compData.row.data_info.data.request.headers["user-agent"])+" ")])]),a("div",{staticClass:"mb-12x flex flex-col"},[a("div",{staticClass:"flex justify-between items-end"},[a("span",{staticClass:"detail-title"},[t._v("传入值")]),a(l,{attrs:{type:"text"},on:{click:s.addUrlWhite}},[t._v("URL加白")])],1),a("span",{staticClass:"detail-content"},[t._v(" "+t._s(t.compData.row.data_info.data.args.join("\n"))+" ")])]),a("div",{staticClass:"mb-12x flex flex-col"},[a("span",{staticClass:"detail-title"},[t._v("调用栈")]),a("span",{staticClass:"detail-content"},[t._v(" "+t._s(t.compData.row.data_info.data.stack_trace.join("\n"))+" ")])])],1)}),[],!1,null,"8538c256",null,null).exports;export{n as default};
