import{_ as e}from"./index77.js?v=1714377894636";import{_ as t}from"./preload-helper.js?v=1714377894636";import{e as a,b as s,j as n,v as o,H as r,h as i,f as l}from"./vue-lib.js?v=1714377894636";import{_ as c}from"./index58.js?v=1714377894636";import{g as p,ak as u,al as m,am as f,an as d,n as v,a as _,ao as g,e as y,ap as h,aq as w,ar as b,o as x,as as P,l as C,at as E,au as j,av as D,aw as I,q as T,b as F}from"./main.js?v=1714377894636";import{_ as S}from"./index46.js?v=1714377894636";import{o as R,e as k,s as A,a as L}from"./firewall.popup.js?v=1714377894636";import{o as O}from"./index38.js?v=1714377894636";import{getFirewallStore as $}from"./firewall.store.js?v=1714377894636";import{a as N,b as V}from"./confirm.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{_ as q,a as G}from"./descriptions.js?v=1714377894636";import{_ as z}from"./index98.js?v=1714377894636";import{_ as J}from"./index53.js?v=1714377894636";import{_ as H}from"./index39.js?v=1714377894636";import{_ as B}from"./index57.js?v=1714377894636";import{_ as U}from"./index59.js?v=1714377894636";import{u as W}from"./firewall.table.js?v=1714377894636";import{c as M}from"./check.js?v=1714377894636";import{_ as K}from"./element-lib.js?v=1714377894636";import{_ as Q}from"./upload.js?v=1714377894636";import{t as X}from"./home.popup.js?v=1714377894636";const Y=v(a({__name:"SafetyHeader",props:{compData:{default:()=>{}}},setup(e){const t=e,{proxy:a}=n(),{refs:{isFirewall:o,isPing:r,logSize:i}}=$(),{refs:{logsPath:l}}=p(),c=s([{content:"清空",event:()=>{v(!0)}}]),v=async e=>{try{e&&await a.$confirm({icon:"question",iconColor:"#E6A23C",type:"calc",title:a.$t("safety.clearWebLogs"),width:"40rem",message:"清空Web日志后，网站访问数据将彻底删除，此操作不可逆，是否继续操作？"});const t=a.$load("正在清空Web日志，请稍后..."),s=await u();a.$message.success("清空Web日志成功"),i.value=s.data,t.close()}catch(t){}};return{__sfc:!0,vm:a,isFirewall:o,isPing:r,logSize:i,logsPath:l,props:t,tableBtnGroup:c,onChangeFirewall:async e=>{if(e)try{const{data:e}=await m(),t=e.filter((e=>0===e.status));if(t.length>=1)return void R(t)}catch(t){}N({confirm:{icon:"question",title:e?"启用系统防火墙":"停用系统防火墙",width:"40rem",iconColor:"#E6A23C",message:e?"推荐启用，启用系统防火墙后，可以更好的防护当前的服务器安全，是否继续操作？":"停用系统防火墙，服务器将失去安全防护，是否继续操作？"},loading:"正在"+(e?"启用系统防火墙":"停用系统防火墙")+"，请稍后...",request:async()=>await f({data:JSON.stringify({status:e?"start":"stop"})}),async complete(){o.value=e}})},onChangePing:async e=>{V({confirm:{icon:"question",title:e?"解Ping":"禁Ping",width:"40rem",iconColor:"#E6A23C",message:e?"禁PING后不影响服务器正常使用，但无法ping通服务器，您真的要禁PING吗？":"解除禁PING状态可能会被黑客发现您的服务器，您真的要解禁吗？"},loadingText:"正在"+(e?"解Ping":"禁Ping")+"，请稍后...",request:async()=>await d({status:e?"0":"1"}),refresh(){r.value=e}})},goFilePath:()=>{O({path:l.value})},getClearWebLogs:v}}}),(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{staticClass:"tab-header-operate"},[t("div",{staticClass:"mr-4"},[e._v("防火墙开关")]),t("div",[t(S,{attrs:{width:36},on:{change:a.onChangeFirewall},model:{value:a.isFirewall,callback:function(e){a.isFirewall=e},expression:"isFirewall"}})],1),t("div",{staticClass:"bg-[#ccc] w-[1px] h-2rem mx-8"}),t("div",{staticClass:"mr-4"},[e._v("禁ping")]),t("div",[t(S,{attrs:{width:36},on:{change:a.onChangePing},model:{value:a.isPing,callback:function(e){a.isPing=e},expression:"isPing"}})],1),t("div",{staticClass:"bg-[#ccc] w-[1px] h-2rem mx-8"}),t("div",[t("span",[e._v("Web日志：")]),t(_,{staticClass:"mr-4",on:{click:a.goFilePath}},[e._v(e._s(a.logsPath)),e._t("default")],2),t("span",[e._v(e._s(a.logSize))])],1),t(c,{staticClass:"ml-4",attrs:{group:a.tableBtnGroup}})],1)}),[],!1,null,null,null,null).exports;const Z=v(a({__name:"FirewallSafetyUpload",setup(e,{expose:t}){const{proxy:a}=n(),r=window.location.protocol+"//"+window.location.host+"/files?action=upload",i=o({f_size:0,f_path:"/www/server/panel/data/firewall",f_name:"",f_start:0}),l=s([]),c=[".json"].join(","),p={"x-http-token":window.vite_public_request_token},u=()=>{a.$refs.upload.submit()},m=()=>{a.$refs.open.$el.click()};return t({onConfirm:u,open:m,fileData:i}),{__sfc:!0,vm:a,uploadUrl:r,fileData:i,uploadFilesList:l,accept:c,uploadSuccess:()=>{a.$emit("upload-success")},uploadError:()=>{a.$message.error("导入失败")},header:p,uploadBefore:e=>{e.value=e,i.f_size=e.size,i.f_name=e.name,i.f_start=0},uploadChange:(e,t)=>{l.value=t},uploadProgress:(e,t,a)=>{i.f_start=e.percent,l.value=a.map((a=>(a.uid===t.uid&&(a.percentage=e.percent),a)))},removeFile:e=>{l.value=l.value.filter((t=>t.name!==e.name))},onConfirm:u,open:m}}}),(function(){var e=this._self._c,t=this._self._setupProxy;return e("div",[e(Q,{ref:"upload",staticClass:"upload-demo",attrs:{name:"blob",data:t.fileData,action:t.uploadUrl,headers:t.header,accept:t.accept,"on-error":t.uploadError,multiple:!1,"show-file-list":!1,"auto-upload":!0,"on-success":t.uploadSuccess,"on-progress":t.uploadProgress,"file-list":t.uploadFilesList,"on-change":t.uploadChange,"before-upload":t.uploadBefore}},[e(K,{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"open",attrs:{size:"small",type:"primary"}})],1)],1)}),[],!1,null,"9c78a3bb",null,null).exports;const ee=v(a({__name:"Port",setup(e){const{proxy:a}=n(),{getFirewalInfoEvent:l}=$(),{refs:{mainHeight:c,panelType:u,tencentCVM:m,tencentDataG:f}}=p(),d=s(!1),v=s([]),_=s(""),T=s(0),F=s({}),S=s(!1),R=o({processName:["进程名",""],processId:["进程pid",""],processTip:["启动命令",""]}),O=s(!1),N=o({p:1,limit:20}),V=s([{active:!0,content:"添加端口规则",event:()=>{k(H)}},{content:"导入规则",event:()=>{a.$refs.fileIpRef.open()}},{content:"导出规则",event:()=>{Q()}},{content:"同步端口配置",event:()=>{A(H)}},{content:"端口防扫描",event:async()=>{try{const{data:e}=await g({sName:"fail2ban"});e.setup?L("antiScan"):y({name:e.name,type:e.type,pluginInfo:e})}catch(e){}}}]),q=s([{label:"删除",value:"delete"}]);let G=[],z=0;const J=o({isRecurrence:!0,describe:{title:"批量删除端口",th:"端口",message:"批量删除选中的端口，是否继续操作？",propsValue:"ports"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>r("span",{class:0===G.length?"text-warning":G.includes(e.id)?"text-primary":"text-danger"},(()=>{if(0===G.length)return"等待执行";{let t=G.includes(e.id)?"执行成功":"执行失败";return z===2*G.length?(G=[],z=0):z++,t}})())}}),H=async(e=1)=>{var t,a;try{d.value=!0;const{data:s}=await h({data:JSON.stringify({...N,p:e,query:_.value})});if(O.value&&!m.value){const{data:e}=await w();e&&e.msg&&((null==(t=e.msg)?void 0:t.indexOf("密钥连接错误"))>-1||(null==(a=e.msg)?void 0:a.indexOf("获取失败"))>-1)?X({tips:"当前密钥错误，请重新绑定或取消当前密钥关联"}):e.FirewallRuleSet&&s.forEach((t=>{for(const a of e.FirewallRuleSet)if(a.Port===t.ports){t.type="tencent";break}}))}v.value=M(s,"array",[]),T.value=s.length}catch(s){}finally{d.value=!1}},B=async e=>{k(H,e)},U=async(e,t)=>{try{await a.$confirm({icon:"warning",title:"删除端口规则【"+e.ports+"】",width:"34rem",message:a.$t("safety.portRulesDeleteTip")});const t=a.$load("正在删除端口规则，请稍后..."),s=await P({data:JSON.stringify(e)});await a.$message.request(s),H(),l(),t.close()}catch(s){}},K=async e=>{try{const t="accept"!==e.types;await a.$confirm({icon:"warning",title:"修改端口规则策略【"+e.ports+"】",width:"34rem",message:a.$t("safety.policyUpdateTip",{name:t?"允许":"拒绝",str:t?"恢复正常访问":"拒绝外部访问"})}),e.types=t?"accept":"drop",e.source=e.address;const s=a.$load(a.$t("正在修改端口规则策略...",{name:"修改端口规则策略"})),n=await E({data:JSON.stringify(e)});await a.$message.request(n),H(),s.close()}catch(t){}},Q=async()=>{const e=await b({data:JSON.stringify({rule_name:"port_rule"})});e.data.status?window.open("/download?filename="+e.data.msg):a.$message.request(e)},Y=async e=>{F.value=e;try{const{data:t}=await D({data:JSON.stringify({port:e.ports})});R.processName[1]=t.process_name,R.processId[1]=t.process_pid,R.processTip[1]=t.process_cmd}catch(t){}S.value=!0},ee=e=>{C({title:"添加轻量云防火墙规则",isAsync:!0,area:54,component:()=>t((()=>import("./tencentForm.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url),showFooter:!0,compData:{port:e.ports,ip:e.address,remark:e.brief,refresh:H}})},te=W({updatePolicy:K,updataEvent:B,deleteRow:U,showPortDetails:Y,openTencentPort:ee}),ae=async()=>{var e;if(void 0===u.value)return O.value=!1;if((null==(e=u.value)?void 0:e.indexOf("tencent"))>=0){const{data:e}=await I();f.value=e,"cvm"!==e.server_type?m.value=!1:m.value=!0,O.value=!0}else O.value=!1};return i((async()=>{await ae(),H()})),{__sfc:!0,vm:a,getFirewalInfoEvent:l,mainHeight:c,panelType:u,tencentCVM:m,tencentDataG:f,loading:d,getData:v,search:_,completedTotal:T,rowData:F,showDetailPopup:S,process:R,tencentShow:O,tableParam:N,tableBtnGroup:V,batchGroup:q,resList:G,index:z,batchConfig:J,batchEvent:async(e,t,a)=>{try{const e=await P({data:JSON.stringify(t)});return e.status&&G.push(t.id),e}catch(s){}},changePage:e=>{N.p=e,H(e)},currentListPage:H,openTencentList:()=>{C({title:"添加轻量云防火墙规则",isAsync:!0,area:80,component:()=>t((()=>import("./tencentFirewallRule.js?v=1714377894636")),__vite__mapDeps([14,15,1,2,3,4,5,6,7,8,9,16,17,18,19,20,21,22,23,24,25,26,27]),import.meta.url),compData:{refresh:H}})},updataEvent:B,deleteRow:U,updatePolicy:K,ruleExport:Q,changeInputFile:async e=>{let t={rule_name:"port_rule",file_name:a.$refs.fileIpRef.fileData.f_name};const s=a.$load("正在导入规则，请稍后..."),n=await j({data:JSON.stringify(t)});n.status&&H(),s.close(),a.$message.request(n)},showPortDetails:Y,openTencentPort:ee,tableColumn:te,tencentCheck:ae,isRelease:x,FirewallSafetyUpload:Z}}}),(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{staticClass:"pt-20x"},[t(U,{scopedSlots:e._u([{key:"header-left",fn:function(){return[t(c,{attrs:{group:a.tableBtnGroup}}),t(a.FirewallSafetyUpload,{ref:"fileIpRef",on:{"upload-success":a.changeInputFile}})]},proxy:!0},{key:"header-right",fn:function(){return[!a.tencentShow||a.tencentCVM||a.isRelease?e._e():t("div",{staticClass:"mr-[1rem]"},[t(T,{attrs:{type:"default"},on:{click:a.openTencentList}},[e._v(" 轻量云防火墙规则 ")])],1),t(B,{attrs:{placeholder:"请输入端口"},on:{search:function(e){return a.currentListPage(1)},clear:function(e){return a.currentListPage(1)}},model:{value:a.search,callback:function(e){a.search=e},expression:"search"}})]},proxy:!0},{key:"content",fn:function(){return[t(H,{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],ref:"portTable",attrs:{column:a.tableColumn,data:a.getData,"max-height":a.mainHeight-340,description:"端口列表为空","element-loading-text":"正在加载端口列表，请稍后..."}})]},proxy:!0},{key:"footer-left",fn:function(){return[t(J,{attrs:{data:a.batchGroup,config:a.batchConfig,"batch-fn":a.batchEvent},on:{"handle-complete":function(e){return a.currentListPage(a.tableParam.p)}}})]},proxy:!0},{key:"footer-right",fn:function(){return[t(z,{attrs:{limit:a.tableParam.limit,p:a.tableParam.p,num:a.completedTotal},on:{click:a.changePage}})]},proxy:!0},{key:"popup",fn:function(){return[t(F,{attrs:{title:a.rowData.ports+"-端口使用进程详情",visible:a.showDetailPopup,area:42},on:{"update:visible":function(e){a.showDetailPopup=e}}},[t("div",{staticClass:"p-20x"},[t(q,{staticClass:"margin-top",attrs:{border:"",column:1,labelStyle:{width:"6rem"}}},e._l(a.process,(function(a,s){return t(G,{key:s},[t("template",{slot:"label"},[t("span",{staticClass:"!w-[6rem] inline-block"},[e._v(e._s(a[0])+" ")])]),e._v(" "+e._s(a[1]||"--")+" ")],2)})),1)],1)])]},proxy:!0}])})],1)}),[],!1,null,null,null,null).exports;const te=v(a({__name:"index",setup(e){var a,o,r,c;const{proxy:p}=n(),{refs:{firewalInfo:u},getFirewalInfoEvent:m}=$();l((()=>u.value),(e=>{var t,a,s,n;d.value[0].title="端口规则："+((null==(t=u.value)?void 0:t.port)||0),d.value[1].title="IP规则："+((null==(a=u.value)?void 0:a.ip)||0),d.value[2].title="端口转发："+((null==(s=u.value)?void 0:s.trans)||0),d.value[3].title="地区规则："+((null==(n=u.value)?void 0:n.country)||0)}));const f=s("portRules"),d=s([{title:"端口规则："+((null==(a=u.value)?void 0:a.port)||"获取中..."),type:"portRules",component:ee},{title:"IP规则："+((null==(o=u.value)?void 0:o.ip)||"获取中..."),type:"ipRules",component:()=>t((()=>import("./Ip.js?v=1714377894636")),__vite__mapDeps([28,29,2,1,3,4,5,6,7,8,9,30,31,15,16,32,17,18,19,20,26,21,22,23,24,25,27,33,34,35,36,12,13,37,38,39,40,41,42,43]),import.meta.url)},{title:"端口转发："+((null==(r=u.value)?void 0:r.trans)||"获取中..."),type:"portForward",component:()=>t((()=>import("./Forward.js?v=1714377894636")),__vite__mapDeps([44,29,2,1,3,4,5,6,7,8,9,30,31,15,16,32,17,18,19,20,26,21,22,23,24,25,27,33,34,35,36,12,13,37,38,39,40,41,42,43]),import.meta.url)},{title:"地区规则："+((null==(c=u.value)?void 0:c.country)||"获取中..."),type:"countryRegion",component:()=>t((()=>import("./CountryRegion.js?v=1714377894636")),__vite__mapDeps([45,29,2,1,3,4,5,6,7,8,9,30,31,15,16,32,17,18,19,20,26,21,22,23,24,25,27,33,34,35,36,12,13,37,38,39,40,41,42,43]),import.meta.url)}]);return i((()=>{m()})),{__sfc:!0,vm:p,firewalInfo:u,getFirewalInfoEvent:m,tabAvtive:f,tabComponent:d,cutTabs:e=>{e.name}}}}),(function(){var t=this._self._c,a=this._self._setupProxy;return t("div",{staticClass:"flex flex-col"},[t(Y,{attrs:{compData:a.firewalInfo}}),t(e,{attrs:{type:"navtwo",config:a.tabComponent},on:{"tab-click":a.cutTabs},model:{value:a.tabAvtive,callback:function(e){a.tabAvtive=e},expression:"tabAvtive"}})],1)}),[],!1,null,null,null,null).exports;const ae=v(a({__name:"index",setup(e){const{refs:{firewallTabActive:a},getFirewalInfoEvent:o,getLogSize:r}=$(),{proxy:c}=n(),p=s("safety"),u=s([{title:"系统防火墙",type:"safety",component:te},{title:"SSH管理",type:"ssh",component:()=>t((()=>import("./index92.js?v=1714377894636")),__vite__mapDeps([46,33,1,2,3,4,5,6,7,8,9,34,35,22,23,24,12,13,36,26,10,47,48,32,11,25]),import.meta.url)},{title:"安全检测",type:"safeDetect",component:()=>t((()=>import("./index93.js?v=1714377894636")),__vite__mapDeps([49,50,5,6,3,2,7,8,9,4,1,33,34,35,36,26,31]),import.meta.url)},{title:"违规词检测",type:"contDetect",component:()=>t((()=>import("./index94.js?v=1714377894636")),__vite__mapDeps([51,50,5,6,3,2,7,8,9,4,1,33,34,35,52,16,53,54,15,20,26,25,21,22,23,24,27,19]),import.meta.url)},{title:"PHP网站安全",type:"phpSite",component:()=>t((()=>import("./index95.js?v=1714377894636")),__vite__mapDeps([55,50,5,6,3,2,7,8,9,4,1,33,34,35,36,26]),import.meta.url)},{title:"入侵防御",type:"intrusion",component:()=>t((()=>import("./index96.js?v=1714377894636")),__vite__mapDeps([56,50,5,6,3,2,7,8,9,4,1,33,34,35,22,23,24,36,26,57,15,16,20,21,25,27,19]),import.meta.url)},{title:"系统加固",type:"system",component:()=>t((()=>import("./index97.js?v=1714377894636")),__vite__mapDeps([58,50,5,6,3,2,7,8,9,4,1,33,34,35,22,23,24,57,15,16,20,36,26,21,25,27,19]),import.meta.url)}]);return l((()=>a.value),(e=>{p.value=e})),i((async()=>{"safety"===a.value&&await r(),p.value=a.value})),{__sfc:!0,firewallTabActive:a,getFirewalInfoEvent:o,getLogSize:r,vm:c,tabAvtive:p,tabComponent:u,cutTabs:e=>{"safety"===e.name&&(o(),r()),a.value=e.name}}}}),(function(){var t=this._self._c,a=this._self._setupProxy;return t("section",[t(e,{attrs:{type:"nav",config:a.tabComponent},on:{"tab-click":a.cutTabs},model:{value:a.tabAvtive,callback:function(e){a.tabAvtive=e},expression:"tabAvtive"}})],1)}),[],!1,null,null,null,null).exports,se=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{Z as F,se as i};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./tencentForm.js?v=1714377894636","./element-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./vue-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./confirm.js?v=1714377894636","./config.js?v=1714377894636","./tencentFirewallRule.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./index58.js?v=1714377894636","./element-lib.js?v=1714377894636","./index45.js?v=1714377894636","./index59.js?v=1714377894636","./firewall.table.js?v=1714377894636","./index46.js?v=1714377894636","./element-lib.js?v=1714377894636","./index.vue_vue_type_style_index_0_lang.js?v=1714377894636","./firewall.popup.js?v=1714377894636","./check.js?v=1714377894636","./index38.js?v=1714377894636","./Ip.js?v=1714377894636","./index52.js?v=1714377894636","./index53.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index77.js?v=1714377894636","./element-lib.js?v=1714377894636","./index42.js?v=1714377894636","./firewall.store.js?v=1714377894636","./descriptions.js?v=1714377894636","./index98.js?v=1714377894636","./index57.js?v=1714377894636","./element-lib.js?v=1714377894636","./upload.js?v=1714377894636","./index62.js?v=1714377894636","./home.popup.js?v=1714377894636","./Forward.js?v=1714377894636","./CountryRegion.js?v=1714377894636","./index92.js?v=1714377894636","./index85.js?v=1714377894636","./index41.js?v=1714377894636","./index93.js?v=1714377894636","./index51.js?v=1714377894636","./index94.js?v=1714377894636","./index84.js?v=1714377894636","./index91.js?v=1714377894636","./echarts.js?v=1714377894636","./index95.js?v=1714377894636","./index96.js?v=1714377894636","./index118.js?v=1714377894636","./index97.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
