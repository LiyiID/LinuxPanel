import{e,v as t,j as a,b as s,h as r}from"./vue-lib.js?v=1714377894636";import{n as l,q as i,bD as n,a as o,bE as c,r as u,_ as m}from"./main.js?v=1714377894636";import{w as p,x as f,o as d,p as _}from"./element-lib.js?v=1714377894636";import{_ as v}from"./index44.js?v=1714377894636";import{g as b}from"./__commonjsHelpers__.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";const y=l({},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bt-msg-config"},[t("div",{staticClass:"p-4rem"},[t("div",{staticClass:"from"},[e._t("from")],2),t("div",{staticClass:"mt-2rem ml-2rem"},[e._t("tip")],2)]),t("div",[t("div",{staticClass:"el-dialog__footer"},[t("div",{staticClass:"footer"},[t(i,{attrs:{type:"cancel"},on:{click:function(t){return e.$emit("close")}}},[e._v("取消")]),t(i,{on:{click:function(t){return e.$emit("save")}}},[e._v("保存")])],1)])])])}),[],!1,null,null,null,null).exports;const h=l(e({__name:"RobotBase",props:["tipName","tipUrl","placeholder","type"],setup(e){const s=e,{proxy:r}=a(),l=t({name:"",url:""});return{__sfc:!0,props:s,vm:r,form:l,save:async()=>{let e;try{e=r.$load(r.$t("正在设置".concat(s.type,"信息配置，请稍后...")));let t=await n(s.type,{title:l.name,url:l.url,atall:"True"});r.$message.request(t),r.$emit("callback"),r.$emit("close")}catch(t){}finally{e&&e.close()}},MsgBase:y}}}),(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t(a.MsgBase,{on:{save:a.save,close:function(t){return e.$emit("close")}},scopedSlots:e._u([{key:"from",fn:function(){return[t(p,[t(f,{attrs:{label:"名称"}},[t(d,{attrs:{autofocus:"",placeholder:"机器人名称或备注"},model:{value:a.form.name,callback:function(t){e.$set(a.form,"name",t)},expression:"form.name"}})],1),t(f,{attrs:{label:"URL"}},[t(d,{staticClass:"url",attrs:{type:"textarea",rows:4,placeholder:"请输入".concat(e.placeholder,"机器人URL")},model:{value:a.form.url,callback:function(t){e.$set(a.form,"url",t)},expression:"form.url"}})],1)],1)]},proxy:!0},{key:"tip",fn:function(){return[t("ul",{staticStyle:{"list-style":"disc"}},[t("li",[t(o,{attrs:{href:e.tipUrl}},[e._v("如何创建"+e._s(e.tipName)+"机器人")])],1)])]},proxy:!0}])})}),[],!1,null,"d2efcdf2",null,null).exports;const g=l(e({__name:"Mail",setup(e){const{proxy:s}=a(),r=t({emailName:"",emailPass:"",emailHost:"",emailPort:"465"});return{__sfc:!0,vm:s,email:r,rules:{emailName:[{required:!0,message:"请输入发送人邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],emailPass:[{required:!0,message:"请输入SMTP密码",trigger:"blur"}],emailHost:[{required:!0,message:"请输入SMTP服务器",trigger:"blur"}],emailPort:[{required:!0,message:"请输入端口",trigger:"blur"}]},save:()=>{s.$refs.emailRef.validate((async e=>{if(e){let e;try{e=s.$load(s.$t("正在设置邮件信息配置，请稍后..."));let t=await n("mail",{send:"1",qq_mail:r.emailName,qq_stmp_pwd:r.emailPass,hosts:r.emailHost,port:r.emailPort});s.$message.request(t),s.$emit("callback"),s.$emit("close")}catch(t){}finally{e&&e.close()}}}))},MsgBase:y}}}),(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t(a.MsgBase,{on:{save:a.save,close:function(t){return e.$emit("close")}},scopedSlots:e._u([{key:"from",fn:function(){return[t(p,{ref:"emailRef",attrs:{model:a.email,rules:a.rules}},[t(f,{attrs:{label:"发送人邮箱",prop:"emailName"}},[t(d,{directives:[{name:"focus",rawName:"v-focus"}],model:{value:a.email.emailName,callback:function(t){e.$set(a.email,"emailName",t)},expression:"email.emailName"}})],1),t(f,{attrs:{label:"SMTP密码",prop:"emailPass"}},[t(d,{attrs:{type:"password"},model:{value:a.email.emailPass,callback:function(t){e.$set(a.email,"emailPass",t)},expression:"email.emailPass"}})],1),t(f,{attrs:{label:"SMTP服务器",prop:"emailHost"}},[t(d,{model:{value:a.email.emailHost,callback:function(t){e.$set(a.email,"emailHost",t)},expression:"email.emailHost"}})],1),t(f,{attrs:{label:"端口",prop:"emailPort"}},[t(d,{model:{value:a.email.emailPort,callback:function(t){e.$set(a.email,"emailPort",t)},expression:"email.emailPort"}})],1)],1)]},proxy:!0},{key:"tip",fn:function(){return[t("ul",{staticStyle:{"list-style":"disc"}},[t("li",[e._v("推荐使用465端口，协议为SSL/TLS")]),t("li",[e._v("25端口为SMTP协议，587端口为STARTTLS协议")]),t("li",[t(o,{attrs:{href:"https://www.bt.cn/bbs/thread-108097-1-1.html"}},[e._v("配置教程")])],1)])]},proxy:!0}])})}),[],!1,null,null,null,null).exports;var x={exports:{}};const w=b(x.exports=function(e){var t={};function a(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(s,r,function(t){return e[t]}.bind(null,r));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=135)}({0:function(e,t,a){function s(e,t,a,s,r,l,i,n){var o,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),s&&(c.functional=!0),l&&(c._scopeId="data-v-"+l),i?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=o):r&&(o=n?function(){r.call(this,this.$root.$options.shadowRoot)}:r),o)if(c.functional){c._injectStyles=o;var u=c.render;c.render=function(e,t){return o.call(t),u(e,t)}}else{var m=c.beforeCreate;c.beforeCreate=m?[].concat(m,o):[o]}return{exports:e,options:c}}a.d(t,"a",(function(){return s}))},135:function(e,t,a){a.r(t);var s={name:"ElAvatar",props:{size:{type:[Number,String],validator:function(e){return"string"==typeof e?["large","medium","small"].includes(e):"number"==typeof e}},shape:{type:String,default:"circle",validator:function(e){return["circle","square"].includes(e)}},icon:String,src:String,alt:String,srcSet:String,error:Function,fit:{type:String,default:"cover"}},data:function(){return{isImageExist:!0}},computed:{avatarClass:function(){var e=this.size,t=this.icon,a=this.shape,s=["el-avatar"];return e&&"string"==typeof e&&s.push("el-avatar--"+e),t&&s.push("el-avatar--icon"),a&&s.push("el-avatar--"+a),s.join(" ")}},methods:{handleError:function(){var e=this.error;!1!==(e?e():void 0)&&(this.isImageExist=!1)},renderAvatar:function(){var e=this.$createElement,t=this.icon,a=this.src,s=this.alt,r=this.isImageExist,l=this.srcSet,i=this.fit;return r&&a?e("img",{attrs:{src:a,alt:s,srcSet:l},on:{error:this.handleError},style:{"object-fit":i}}):t?e("i",{class:t}):this.$slots.default}},render:function(){var e=arguments[0],t=this.avatarClass,a=this.size;return e("span",{class:t,style:"number"==typeof a?{height:a+"px",width:a+"px",lineHeight:a+"px"}:{}},[this.renderAvatar()])}},r=s,l=a(0),i=Object(l.a)(r,void 0,void 0,!1,null,null,null);i.options.__file="packages/avatar/src/main.vue";var n=i.exports;n.install=function(e){e.component(n.name,n)},t.default=n}}));const S=l(e({__name:"WeChatAccount",setup(e){const{proxy:l}=a(),i=t({circleUrl:"",visible:!1,weChatAccount:!1,nickname:""});let n=t({nonce:0,res:{is_bound:0,is_subscribe:0,head_img:"",nickname:"",remaining:0},success:!1,status:!1}),o=s("");const u=async()=>{let e;try{e=l.$load(l.$t("正在获取信息配置，请稍后..."));const{data:t}=await c("wx_account","get_web_info");n=Object.assign(n,t)}catch(t){}finally{e&&e.close()}};return r((async()=>{await u()})),{__sfc:!0,vm:l,form:i,msgData:n,qrCode:o,getMsgFunData:u,getQrCode:async()=>{try{if(i.weChatAccount&&""!==o.value)return;const{data:e}=await c("wx_account","get_auth_url");o.value=e.res}catch(e){}},ok:async()=>{i.visible=!1,i.weChatAccount=!1,o.value="",await u()},setMsgFun:async()=>{let e;try{e=l.$load(l.$t("正在发送测试消息，请稍后..."));const t=await c("wx_account","push_data","发送测试消息");l.$message.request(t)}catch(t){}finally{e&&e.close()}},MsgBase:y}}}),(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",[t(a.MsgBase,{on:{save:function(t){return e.$emit("close")}},scopedSlots:e._u([{key:"from",fn:function(){return[t(p,{attrs:{"label-position":"right","label-width":"100px"}},[t(f,{attrs:{label:"绑定微信公众号"}},[t("div",{staticStyle:{display:"flex","flex-direction":"row","flex-wrap":"nowrap","justify-content":"flex-start","align-items":"center"}},[1===a.msgData.res.is_subscribe?t("span",{staticStyle:{color:"#20a53a"}},[e._v("已绑定")]):e._e(),0===a.msgData.res.is_subscribe?t("span",{staticStyle:{color:"red"}},[e._v("未绑定")]):e._e(),t(u,{attrs:{width:"160","popper-class":"white-popover"},model:{value:a.form.visible,callback:function(t){e.$set(a.form,"visible",t)},expression:"form.visible"}},[t(_,{staticStyle:{"box-shadow":"rgb(0 0 0 / 46%) 0px 0 2rem 0px"},attrs:{shadow:"always"}},[t("span",{staticStyle:{"font-size":"12px"}},[e._v("请扫码，进行绑定")]),t(m,{attrs:{src:"https://www.bt.cn/Public/img/bt_wx.jpg",custom:!0}}),t(i,{on:{click:a.ok}},[e._v("已扫码并完成绑定")])],1),t(i,{staticClass:"!ml-1.6rem",attrs:{slot:"reference"},slot:"reference"},[e._v("立即绑定")])],1)],1)]),t(f,{attrs:{label:"绑定微信帐号"}},[t("div",{staticStyle:{display:"flex","flex-direction":"row","flex-wrap":"nowrap","justify-content":"flex-start","align-items":"center"}},[1===a.msgData.res.is_bound&&""===a.msgData.res.nickname?t("span",{staticStyle:{color:"#20a53a"}},[e._v("已绑定")]):e._e(),1===a.msgData.res.is_bound?t("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"flex-start","align-items":"center"}},[t(w,{attrs:{size:"small",src:a.msgData.res.head_img}}),t("span",{staticClass:"ml-1.5rem"},[e._v(e._s(a.msgData.res.nickname))])],1):e._e(),0===a.msgData.res.is_bound?t("span",{staticStyle:{color:"red"}},[e._v("未绑定")]):e._e(),t(u,{attrs:{width:"190","popper-class":"white-popover"},model:{value:a.form.weChatAccount,callback:function(t){e.$set(a.form,"weChatAccount",t)},expression:"form.weChatAccount"}},[t(_,{staticStyle:{"box-shadow":"rgb(0 0 0 / 46%) 0px 0 2rem 0px"},attrs:{shadow:"always"}},[t("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[t("span",{staticStyle:{"font-size":"12px"}},[e._v("请扫码，进行绑定")]),t(v,{directives:[{name:"bt-loading",rawName:"v-bt-loading",value:""===a.qrCode,expression:"qrCode === ''"},{name:"bt-loading",rawName:"v-bt-loading:title",value:"正在获取二维码，请稍后....",expression:"'正在获取二维码，请稍后....'",arg:"title"},{name:"show",rawName:"v-show",value:""!==a.qrCode,expression:"qrCode !== ''"}],attrs:{value:a.qrCode,size:150}}),t(i,{on:{click:a.ok}},[e._v("已扫码并完成绑定")])],1)]),t(i,{staticClass:"!ml-1.6rem",attrs:{slot:"reference"},on:{click:a.getQrCode},slot:"reference"},[e._v(" "+e._s(1===a.msgData.res.is_bound?"更换微信账号":"立即绑定")+" ")])],1)],1)]),t(f,{attrs:{label:"今日剩余发送次数"}},[t("span",[e._v(e._s(a.msgData.res.remaining))]),t(i,{staticClass:"!ml-1.6rem",on:{click:a.setMsgFun}},[e._v("发送测试消息")])],1)],1)]},proxy:!0},{key:"tip",fn:function(){return[t("ul",{staticStyle:{"list-style":"disc"}},[t("li",[e._v("没有绑定微信公众号无法接收面板告警消息")]),t("li",[e._v("当前为体验版,限制每个宝塔账号发送频率100条/天")])])]},proxy:!0}])})],1)}),[],!1,null,"408a7938",null,null).exports;const $=l(e({__name:"index",props:{compData:{default:()=>({})}},setup(e){const t=e,{type:a,callback:s}=t.compData;return{__sfc:!0,props:t,type:a,callback:s,RobotBase:h,Mail:g,WeChatAccount:S}}}),(function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",["dingding"===a.type?t(a.RobotBase,{staticClass:"dingding",attrs:{placeholder:"钉钉","tip-name":"钉钉","tip-url":"https://www.bt.cn/bbs/thread-108081-1-1.html",type:"dingding"},on:{close:function(t){return e.$emit("close")},callback:a.callback}}):e._e(),"feishu"===a.type?t(a.RobotBase,{staticClass:"feishu",attrs:{placeholder:"飞书","tip-name":"飞书","tip-url":"https://www.bt.cn/bbs/thread-108274-1-1.html",type:"feishu"},on:{close:function(t){return e.$emit("close")},callback:a.callback}}):e._e(),"weixin"===a.type?t(a.RobotBase,{staticClass:"weixin",attrs:{placeholder:"企业微信","tip-name":"企业微信","tip-url":"https://www.bt.cn/bbs/thread-108116-1-1.html",type:"weixin"},on:{close:function(t){return e.$emit("close")},callback:a.callback}}):e._e(),"mail"===a.type?t(a.Mail,{on:{callback:a.callback,close:function(t){return e.$emit("close")}}}):e._e(),"wx_account"===a.type?t(a.WeChatAccount,{on:{save:function(t){return e.$emit("close")}}}):e._e()],1)}),[],!1,null,null,null,null).exports;export{$ as default};
