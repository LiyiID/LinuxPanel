import{_ as e}from"./index85.js?v=1714377894636";import{w as t,x as a}from"./element-lib.js?v=1714377894636";import{g as s,ao as r,e as o,p as l,d as i,ce as n,l as d,c7 as p,dp as m,cc as u,cd as c,cb as f,dq as v,n as w,b as y}from"./main.js?v=1714377894636";import{_ as b}from"./index51.js?v=1714377894636";import{_ as h}from"./index118.js?v=1714377894636";import{_ as x}from"./index39.js?v=1714377894636";import{_}from"./index58.js?v=1714377894636";import{_ as g}from"./index59.js?v=1714377894636";import{_ as j}from"./preload-helper.js?v=1714377894636";import{e as P,b as S,v as I,h as F,j as C}from"./vue-lib.js?v=1714377894636";import{n as D}from"./firewall.table.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./index46.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";import"./firewall.popup.js?v=1714377894636";import"./check.js?v=1714377894636";import"./index38.js?v=1714377894636";const E=w(P({__name:"SystemAccount",setup(e){const{proxy:t}=C(),{refs:{authType:a}}=s(),w=S(!1),y=S(""),b=S(!1),h=S(),x=S(!1),_=S([]),g=S(!1),P=S([]),E=S(!1),$=I({title:"SSH系统账号管理-功能介绍",ps:"SSH系统账号管理通常涉及到在服务器上创建、删除和管理SSH用户账户的过程。这些账户可以用于通过SSH（安全壳层）协议远程访问服务器。这种管理工作通常由系统管理员进行，以确保只有授权的用户可以访问服务器。",source:305,desc:["创建系统用户","修改系统用户密码","删除系统用户","记录日志","防入侵"],isInstall:E.value,tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/ssh_system_manage.png"}],pluginInfo:{}}),T=I({username:"",password:""}),U=S([{active:!0,content:"创建系统用户",event:()=>{b.value=!0}},{content:"堡塔防入侵",event:async()=>{try{const{data:e}=await r({sName:"bt_security"});e.setup?e.endtime<0?l({disablePro:!0,sourceId:305,plugin:!0}):i({pluginInfo:e}):o({name:e.name,type:e.type,pluginInfo:e})}catch(e){}}}]),k=S([{text:"开启防提权，系统会针对该用户操作命令进行限制，并记录跟踪"},{text:"不开启防提权，系统只针对该用户操作过的命令做记录跟踪"},{text:"目前防提权默认只针对www,redis,mysql操作引起的提权问题进行处理"},{color:"text-[#ef0808]",text:"消息推送需要更新至最新面板的版本(2020-06-17日之后安装的版本|或者2020-06-17日之后点击过修复面板)"}]),q=S([]),A=async e=>{try{const a=await n({user:e[0]});if(!a.data.length)return t.$message.error("当前暂无日志");q.value=[];for(let e=0;e<a.data.length;e++)q.value.push({title:a.data[e],key:a.data[e]});P.value={user:e[0],dateTime:a.data[0],dateOptions:q.value},d({title:"命令日志",area:72,isAsync:!0,component:()=>j((()=>import("./IntrusionOpenCommandLog.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url),compData:P.value})}catch(a){}},H=async e=>{try{await t.$confirm({icon:"warning",title:"删除[".concat(e[0],"]用户"),message:"危险操作，正在删除[".concat(e[0],"]用户，请在下方输入'确认删除'"),inputText:"确认删除",type:"input"});const a=await m({username:e[0]});t.$message.request(a)}catch(a){}},L=async(e,a,s)=>{let r=t.$load("正在"+(e?"开启":"关闭")+(3===s?"防入侵":"记录日志")+"，请稍后...");try{let o=null;3===s?o=await u(e,{user:a[0]}):5===s&&(o=await c(e,{uid:a[1]})),r.close(),t.$message.request(o),N()}catch(o){}finally{r.close()}},N=async()=>{var e;try{x.value=!0;const t=await f();if("ltd"!==a.value)return;if(t.status||"插件不存在!"!==t.msg)$.isInstall=!1,E.value=!1,_.value=null==(e=t.data)?void 0:e.system_user;else{const{data:e}=await r({sName:"bt_security"});$.pluginInfo=e,$.isInstall=!0,E.value=!0}}catch(t){}finally{x.value=!1}},O=D({logEvent:A,setPassEvent:e=>{P.value=e,w.value=!0},deleteEvent:H,changeStatusEvent:L});return F((()=>{N()})),{__sfc:!0,vm:t,authType:a,pwdPopup:w,newPwd:y,addUserPopup:b,sshAddUserRef:h,loading:x,tableData:_,formDisabled:g,rowData:P,isSetup:E,productData:$,addForm:T,tableBtnGroup:U,helpList:k,dateOptions:q,logEvent:A,confirmUserPwd:async()=>{try{const e=await p({username:P.value[0],password:y.value});t.$message.request(e),w.value=!1,y.value=""}catch(e){}finally{w.value=!1}},deleteEvent:H,changeStatusEvent:L,getSshUserList:N,submitAddform:async()=>{try{const e=await v(T);t.$message.request(e),b.value=!1,N()}catch(e){}},tableColumn:O}}}),(function(){var s=this,r=s._self._c,o=s._self._setupProxy;return r("div",{staticClass:"py-20x"},["ltd"!==o.authType||o.isSetup?r(b,{staticClass:"px-[20%] my-[8rem]",attrs:{data:o.productData}}):r("div",[r(g,{scopedSlots:s._u([{key:"header-left",fn:function(){return[r(_,{attrs:{group:o.tableBtnGroup}})]},proxy:!0},{key:"content",fn:function(){return[r(x,{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],ref:"table",attrs:{column:o.tableColumn,data:o.tableData,"max-height":"580",description:"列表为空","element-loading-text":"正在加载列表，请稍后..."}})]},proxy:!0}],null,!1,635473923)}),r(h,{staticClass:"ml-20x",attrs:{list:o.helpList,"list-style":"disc"}})],1),r(y,{attrs:{title:"修改密码",visible:o.pwdPopup,area:38,showFooter:""},on:{"update:visible":function(e){o.pwdPopup=e},confirm:o.confirmUserPwd}},[r("div",{staticClass:"p-20x flex items-center"},[s._v(" 新密码 "),r(e,{staticClass:"ml-12x",attrs:{isNull:!0,iconType:"refresh",placeholder:"请输入新密码"},model:{value:o.newPwd,callback:function(e){o.newPwd=e},expression:"newPwd"}})],1)]),r(y,{attrs:{title:"创建系统用户",visible:o.addUserPopup,showFooter:"",area:42},on:{"update:visible":function(e){o.addUserPopup=e},confirm:o.submitAddform}},[r("div",{staticClass:"p-20x"},[r(t,{ref:"sshAddUserRef",attrs:{model:o.addForm,disabled:o.formDisabled}},[r(a,{attrs:{label:"用户名"}},[r(e,{attrs:{placeholder:"请输入用户名"},model:{value:o.addForm.username,callback:function(e){s.$set(o.addForm,"username",e)},expression:"addForm.username"}})],1),r(a,{attrs:{label:"密码"}},[r(e,{attrs:{placeholder:"请输入密码",iconType:"refresh"},model:{value:o.addForm.password,callback:function(e){s.$set(o.addForm,"password",e)},expression:"addForm.password"}})],1)],1)],1)])],1)}),[],!1,null,"28673b21",null,null).exports;export{E as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./IntrusionOpenCommandLog.js?v=1714377894636","./index98.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index59.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
