import{w as e,x as t,q as r,s}from"./element-lib.js?v=1714377894636";import{cw as o,cx as l,cy as a,n as i}from"./main.js?v=1714377894636";import{_ as n}from"./index85.js?v=1714377894636";import{e as u,b as p,w as c,h as m,j as f}from"./vue-lib.js?v=1714377894636";import{b as y}from"./check.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{o as d}from"./confirm.js?v=1714377894636";import{getFirewallStore as b}from"./firewall.store.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./config.js?v=1714377894636";const v=i(u({__name:"FirewallEditCountryRegion",props:{compData:{default:()=>{}}},setup(e,{expose:t}){const r=e,{getFirewalInfoEvent:s}=b(),{proxy:i}=f(),n=p({country:["美国"],brief:"",types:"drop",ports:"",choose:"all"}),u=p([{title:"所有端口",key:"all"},{title:"指定端口",key:"point"}]),v=p(!1),F=p(),h=p([]),j=p([{title:"拒绝",key:"drop"}]),g={country:[{required:!0,message:"请选择国家",trigger:"change"}],ports:[{validator:(e,t,r)=>{if(!(t.length>0))return r(new Error("请输入源端口"));y(t)?r():r(new Error(i.$t("safety.portPlaceHolder")))},trigger:["input"]}]},k=async e=>{d({$refs:F.value,loading:v,request:async()=>{if(r.compData.selectOptions){let e={...n.value,id:r.compData.selectOptions.id,country:n.value.brief,brief:h.value.find((e=>e.title===n.value.brief)).key};return await o({data:JSON.stringify(e)})}return await l({data:JSON.stringify(n.value)})},async complete(){r.compData.refreshEvent(),s()}})},w=async()=>{try{const{data:e}=await a();for(let t=0;t<e.length;t++)h.value.push({title:e[t].CH,key:e[t].brief})}catch(e){}};return c((()=>{r.compData.selectOptions&&(Object.assign(n.value,r.compData.selectOptions),n.value.brief=r.compData.selectOptions.country)})),m((()=>{w()})),t({onConfirm:k}),{__sfc:!0,props:r,getFirewalInfoEvent:s,vm:i,ruleForm:n,chooseOptions:u,formDisabled:v,editIpRules:F,countryList:h,strategyOptions:j,rules:g,submitFrom:k,getCountryList:w}}}),(function(){var o=this,l=o._self._c,a=o._self._setupProxy;return l(e,{ref:"editIpRules",staticClass:"p-[2rem] addfrom",attrs:{model:a.ruleForm,disabled:a.formDisabled,rules:a.rules,"label-width":"5rem"}},[l(t,{attrs:{label:o.$t("safety.policy")}},[l(r,{staticClass:"w-[20rem]",model:{value:a.ruleForm.types,callback:function(e){o.$set(a.ruleForm,"types",e)},expression:"ruleForm.types"}},[l(s,{attrs:{label:"屏蔽",value:"drop"}})],1)],1),l(t,{attrs:{label:o.$t("safety.ports")}},[l(r,{staticClass:"w-[20rem]",model:{value:a.ruleForm.choose,callback:function(e){o.$set(a.ruleForm,"choose",e)},expression:"ruleForm.choose"}},o._l(a.chooseOptions,(function(e){return l(s,{key:e.key,attrs:{label:e.title,value:e.key}})})),1)],1),"point"===a.ruleForm.choose?l(t,{attrs:{label:o.$t("safety.specifiedPorts"),prop:"ports"}},[l(n,{attrs:{type:"number",min:"1",max:"65535",width:"20rem",placeholder:o.$t("safety.specifiedPortsPlaceHolder")},model:{value:a.ruleForm.ports,callback:function(e){o.$set(a.ruleForm,"ports",e)},expression:"ruleForm.ports"}})],1):o._e(),l(t,{attrs:{label:o.$t("safety.countryBrief"),prop:"brief"}},[o.compData.selectOptions?l(r,{staticClass:"w-[20rem]",model:{value:a.ruleForm.brief,callback:function(e){o.$set(a.ruleForm,"brief",e)},expression:"ruleForm.brief"}},o._l(a.countryList,(function(e){return l(s,{key:e.key,attrs:{label:e.title,value:e.title}})})),1):l(r,{staticClass:"w-[20rem]",attrs:{multiple:"","collapse-tags":""},model:{value:a.ruleForm.country,callback:function(e){o.$set(a.ruleForm,"country",e)},expression:"ruleForm.country"}},o._l(a.countryList,(function(e){return l(s,{key:e.key,attrs:{label:e.title,value:e.title}})})),1)],1)],1)}),[],!1,null,null,null,null).exports;export{v as default};
