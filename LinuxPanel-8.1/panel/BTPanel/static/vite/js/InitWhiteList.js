import{_ as e}from"./index118.js?v=1714377894636";import{g as t,dM as s,dN as i,dO as r,dP as a,dQ as l,n as o,q as m}from"./main.js?v=1714377894636";import{_ as n}from"./index39.js?v=1714377894636";import{_ as p}from"./index85.js?v=1714377894636";import{_ as c}from"./index59.js?v=1714377894636";import{t as d,u}from"./element-lib.js?v=1714377894636";import{e as h,v as w,b as f,h as x,j as y}from"./vue-lib.js?v=1714377894636";import{w as g,x as v}from"./firewall.table.js?v=1714377894636";import{a as _}from"./check.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{getFirewallStore as b}from"./firewall.store.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./index46.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";import"./firewall.popup.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./index45.js?v=1714377894636";const j=o(h({__name:"InitWhiteList",setup(e,{expose:o}){const{refs:{whiteList:m},getWhiteList:n}=b(),{refs:{mainHeight:p}}=t(),{proxy:c}=y(),d=w({type:"url",url:"",startIP:"",endIP:"",urlHelp:[{text:"例子1: bt.cn/admin/admin.php?system=abc 添加地址: ^/admin/admin.php"},{text:"例子2: bt.cn/admin/1 1 为可变 1-99 添加地址为: ^/admin/[1-99]"}],ipHelp:[{text:"添加某个IP：起始IP为192.168.10.6 结束IP为192.168.10.6"},{text:"添加IP段：起始IP为192.168.1.1 结束IP为192.168.1.254"}]}),u=async(e,t)=>{const s="url"===d.type?await r({index:t}):await a({index:t});s.status?(c.$message.success(s.msg),n()):c.$message.error(s.msg)},h=f("ip"===d.type?g({deleteWhite:u}):v({deleteWhite:u})),j=async()=>{await n()};return x((()=>{j()})),o({init:j}),{__sfc:!0,whiteList:m,getWhiteList:n,mainHeight:p,vm:c,whiteForm:d,typeToggle:()=>{switch(d.type){case"url":h.value=v({deleteWhite:u}),n();break;case"ip":h.value=g({deleteWhite:u}),n()}},addWhiteList:async()=>{switch(d.type){case"url":if(!d.url)return void c.$message.error("请输入URL地址");const e=await i({url_rule:d.url});e.status?(c.$message.success(e.msg),d.url="",n()):c.$message.error(e.msg);break;case"ip":if(!_(d.startIP)||!_(d.endIP))return void c.$message.error("IP地址格式不正确");const t=await s({start_ip:d.startIP,end_ip:d.endIP});t.status?(c.$message.success(t.msg),d.startIP="",d.endIP="",n()):c.$message.error(t.msg)}},deleteWhite:u,clerAllWhite:async()=>{try{await c.$confirm({title:"清空白名单",message:"是否清空白名单？",icon:"warning"});const e=await l({type:d.type+"_white"});n(),c.$message.request(e)}catch(e){}},tableColumn:h,init:j}}}),(function(){var t=this,s=t._self._c,i=t._self._setupProxy;return s("div",{staticClass:"flex w-full p-20x"},[s(d,{staticClass:"w-[10rem]",attrs:{"tab-position":"left"},on:{"tab-click":i.typeToggle},model:{value:i.whiteForm.type,callback:function(e){t.$set(i.whiteForm,"type",e)},expression:"whiteForm.type"}},[s(u,{attrs:{label:"URL白名单",name:"url"}}),s(u,{attrs:{label:"IP白名单",name:"ip"}})],1),s(c,{staticClass:"flex-1 ml-20x",scopedSlots:t._u([{key:"header-left",fn:function(){return[s("div",{directives:[{name:"show",rawName:"v-show",value:"url"===i.whiteForm.type,expression:"whiteForm.type === 'url'"}],staticClass:"flex items-center"},[s(p,{staticClass:"mr-[1rem]",attrs:{width:"30rem",placeholder:"URL地址，例如：/admin/update"},model:{value:i.whiteForm.url,callback:function(e){t.$set(i.whiteForm,"url",e)},expression:"whiteForm.url"}}),s(m,{attrs:{title:"添加"},on:{click:i.addWhiteList}},[t._v("添加")])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"ip"===i.whiteForm.type,expression:"whiteForm.type === 'ip'"}],staticClass:"flex items-center"},[s(p,{attrs:{width:"25rem",placeholder:"起始IP地址"},model:{value:i.whiteForm.startIP,callback:function(e){t.$set(i.whiteForm,"startIP",e)},expression:"whiteForm.startIP"}}),s(p,{staticClass:"ml-[.5rem] mr-[1rem]",attrs:{width:"25rem",placeholder:"结束IP地址"},model:{value:i.whiteForm.endIP,callback:function(e){t.$set(i.whiteForm,"endIP",e)},expression:"whiteForm.endIP"}}),s(m,{attrs:{title:"添加"},on:{click:i.addWhiteList}},[t._v("添加")])],1)]},proxy:!0},{key:"header-right",fn:function(){},proxy:!0},{key:"content",fn:function(){return[s(n,{directives:[{name:"loading",rawName:"v-loading",value:i.whiteList.loading,expression:"whiteList.loading"}],ref:"Table",attrs:{column:i.tableColumn,data:"url"===i.whiteForm.type?i.whiteList.urlList:i.whiteList.ipList,description:"暂无数据","max-height":i.mainHeight-360,"element-loading-text":"正在加载列表，请稍后..."}})]},proxy:!0},{key:"footer-left",fn:function(){return[s("div",[s(m,{attrs:{type:"default"},on:{click:i.clerAllWhite}},[t._v("清空")]),s(e,{staticClass:"mt-20x ml-20x",attrs:{list:"ip"===i.whiteForm.type?i.whiteForm.ipHelp:i.whiteForm.urlHelp,"list-style":"disc"}})],1)]},proxy:!0},{key:"footer-right",fn:function(){},proxy:!0},{key:"popup",fn:function(){},proxy:!0}])})],1)}),[],!1,null,"eaeb52e1",null,null).exports;export{j as default};
