import{_ as t}from"./index118.js?v=1714377894636";import{_ as e}from"./index46.js?v=1714377894636";import{n as a,l as s,b as o}from"./main.js?v=1714377894636";import{_ as i}from"./index58.js?v=1714377894636";import{e as r,v as n,b as l,h as m,j as p,I as u}from"./vue-lib.js?v=1714377894636";import{g as c}from"./index28.js?v=1714377894636";import{t as d,i as f,d as b}from"./database.popup.js?v=1714377894636";import{k as v,l as j,n as y,o as x}from"./mysql.store.js?v=1714377894636";import{b as _}from"./database.table.js?v=1714377894636";import h from"./MysqlTool.js?v=1714377894636";import{w,x as g,q as D,s as P}from"./element-lib.js?v=1714377894636";import S from"./SetPwd.js?v=1714377894636";import{D as C}from"./index131.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./index77.js?v=1714377894636";import"./index42.js?v=1714377894636";import"./check.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./index39.js?v=1714377894636";import"./index85.js?v=1714377894636";import"./index53.js?v=1714377894636";import"./index59.js?v=1714377894636";import"./index61.js?v=1714377894636";import"./confirm.js?v=1714377894636";import"./config.js?v=1714377894636";import"./index52.js?v=1714377894636";import"./index57.js?v=1714377894636";import"./index54.js?v=1714377894636";import"./index56.js?v=1714377894636";import"./index43.js?v=1714377894636";import"./index60.js?v=1714377894636";const B=a(r({__name:"MongoDbPermission",props:{compData:{default:{}}},setup(t,{expose:e}){const a=t,{proxy:s}=p(),o=n({permission:[]}),i=l([{label:"数据库所有者",value:"dbOwner"},{label:"读取数据",value:"read"},{label:"读取和写入数据",value:"readWrite"},{label:"用户管理员",value:"userAdmin"}]),r=async()=>{try{const t=await v({data:JSON.stringify({user_name:a.compData.name})},"mongodb");let e=[];o.permission=t.data.roles.map((t=>{e.push(t)})),o.permission=e}catch(t){}},u=async t=>{try{const e=await j({data:JSON.stringify({user_name:a.compData.name,db_permission:o.permission})},"mongodb");s.$message.request(e),t()}catch(e){}};return m((()=>{r()})),e({onConfirm:u}),{__sfc:!0,vm:s,props:a,ruleForm:o,permissionOptions:i,onOpen:r,onSubmit:u}}}),(function(){var t=this,e=t._self._c,a=t._self._setupProxy;return e("div",{staticClass:"p-16x"},[e(w,{ref:"permissionForm",staticClass:"m-16x",attrs:{model:a.ruleForm,"label-width":"5rem"}},[e(g,{attrs:{label:t.$t("DataBase.VisitPermission"),prop:"permission"}},[e(D,{staticClass:"w-[32rem]",attrs:{multiple:"",placeholder:"请选择"},model:{value:a.ruleForm.permission,callback:function(e){t.$set(a.ruleForm,"permission",e)},expression:"ruleForm.permission"}},t._l(a.permissionOptions,(function(t){return e(P,{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)],1)}),[],!1,null,null,null,null).exports;const k=a(r({__name:"index",setup(t){const{refs:{tableParam:e,mongodbPwd:a,tabActive:o}}=c(),{proxy:i}=p(),r=l(!1),n=l([{text:"安全认证：开启后访问数据需要使用帐号和密码"}]),v=l(!1),j=l([{content:i.$t("BtnGroup.SafeCertification"),event:()=>{r.value=!0}}]),w=l([{label:"同步数据库",value:"Synchronization",event:()=>{}},{label:"备份数据库",value:"BackDatabase",event:()=>{}},{label:"删除数据库",value:"delete",isRefBatch:!0,event:()=>{}}]),g=t=>{s({title:"设置数据库"+t.name+"密码",area:53,component:S,compData:t,showFooter:!0})},D=async(t,e)=>{"back"==e&&d(t),"import"==e&&f(t)},P=async t=>{let e=[];e.push(t.id),b(e,"single")},k=async()=>{try{const t=await x();v.value="disabled"!==t.data.authorization,a.value=t.data}catch(t){}},E=async t=>{s({title:o.value+"工具箱【"+t.name+"】",area:78,component:h,compData:t,showFooter:!1})},F=t=>{s({title:"设置数据库"+t.name+"权限",area:53,component:B,compData:t,showFooter:!0})},O=_({editPasswordEvent:g,deleteDataEvent:P,setBackupEvents:D,permissionEvent:F,toolEvents:E});return m((async()=>{try{await k()}catch(t){}})),u((()=>{})),{__sfc:!0,tableParam:e,mongodbPwd:a,tabActive:o,vm:i,safetyPopup:r,safetyHelpList:n,transformSafety:v,tableBtnGroup:j,tableBatchData:w,swapSafetyValue:async()=>{const t=i.$load("正在设置安全状态....");try{const t=await y({data:JSON.stringify({status:v.value?"1":"0"})});if(a.value.authorization=v.value?"enabled":"disabled",i.$message.request(t),!t.status)return void(v.value=!v.value)}catch(e){}finally{t.close()}},editPasswordEvent:g,setBackupEvents:D,deleteDataEvent:P,checkSafely:k,toolEvents:E,permissionEvent:F,tableColumn:O,DatabaseView:C}}}),(function(){var a=this,s=a._self._c,r=a._self._setupProxy;return s("div",{staticClass:"relative"},[s(r.DatabaseView,{attrs:{databaseType:"MongoDB",tableBatch:r.tableBatchData,tableData:r.tableParam.databaseList,tableColumn:r.tableColumn},scopedSlots:a._u([{key:"btn-left",fn:function(){return[s(i,{attrs:{group:r.tableBtnGroup}})]},proxy:!0}])}),s(o,{attrs:{title:"安全认证",visible:r.safetyPopup,area:40},on:{"update:visible":function(t){r.safetyPopup=t}}},[s("div",{staticClass:"p-20x"},[s("div",{staticClass:"flex items-center"},[s("span",{staticClass:"mr-8x"},[a._v("安全认证：")]),s(e,{attrs:{width:36,change:r.swapSafetyValue},model:{value:r.transformSafety,callback:function(t){r.transformSafety=t},expression:"transformSafety"}})],1),s(t,{staticClass:"ml-16x mt-20x",attrs:{list:r.safetyHelpList,"list-style":"disc"}})],1)])],1)}),[],!1,null,null,null,null).exports;export{k as default};
