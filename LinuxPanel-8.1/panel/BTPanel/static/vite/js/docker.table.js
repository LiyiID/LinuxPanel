import{b as t,H as e}from"./vue-lib.js?v=1714377894636";import{i}from"./locales-lib.js?v=1714377894636";import{c as a,K as n,f as s,a as o,$ as l,o as r,H as p,a0 as c}from"./main.js?v=1714377894636";import{E as m,N as d,O as u,M as k}from"./element-lib.js?v=1714377894636";import{g as b,e as D,a as h}from"./index38.js?v=1714377894636";import{K as C}from"./docker.api.js?v=1714377894636";import{e as y}from"./element-ui.common.js?v=1714377894636";const v=t=>{const a=t.prop||"ps";return{label:i.t("Ps"),prop:a,width:t.width?t.width:200,isCustom:!t.noCustom,render:n=>{if(void 0===n[a])return e("div",{class:"loading",directives:[{name:"loading",value:!0}]});const s={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return n[a]=n[a].replace(/&(lt|gt|nbsp|amp|quot);/gi,(function(t,e){return s[e]})),e("input",{attrs:{type:"text",value:n[a],class:"bt-table-input w-full",title:"点击修改备注，失去焦点后自动保存",placeholder:t.noPlace?"":"".concat(i.t("ClickEditPs"))},on:{blur:e=>{if(n[a]===e.target.value)return!1;n[a]=e.target.value,t.edit?t.edit(n):f(n,t.table)}}})}}},f=async({id:t,ps:e},i)=>{const a=p.load("正在修改备注信息，请稍后...");try{const{data:a}=await c({id:t,table:i,ps:e});p.request(a)}catch(n){}finally{a.close()}},g=t=>{if(null==t)return"格式错误";let e=t.indexOf("T"),i=t.indexOf("Z"),a=t.substr(0,e)+" "+t.substr(e+1,i-e-1);let n=new Date(Date.parse(a)).getTime();return n/=1e3,n+=28800,s(n)},W=({deleteDataEvent:a})=>t([b(),{label:i.t("Docker.netName"),prop:"name",minWidth:100},{label:i.t("Docker.device"),prop:"driver",minWidth:100,isCustom:!0},{label:i.t("Docker.netCode"),prop:"subnet",minWidth:100,isCustom:!0},{label:i.t("Docker.gateway"),prop:"gateway",minWidth:100,isCustom:!0},{label:i.t("Docker.tag"),prop:"labels",minWidth:100,isCustom:!0,render:t=>{if(!t.labels)return e("span","");const i=(Object.entries(t.labels)||[]).map((t=>"".concat(t[0],":").concat(t[1])));return e("span",{title:i.join("\n")},i.join(","))}},{label:i.t("Docker.creatTime"),prop:"time",minWidth:100,isCustom:!0,render:t=>e("span",{},g(t.time))},D([{onClick:a,title:i.t("Delete")}])]),w=({deleteDataEvent:a})=>t([b(),{label:i.t("Docker.SVolume"),prop:"Name",minWidth:100},{label:i.t("Docker.HPoint"),prop:"Mountpoint",minWidth:100,isCustom:!0},{label:i.t("Docker.OContainer"),prop:"container",minWidth:100,isCustom:!0},{label:i.t("Docker.device"),prop:"Driver",minWidth:100,isCustom:!0},{label:i.t("Docker.creatTime"),prop:"CreatedAt",minWidth:100,isCustom:!0},{label:i.t("Docker.tag"),prop:"Labels",minWidth:100,isCustom:!0,render:t=>{if(!t.Labels)return e("span","");const i=(Object.entries(t.Labels)||[]).map((t=>"".concat(t[0],":").concat(t[1])));return e("span",{title:i.join("\n")},i.join(","))}},D([{onClick:a,title:i.t("Delete")}])]),E=({editDataEvent:e,deleteDataEvent:a})=>t([b(),{label:i.t("Docker.URL"),prop:"url",minWidth:100},{label:i.t("Docker.user"),prop:"namespace",minWidth:100,isCustom:!0},{label:i.t("Docker.stashName"),prop:"name",minWidth:100,isCustom:!0},v({table:"images",prop:"remark"}),D([{onClick:e,isHide:t=>"docker官方库"===t.name,title:i.t("Docker.edit")},{onClick:a,isHide:t=>"docker官方库"===t.name,title:i.t("Delete")}])]),x=({pushDataEvent:s,exportDataEvent:o,deleteDataEvent:l})=>t([b(),{label:i.t("Docker.ID"),prop:"id"},{label:i.t("Docker.mirrorName"),prop:"name",minWidth:100,isCustom:!0},{label:i.t("Docker.size"),prop:"size",width:100,isCustom:!0,render:t=>a(t.size)},{label:i.t("Docker.creatTime"),prop:"time",width:140,isCustom:!0,render:t=>e("span",{},g(t.time))},{label:"使用镜像的容器",prop:"used",isCustom:!0,render:t=>1!==t.used?e("span",{},"--"):n(t.containers)&&t.containers.length>0?e("span",{},t.containers.map((t=>e(m,{class:"mr-1",props:{type:"success",size:"mini"}},t.container_name)))):e("span",{},"--")},D([{onClick:s,title:i.t("Docker.push")},{onClick:o,title:i.t("Docker.export")},{onClick:l,title:i.t("Delete")}])]),_=({editDataEvent:e,pullDataEvent:a,deleteDataEvent:n})=>t([b(),{label:i.t("Docker.templateName"),prop:"name",minWidth:100},{label:i.t("Docker.path"),prop:"path",minWidth:100,isCustom:!0},{label:i.t("Ps"),prop:"remark",minWidth:200,isCustom:!0},D([{onClick:e,title:i.t("Docker.edit")},{onClick:a,width:60,title:i.t("Docker.pullMirror")},{onClick:n,title:i.t("Delete")}])]),j=({editDataEvent:a,ListDataEvent:n,deleteDataEvent:o,setStatusEvent:l})=>t([b(),{label:i.t("Docker.ComposeName"),prop:"name",minWidth:100},{label:i.t("Docker.status"),prop:"run_status",minWidth:100,isCustom:!0,render:t=>{let i=[],a=[];return"running"===t.run_status?(a=["运行中",e("span",{class:"iconfont icon-start"},null)],i=[{title:"暂停",key:"pause"},{title:"重启",key:"restart"},{title:"停止",key:"stop"},{title:"强制停止",key:"kill"}]):"exited"===t.run_status?(a=["已停止",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"启动",key:"start"}]):(a=["已暂停",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"恢复",key:"unpause"},{title:"强制停止",key:"kill"}]),e(k,{on:{command:e=>l(t,e)}},[e("span",{class:"running"==t.run_status?"text-[#20a53a]":"text-[#ff0000]"},a),e(d,{slot:"dropdown"},i.map((t=>e(u,{props:{command:t.key}},t.title))))])}},{label:i.t("Docker.ContainerNum"),prop:"container",minWidth:100,isCustom:!0,render:t=>t.num?e("span",{},t.num):0==t.num?e("span",{},"0"):e("span",{},"加载中...")},{label:i.t("Docker.lanuchTime"),prop:"time",minWidth:100,isCustom:!0,render:t=>e("span",{},s(t.time))},{label:i.t("Ps"),prop:"remark",minWidth:200,isCustom:!0},D([{onClick:n,width:60,title:i.t("Docker.ContainerList")},{onClick:a,title:"编辑"},{onClick:o,title:i.t("Delete")}])]),N=({changeStatusEvent:e,editGroupEvent:i,deleteGroupEvent:a})=>t([b(),{label:"分组名称",prop:"group_name",minWidth:100},h({event:e,data:["未启动","运行中"]}),D([{onClick:i,title:"编辑"},{onClick:a,title:"删除"}])]),P=({changeStatusEvent:a,deleteGroupEvent:n})=>t([b(),{label:"容器名称",prop:"project_name",minWidth:100},{label:i.t("Docker.status"),prop:"status",width:70,isCustom:!0,render:t=>{let i=[],n=[];return"running"===t.status?(n=["运行中",e("span",{class:"iconfont icon-start"},null)],i=[{title:"停止",key:"stop"},{title:"重启",key:"restart"},{title:"强制停止",key:"kill"},{title:"暂停",key:"pause"}]):"exited"===t.status?(n=["已停止",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"启动",key:"start"},{title:"重启",key:"restart"}]):(n=["已暂停",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"重启",key:"restart"},{title:"恢复",key:"unpause"},{title:"强制停止",key:"kill"}]),e(k,{on:{command:e=>a(t,e)}},[e("span",{class:"running"==t.status?"text-[#20a53a]":"text-[#ff0000]"},n),e(d,{slot:"dropdown"},i.map((t=>e(u,{props:{command:t.key}},t.title))))])}},D([{onClick:n,title:"删除"},{render:t=>e("i",{class:"icon-drag cursor-move mover iconfont align-middle",props:{title:"拖拽排序"}})}],{fixed:!1})]),T=({terminalEvent:a,logDataEvent:n,deleteDataEvent:s,conDetailEvent:c,setStatusEvent:m,setStatusTitle:h,openContainerBackups:f,changeTaskTopEvent:W,moreEvent:w})=>t([b(),{label:i.t("Docker.ContainerName"),prop:"name",render:t=>e(o,{on:{click:()=>{c(t)}}},t.name)},{label:"容器ID",prop:"id",isCustom:!0,width:120,render:t=>e(y.Tooltip,{attrs:{placement:"top"}},[e("div",{class:"w-[100px] h-full",on:{click:()=>l({value:t.id})}},[t.id.slice(0,12)]),e("div",{slot:"content"},[t.id])])},{label:"备份",width:60,isCustom:!1,render:t=>t.hasOwnProperty("backup_count")?e(o,{props:{type:t.backup_count>0?"primary":"warning"},on:{click:()=>{f(t)}}},[t.backup_count>0?"有(".concat(t.backup_count,")"):"无备份"]):e("div",{class:"loading",directives:[{name:"loading",value:!0}]})},{label:i.t("Docker.status"),renderHeader:()=>e("div",{class:"flex items-center flex-nowrap"},["",e(k,{on:{command:t=>h(t)}},[e("span",{class:"text-[1.2rem]"},["状态",e("i",{class:"el-icon-arrow-down el-icon--right"})]),e(d,{slot:"dropdown"},[{title:"全部",key:"all"},{title:"正在运行",key:"running"},{title:"暂停",key:"paused"},{title:"停止",key:"exited"}].map((t=>e(u,{props:{command:t.key}},t.title))))])]),prop:"status",width:80,isCustom:!0,render:t=>{let i=[],a=[];return"running"===t.status?(a=["运行中",e("span",{class:"iconfont icon-start"},null)],i=[{title:"停止",key:"stop"},{title:"重启",key:"restart"},{title:"强制停止",key:"kill"},{title:"暂停",key:"pause"}]):"exited"===t.status?(a=["已停止",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"启动",key:"start"},{title:"重启",key:"restart"}]):(a=["已暂停",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"重启",key:"restart"},{title:"恢复",key:"unpause"},{title:"强制停止",key:"kill"}]),e(k,{on:{command:e=>m(t,e)}},[e("span",{class:"running"==t.status?"text-[#20a53a]":"text-[#ff0000]"},a),e(d,{slot:"dropdown"},i.map((t=>e(u,{props:{command:t.key}},t.title))))])}},{label:i.t("Docker.mirror"),prop:"image",minWidth:100,isCustom:!0},{label:i.t("Docker.IP"),prop:"ip",minWidth:60,isCustom:!1,render:t=>e("span",{},"".concat(t.ip.length>0?t.ip[0]:""))},{label:"CPU / 内存",prop:"cpu_mem",isCustom:!1,render:t=>"running"===t.status?void 0===t.cpu_usage||void 0===t.mem_percent?e("div",{class:"loading h-[4.6rem]",directives:[{name:"loading",value:!0}]}):e(y.Tooltip,{attrs:{placement:"top"}},[e("div",{class:"w-[100px]"},[e("div",{class:"flex items-center justify-between"},[e("span",{class:"w-[3rem] inline-block"},["cpu："]),e(y.Progress,{class:"w-[7rem] ml-[1rem]",attrs:{percentage:Number(t.cpu_usage)||0,"show-text":!1}})]),e("div",{class:"flex items-center justify-between"},[e("span",{class:"w-[3rem] inline-block"},["内存："]),e(y.Progress,{class:"w-[7rem] ml-[1rem]",attrs:{percentage:Number(t.mem_percent)||0,"show-text":!1}})])]),e("div",{slot:"content"},["CPU：",t.cpu_usage,"%",e("br"),"内存：",t.mem_percent,"%"])]):e("div",{class:"h-[4.6rem] flex items-center"},["--"])},{label:i.t("Docker.port"),prop:"ports",minWidth:100,isCustom:!0,render:t=>{const i=Object.entries(t.ports)||[];let a="";return i.forEach((t=>{t[1]&&(a+="".concat(t[1][0].HostPort,"--\x3e").concat(t[0]," "))})),e("span",{},a)}},{label:i.t("Docker.lanuchTime"),prop:"created_time",width:130,isCustom:!1,render:t=>e("span",{},g(t.created_time))},v({edit:async t=>{try{const e=await C({data:JSON.stringify({id:t.id,remark:t.remark})});p.request(e)}catch(e){}},noPlace:!0,noCustom:!0,prop:"remark",table:"containers",width:200}),D([{onClick:c,title:"管理"},{onClick:n,title:i.t("Docker.log")},{onClick:s,title:i.t("Delete")},{onClick:w,isMore:!0,menu:[{key:"terminal",title:i.t("Docker.terminal")},{key:"reName",title:i.t("Docker.reName")},{key:"realMonitor",title:i.t("Docker.realMonitor")},{key:"proxyDetails",title:"反向代理",isHide:()=>r},{key:"dir",title:i.t("Docker.dir")}]}])]),O=()=>t([{label:i.t("Docker.dataVolume"),prop:"Source",minWidth:100},{label:i.t("Docker.conDir"),prop:"Destination",minWidth:100}]),S=({deleteDataEvent:e})=>t([{label:i.t("Docker.netName"),prop:"name",minWidth:100},{label:i.t("Docker.ipAddress"),prop:"IPAddress",minWidth:100},{label:i.t("Docker.gateway"),prop:"Gateway",minWidth:100},{label:i.t("Docker.MACAddress"),prop:"MacAddress",minWidth:100},D([{onClick:e,width:60,title:i.t("Docker.looutNet")}])]),H=({terminalEvent:a,dirEvent:n,logEvent:s,deleteDataEvent:o,setStatusEvent:l})=>t([{label:i.t("Docker.ContainerName"),prop:"name",minWidth:100},{label:i.t("Docker.status"),prop:"status",minWidth:100,isCustom:!0,render:t=>{let i=[],a=[];return"running"===t.status?(a=["运行中",e("span",{class:"iconfont icon-start"},null)],i=[{title:"停止",key:"stop"},{title:"重启",key:"restart"},{title:"强制停止",key:"kill"},{title:"暂停",key:"pause"}]):"exited"===t.status?(a=["已停止",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"启动",key:"start"},{title:"重启",key:"restart"}]):(a=["已暂停",e("span",{class:"iconfont icon-stop"},null)],i=[{title:"重启",key:"restart"},{title:"恢复",key:"unpause"},{title:"强制停止",key:"kill"}]),e(k,{on:{command:e=>l(t,e)}},[e("span",{class:"running"==t.status?"text-[#20a53a]":"text-[#ff0000]"},a),e(d,{slot:"dropdown"},i.map((t=>e(u,{props:{command:t.key}},t.title))))])}},{label:i.t("Docker.mirror"),prop:"image",minWidth:100,isCustom:!0},{label:i.t("Docker.IP"),prop:"ip",minWidth:100,isCustom:!0,render:t=>e("span",{},t.ip[0])},{label:i.t("Docker.port"),prop:"ports",minWidth:100,isCustom:!0,render:t=>{const i=Object.entries(t.ports)||[];let a="";return i.forEach((t=>{t[1]&&(a+="".concat(t[1][0].HostPort,"--\x3e").concat(t[0]," "))})),e("span",{},a)}},D([{onClick:a,title:i.t("Docker.terminal")},{onClick:n,title:i.t("Docker.dir")},{onClick:s,title:i.t("Docker.log")},{onClick:o,title:i.t("Delete")}])]),M=()=>t([b(),{label:i.t("Docker.ComposeTemName"),prop:"project_name",minWidth:100},{label:i.t("Docker.path"),prop:"conf_file",minWidth:100},{label:i.t("Ps"),prop:"remark",minWidth:100}]),z=({pullImages:i})=>t([{label:"镜像名",prop:"name"},{label:"Start数",prop:"star_count",width:70},{label:"来源",prop:"is_official",width:60,render:t=>e("span",{},t.is_official?"官方":"非官方")},{label:"描述/说明",prop:"description"},D([{onClick:i,title:"拉取"}])]),A=({downContainerFile:i,deleteContainerBackup:n})=>t([b(),{label:"文件名",prop:"name",minWidth:140},{label:"存储位置",prop:"filename",minWidth:180,isCustom:!0},{label:"文件大小",prop:"size",minWidth:86,isCustom:!0,render:t=>a(t.size)},{label:"备份时间",prop:"addtime",minWidth:120,isCustom:!0,render:t=>e("span",{},t.addtime)},D([{onClick:i,title:"下载"},{onClick:n,title:"删除"}])]);export{x as a,j as b,_ as c,W as d,w as e,E as f,H as g,N as h,P as i,M as j,O as k,S as l,A as m,z as s,T as u};
