import{g as e,a5 as a,n as t,a as s}from"./main.js?v=1714377894636";import{q as n,s as l}from"./element-lib.js?v=1714377894636";import{e as i,b as o,Y as u,w as c,h as r,j as f}from"./vue-lib.js?v=1714377894636";import{g as p,a as g}from"./config.js?v=1714377894636";const v=t(i({__name:"index",props:{value:{default:()=>""},needAll:{type:Boolean}},emits:["update:value","change"],setup(t,{emit:s}){const n=t,{proxy:l}=f(),{refs:{pushConfigInfo:i},getPushConfigInfo:v}=e(),d=o(!1),h=u(n,"value");c((()=>{var e,a;n.needAll&&i.value&&"all"!=(null==(e=i.value[0])?void 0:e.name)?i.value.unshift({title:"全部通道",name:"all",setup:!0,isConfig:!0}):i.value&&"all"==(null==(a=i.value[0])?void 0:a.name)&&i.value.shift()}));const m=async()=>{d.value=!0,await v(),d.value=!1};return r((()=>{m()})),{__sfc:!0,props:n,emit:s,vm:l,pushConfigInfo:i,getPushConfigInfo:v,checkedLoad:d,giveGroupModel:h,checkChange:e=>{s("change",e)},configMessageChannels:async e=>{let t={title:"",type:""},s=null;switch(e.name){case"dingding":t={title:"钉钉机器人配置",type:"dingding"};break;case"feishu":t={title:"飞书机器人配置",type:"feishu"};break;case"mail":t={title:"发送者配置",type:"mail"};break;case"weixin":t={title:"企业微信机器人配置",type:"weixin"};break;case"wx_account":if(e.setup)t={title:"微信公众号",type:"wx_account"};else try{s=l.$load(l.$t("正在安装微信公众号模块，请稍后..."));const{data:e}=await p();if(!e.wx_account.setup){const{status:e}=await g("wx_account");if(!e)return void l.$message.error("微信公众号模块安装失败");await m(),t={title:"微信公众号",type:"wx_account"}}}catch(n){}finally{s&&s.close()}}a({...t,callback:m})},renderPushConfig:m}}}),(function(){var e=this,a=e._self._c,t=e._self._setupProxy;return a("div",{staticClass:"!w-full"},[a(n,{on:{change:t.checkChange},model:{value:t.giveGroupModel,callback:function(e){t.giveGroupModel=e},expression:"giveGroupModel"}},e._l(t.pushConfigInfo,(function(n,i){return a(l,{key:i,attrs:{label:n.title,disabled:!n.setup||!n.isConfig,value:n.name}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(n.title))]),n.setup&&n.isConfig?e._e():a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v("["),a(s,{attrs:{type:"danger"},on:{click:function(e){return t.configMessageChannels(n)}}},[n.isConfig&&n.setup?e._e():[e._v("未配置")]],2),e._v("]")],1)])})),1)],1)}),[],!1,null,"8412e88e",null,null).exports;export{v as _};
