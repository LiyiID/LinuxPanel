import{f as a,c as e,n as l,a as t}from"./main.js?v=1714377894636";import{_ as s}from"./index39.js?v=1714377894636";import{_ as o,a as i}from"./descriptions.js?v=1714377894636";import{q as n,s as r}from"./element-lib.js?v=1714377894636";import{e as u,b as p,h as v,j as c}from"./vue-lib.js?v=1714377894636";import{c as d}from"./check.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{g as m,B as b}from"./site.store.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";const _=l(u({__name:"LoadState",props:{compData:{default:{}}},setup(l){var t,s,o;const i=l,{refs:{siteTabActiveList:n,siteInfo:r}}=m(),{proxy:u}=c(),_=p(""),f=p(null==(s=null==(t=i.compData)?void 0:t.project_type)?void 0:s.toLowerCase()),j=p(),y=p(null==(o=i.compData)?void 0:o.run),g=p([{label:"文件",prop:"path"},{label:"mode",prop:"mode"},{label:"position",prop:"position"},{label:"flags",prop:"flags"},{label:"fd",prop:"fd"}]),x=p([]),D=p(!1),h=p([]),C=p([{label:"客户端地址",prop:"client_addr"},{label:"客户端端口",prop:"client_rport"},{label:"协议",prop:"family"},{label:"FD",prop:"fd"},{label:"本地地址",prop:"local_addr"},{label:"本地端口",prop:"local_port"},{label:"状态",prop:"status"}]),k=p([{label:"名称",value:"name"},{label:"状态",value:"status"},{label:"用户",value:"user"},{label:"启动时间",value:"create_time",isTime:!0},{label:"PID",value:"pid"},{label:"PPID",value:"ppid"},{label:"线程",value:"threads"},{label:"Socket",value:"connects"},{label:"CPU",value:"cpu_percent"},{label:"内存",value:"memory_used",isSize:!0},{label:"io读",value:"io_read_bytes",isSize:!0},{label:"io写",value:"io_write_bytes",isSize:!0},{label:"命令",value:"exe"}]),L=p(),P=p(),S=async()=>{var a;D.value=!0;try{if(""===d(null==(a=i.compData)?void 0:a.name,"string",""))return u.$message.error("项目名称不能为空"),void u.$root.close();let e={project_name:i.compData.name};"go"===f.value&&(e.has_load_info=1);const l=await b({data:JSON.stringify(e)},f.value);Object.keys(l.data.load_info).length&&(j.value=Object.keys(l.data.load_info).map((a=>a)),_.value=j.value[0],x.value=l.data.load_info[_.value].open_files,h.value=l.data.load_info[_.value].connections,L.value=l.data.load_info[_.value],P.value=l.data.load_info),y.value=l.data.run}catch(e){}finally{D.value=!1}};return v((async()=>{var a,e;let l=null==(e=null==(a=i.compData)?void 0:a.project_type)?void 0:e.toLowerCase();"node"===l&&(l="nodejs"),f.value=l,S()})),{__sfc:!0,props:i,siteTabActiveList:n,siteInfo:r,vm:u,pid:_,siteType:f,idData:j,run:y,tableColumns:g,tableData:x,tableLoading:D,netData:h,netColumns:C,describeData:k,loadData:L,allData:P,getInfo:S,computedDes:l=>L.value?l.isTime?a(L.value[l.value]):l.isSize?e(L.value[l.value]):L.value[l.value]:"",handleChange:()=>{D.value=!0,x.value=P.value[_.value].open_files,h.value=P.value[_.value].connections,L.value=P.value[_.value],D.value=!1},jumpPath:()=>{n.value.moduleSettingsAct="state",n.value.isJump=!0}}}}),(function(){var a=this,e=a._self._c,l=a._self._setupProxy;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:l.tableLoading,expression:"tableLoading"}],staticClass:"h-full"},[l.run?e("div",[e("div",{staticClass:"flex items-center"},[e("span",{staticClass:"mr-8x"},[a._v("PID")]),e(n,{on:{change:l.handleChange},model:{value:l.pid,callback:function(a){l.pid=a},expression:"pid"}},a._l(l.idData,(function(a){return e(r,{key:a,attrs:{label:a,value:a}})})),1)],1),e(o,{staticClass:"mt-20x",attrs:{column:4,border:""}},a._l(l.describeData,(function(t,s){return e(i,{key:s},[e("template",{slot:"label"},[a._v(" "+a._s(t.label)+" ")]),a._v(" "+a._s(l.computedDes(t))+" ")],2)})),1),e("span",{staticClass:"text-[#666] my-8x block"},[a._v("网络")]),e(s,{attrs:{maxHeight:"160",column:l.netColumns,data:l.netData}}),e("span",{staticClass:"text-[#666] my-8x block"},[a._v("打开的文件列表")]),e(s,{attrs:{maxHeight:"180",column:l.tableColumns,data:l.tableData}})],1):e("div",{staticClass:"bg-[#7F7F7F] flex items-center justify-center h-full"},[e("div",{staticClass:"bg-white px-48x py-16x text-[#333]"},[a._v(" 请开启 "),e(t,{on:{click:l.jumpPath}},[a._v("项目状态")]),a._v(" 后查看负载状态 ")],1)])])}),[],!1,null,"6a029036",null,null).exports;export{_ as default};
