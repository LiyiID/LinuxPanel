import{_ as e}from"./index52.js?v=1714377894636";import{_ as t}from"./index53.js?v=1714377894636";import{_ as a}from"./index39.js?v=1714377894636";import{_ as n}from"./index54.js?v=1714377894636";import{g as s,l as r,o,P as i,s as l,Q as c,n as m,a as u}from"./main.js?v=1714377894636";import{_ as p}from"./index58.js?v=1714377894636";import{_ as d}from"./index59.js?v=1714377894636";import{_ as g}from"./preload-helper.js?v=1714377894636";import{e as v,b,v as h,L as f,h as _,l as y,I as k,j as C,H as j}from"./vue-lib.js?v=1714377894636";import{g as x}from"./docker.store.js?v=1714377894636";import{u as D}from"./docker.table.js?v=1714377894636";import{b as T,c as w,d as E,e as S,N as L,a as P,r as $,C as N,f as B,g as O}from"./docker.popup.js?v=1714377894636";import{c as R,s as A,a as I,d as J,b as M,g as H}from"./docker.api.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./check.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";const V=m(v({__name:"DockerContainer",setup(e,{expose:t}){var a;const{proxy:n}=C(),m=b(),u=b(JSON.parse(null!=(a=localStorage.getItem("dockerContainerTableColumn"))?a:"[]")||[]),{refs:{containerTableData:p,tabActive:d},getCList:v,getCurrentCon:V,setTopContainerList:z}=x(),{refs:{mainHeight:q,routerActive:G}}=s(),W=h({selectList:[]}),Q=b("");f("RowData",(()=>p.value.rowData)),f("selectList",(()=>W.selectList));const F=b([{label:"启动",value:"start",event:()=>{}},{label:"重启",value:"restart",event:()=>{}},{label:"停止",value:"stop",event:()=>{}},{label:"强制停止",value:"kill",event:()=>{}},{label:"暂停",value:"pause",event:()=>{}},{label:"恢复",value:"unpause",event:()=>{}},{label:"删除",value:"delete",event:()=>{}}]),K=b([{active:!0,content:n.$t("Docker.addContainer"),event:()=>{T()}},{active:!1,content:n.$t("Docker.logManage"),event:()=>{w()}},{active:!1,content:n.$t("Docker.clearContainer"),event:async()=>{try{E({confirm:async e=>{p.value.loading=!0;let t=e?1:0;const a=await R({type:t});a.status?(v(),n.$message.success(a.msg)):(p.value.loading=!1,n.$message.error(a.msg))},message:"将删除所有已停止、未使用的容器,是否继续？",confirmMsg:'删除<span class="text-danger">所有</span>容器，包含正在运行的容器'},"清理容器")}catch(e){}finally{p.value.loading=!1}}},{active:!1,content:"安全检测",event:async()=>{r({title:"安全检测",area:70,component:(await g((()=>import("./index86.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url)).default})}},{content:"容器编排 ",hide:o,event:()=>{S()}}]);let U=[],X=!1,Y=0;const Z=h({isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>j("span",{class:0!==U.length||X?U.includes(e.id)?"text-primary":"text-danger":"text-warning"},(()=>{if(0!==U.length||X){let t=U.includes(e.id)?"执行成功":"执行失败";return Y++,t}return"等待执行"})())}}),ee=async e=>{await V(e.id),P(e)},te=async(e,t)=>{const a={id:e.id,status:t};p.value.loading=!0;const s=await A({data:JSON.stringify(a)});p.value.loading=!1,s.status?(v(),n.$message.success(s.msg)):n.$message.error(s.msg)},ae=async(e,t)=>{const a={id:e.id,status:t};try{const t=await A({data:JSON.stringify(a)});return t.status?(U.push(e.id),t):Promise.reject(t)}catch(n){return Promise.reject(!1)}},ne=async e=>{$(e)},se=e=>{N(e)},re=e=>{B(e)},oe=async e=>{"running"===e.status?r({isAsync:!0,title:"shell类型",area:40,component:()=>g((()=>import("./ShellTypeSelect.js?v=1714377894636")),__vite__mapDeps([12,13,10,5,4,9,2,3,6,7,8,14,15,16,17]),import.meta.url),compData:{row:e,openTerminalLog:re},btn:["确认"]}):n.$message.error("容器未运行")},ie=e=>{P(e,"proxy")},le=e=>{w(e)},ce=async e=>{const t=await I({data:JSON.stringify({id:e.id})});if(!t.status)return n.$message.error(t.msg);l("Path",t.data.path),window.location.href=window.location.origin+"/files"},me=async e=>{let t=null;try{await n.$confirm({icon:"warning",title:"删除容器【".concat(e.name,"】"),width:"35rem",message:"删除容器【".concat(e.name,"】,是否继续操作？")});const a={id:e.id};t=n.$load("正在删除容器，请稍候...");const s=await J({data:JSON.stringify(a)});s.status&&v(),n.$message.request(s)}catch(a){}finally{t&&t.close()}},ue=async({id:e,name:t})=>{try{const{data:t}=await J({data:JSON.stringify({id:e})});return t.status?(U.push(e),t):Promise.reject(t)}catch(a){}},pe=e=>{O(e)},de=(e,t)=>{switch(e){case"terminal":oe(t);break;case"reName":ne(t);break;case"realMonitor":se(t);break;case"proxyDetails":ie(t);break;case"dir":ce(t)}},ge=async(e,t)=>{try{let a;"top"==t?(a=await M({type:"add",container_name:e.name}),e.is_top=1):"untop"==t&&(a=await M({type:"del",container_name:e.name}),e.is_top=0),n.$message.request(a),await z()}catch(a){}},ve=async e=>{var t;try{if("all"===e)return await v();p.value.showList=null!=(t=p.value.grouped[e])?t:[]}catch(a){}},be=D({reNameEvent:ne,realMonitorEvent:se,terminalEvent:oe,dirEvent:ce,logDataEvent:le,deleteDataEvent:me,conDetailEvent:ee,setStatusEvent:te,openContainerBackups:pe,openProxyDetails:ie,changeTaskTopEvent:ge,moreEvent:de,setStatusTitle:ve});let he=null;const fe=async(e,t)=>{try{t.data.container_stats_data&&ye(t.data),t.end&&n.$modelSocket.send({model_index:"btdocker",mod_name:"container",def_name:"get_all_stats",ws_callback:1002})}catch(a){}},_e=async()=>{H(fe)},ye=e=>{var t;if(!e.container_stats_data)return;const a=e.container_stats_data;null==(t=p.value.showList)||t.forEach((e=>{if("running"===e.status){const t=a.find((t=>t.id==e.id));t&&(n.$set(e,"cpu_usage",t.cpu_usage||0),n.$set(e,"mem_percent",t.mem_percent||0))}return e}))},ke=()=>{var e;null==he||he.close(),he=null,null==(e=n.$modelSocket)||e.close(),n.$modelSocket=null},Ce=()=>{localStorage.getItem("dockerContainerTableRefresh")||(localStorage.setItem("dockerContainerTableRefresh","1"),localStorage.removeItem("dockerContainerTableColumn"))};Ce(),_((async()=>{be.value=i(u.value,be.value)}));const je=()=>{_e(),v()};return t({init:je,destroy:ke}),_((()=>{je(),y((()=>{g((()=>import("./CreateConDialog.js?v=1714377894636")),__vite__mapDeps([18,10,5,4,9,2,3,6,7,8,19,20,21,22,15,23,24,14,25,26,27,28,13,29,30,31,16,32,17,33,34,35,36,37,38,39,40,41,42,43]),import.meta.url),g((()=>import("./index87.js?v=1714377894636")),__vite__mapDeps([44,20,10,5,4,9,2,3,6,7,8,19,21,17,32,33,45,29,30,46,47,48,49,50,51,52,53,13,14,54,23,15,16,24,25,26,27,28,22,31,34]),import.meta.url)}))})),k((()=>{ke()})),{__sfc:!0,vm:n,Table:m,ftpTbaleColumnLocal:u,containerTableData:p,tabActive:d,getCList:v,getCurrentCon:V,setTopContainerList:z,mainHeight:q,routerActive:G,select:W,batchType:Q,tableBatchData:F,tableBtnGroup:K,list:U,isComplete:X,index:Y,batchConfig:Z,batchEvent:(e,t,a)=>"delete"===e?ue(t):ae(t,e),handleBathComplete:e=>{X=!0,v()},changePageLimit:e=>{p.value.limit=e,p.value.p=1,v()},changePageSize:e=>{p.value.p=e,v()},conDetailEvent:ee,setStatusEvent:te,batchSetStatusEvent:ae,reNameEvent:ne,realMonitorEvent:se,openTerminalLog:re,terminalEvent:oe,openProxyDetails:ie,logDataEvent:le,dirEvent:ce,deleteDataEvent:me,batchDeleteData:ue,openContainerBackups:pe,handleBatch:e=>{X=!1,U=[],Y=0;let t=[];switch(e){case"delete":t=["删除","彻底失去访问和操作权限"];break;case"start":t=["启动"];break;case"stop":t=["停止"];break;case"restart":t=["重启"];break;case"kill":t=["强制停止"];break;case"unpause":t=["恢复"];break;case"pause":t=["暂停"]}Q.value=e,Z.isRecurrence=!0,Z.describe.th="容器名",Z.describe.title="批量".concat(t[0],"容器"),Z.describe.message="批量".concat(t[0],"已选的容器，是否继续操作！")},handleSelectionChange:e=>{W.selectList=e},moreEvent:de,changeTaskTopEvent:ge,setStatusTitle:ve,tableColumn:be,useSocket:he,timer:null,connectNum:0,createWebSocket:()=>{null==he||he.close(),he=c({route:"/ws_model",onMessage:fe})},onWSReceive:fe,rsyncData:_e,setCon:ye,destroy:ke,refreshTableColumn:Ce,init:je,NPSDialog:L}}}),(function(){var s=this,r=s._self._c,o=s._self._setupProxy;return r("div",{staticClass:"relative container-table-tab"},[r(d,{scopedSlots:s._u([{key:"header-left",fn:function(){return[r("div",{staticClass:"flex items-center"},[r(p,{attrs:{group:o.tableBtnGroup}}),r(u,{staticClass:"ml-[1.6rem]",domProps:{textContent:s._s("需求反馈")},on:{click:function(e){return o.NPSDialog()}}})],1)]},proxy:!0},{key:"header-right",fn:function(){return[r("div",{staticClass:"flex items-center text-[#f0ad4e] mr-[1rem]"},[r("span",{staticClass:"el-icon-warning text-[1.4rem]"}),s._v("可设置表格列显示、隐藏 ")]),r(n,{attrs:{name:"dockerContainerTableColumn",column:o.tableColumn}})]},proxy:!0},{key:"content",fn:function(){return[r(a,{directives:[{name:"loading",rawName:"v-loading",value:o.containerTableData.loading,expression:"containerTableData.loading"}],key:"containerTable",ref:"Table",attrs:{column:o.tableColumn,data:o.containerTableData.showList,description:"容器列表为空","max-height":o.mainHeight-220,"element-loading-text":"正在加载容器列表，请稍后..."},on:{"selection-change":o.handleSelectionChange}})]},proxy:!0},{key:"footer-left",fn:function(){return[r(t,{attrs:{data:o.tableBatchData,config:o.batchConfig,"batch-fn":o.batchEvent},on:{"handle-batch":o.handleBatch,"handle-complete":o.handleBathComplete}})]},proxy:!0},{key:"footer-right",fn:function(){return[r(e,{attrs:{total:o.containerTableData.total,"current-page":o.containerTableData.p,"page-size":o.containerTableData.limit},on:{"update:currentPage":function(e){return s.$set(o.containerTableData,"p",e)},"update:current-page":function(e){return s.$set(o.containerTableData,"p",e)},"size-change":o.changePageLimit,"current-change":o.changePageSize}})]},proxy:!0},{key:"popup",fn:function(){},proxy:!0}])})],1)}),[],!1,null,"0d6b426e",null,null).exports;export{V as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index86.js?v=1714377894636","./index51.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./ShellTypeSelect.js?v=1714377894636","./index41.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./docker.api.js?v=1714377894636","./CreateConDialog.js?v=1714377894636","./element-lib.js?v=1714377894636","./index77.js?v=1714377894636","./index42.js?v=1714377894636","./ContainerEdit.js?v=1714377894636","./index85.js?v=1714377894636","./element-lib.js?v=1714377894636","./index117.js?v=1714377894636","./radio-button.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./docker.store.js?v=1714377894636","./check.js?v=1714377894636","./checkbox-button.js?v=1714377894636","./index133.js?v=1714377894636","./index76.js?v=1714377894636","./element-lib.js?v=1714377894636","./xterm-lib.js?v=1714377894636","./xterm.js?v=1714377894636","./index109.js?v=1714377894636","./index110.js?v=1714377894636","./AddCompose.js?v=1714377894636","./docker.popup.js?v=1714377894636","./index87.js?v=1714377894636","./index120.js?v=1714377894636","./docker.table.js?v=1714377894636","./index38.js?v=1714377894636","./index45.js?v=1714377894636","./element-ui.common.js?v=1714377894636","./date-util.js?v=1714377894636","./vdom.js?v=1714377894636","./index62.js?v=1714377894636","./cascader-panel.js?v=1714377894636","./index59.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
