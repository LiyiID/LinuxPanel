import{a as t,c_ as e,c$ as a,d0 as s,d1 as l,n as i,b as o,D as r}from"./main.js?v=1714377894636";import{_ as n}from"./index120.js?v=1714377894636";import{_ as c}from"./index118.js?v=1714377894636";import{_ as p}from"./index39.js?v=1714377894636";import{_ as m}from"./index59.js?v=1714377894636";import{L as u}from"./element-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import{e as d,b as f,H as v,h as x,j as b}from"./vue-lib.js?v=1714377894636";import{o as h}from"./index38.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";const _=i(d({__name:"SafeIsolationFile",setup(i){const{proxy:o}=b(),r=f([]),n=f(""),c=f(!1),p=f({}),m=f(!1),d=f(!1),_=f([{label:"隔离时间",prop:"time"},{label:"文件",prop:"path",render:e=>v(t,{on:{click:()=>{h({path:e.path})}}},e.path)},{label:"操作",align:"right",render:a=>[v("div",{class:"flex items-center justify-end"},[v(t,{on:{click:async()=>{try{p.value=a;const{data:t}=await e({path:a.path});if(t.msg)return o.$message.request(t),!1;n.value=t.data,c.value=!0}catch(t){n.value=""}}}},["样本文件"]),v(u,{attrs:{direction:"vertical"}}),v(t,{on:{click:async()=>{m.value=!0,p.value=a}}},["删除"])])]}]),j=async()=>{try{const t=await a();r.value=t.data}catch(t){}};return x((()=>{j()})),{__sfc:!0,vm:o,tableData:r,editorValue:n,editorPopup:c,rowData:p,confirmPopup:m,fileFlag:d,tableColumns:_,getWebShellList:j,saveFile:async()=>{try{const t=await s({path:p.value.path,data:n.value,encoding:"utf-8"});o.$message.request(t)}catch(t){}},delFile:async()=>{try{const t=await l({data:JSON.stringify({md5:p.value.md5,path:p.value.path,type:d.value?"delete":""})});d.value=!1,o.$message.request(t),m.value=!1}catch(t){}}}}}),(function(){var t=this,e=t._self._c,a=t._self._setupProxy;return e("div",{staticClass:"p-20x"},[e(m,{scopedSlots:t._u([{key:"content",fn:function(){return[e(p,{attrs:{column:a.tableColumns,data:a.tableData}})]},proxy:!0}])}),e(c,{staticClass:"ml-20x mt-12x",attrs:{list:[{text:"样本文件：查杀时的文件内容被记录形成的样本文件"}],"list-style":"disc"}}),e(o,{attrs:{title:"在线编辑",showFooter:"",visible:a.editorPopup,area:70},on:{"update:visible":function(t){a.editorPopup=t},confirm:a.saveFile}},[e("div",{staticClass:"p-20x"},[e(n,{staticClass:"!h-[40rem]",model:{value:a.editorValue,callback:function(t){a.editorValue=t},expression:"editorValue"}})],1)]),e(o,{attrs:{title:"删除文件",showFooter:"",area:40,visible:a.confirmPopup},on:{"update:visible":function(t){a.confirmPopup=t},confirm:a.delFile}},[e("div",{staticClass:"flex items-center p-20x text-[1.4rem]"},[e("i",{staticClass:"el-icon-question text-[#E6A23C] text-[4rem]"}),e("div",{staticClass:"flex flex-col ml-12x"},[e("span",{staticClass:"leading-8"},[t._v("是否要删除关联的源文件？")]),e("div",{staticClass:"flex items-center mt-12x"},[e(r,{staticClass:"!mr-4x",model:{value:a.fileFlag,callback:function(t){a.fileFlag=t},expression:"fileFlag"}}),t._v("源文件 ")],1)])])])],1)}),[],!1,null,"d8a76614",null,null).exports;export{_ as default};
