import{_ as e}from"./index133.js?v=1714377894636";import{n as t,q as a}from"./main.js?v=1714377894636";import{u as m,w as r,x as o,o as l}from"./element-lib.js?v=1714377894636";import{_ as s}from"./index41.js?v=1714377894636";import{_ as i}from"./index77.js?v=1714377894636";import{e as n,b as d,v as c,h as p,j as u}from"./vue-lib.js?v=1714377894636";import{H as f,M as v}from"./docker.api.js?v=1714377894636";import{u as _}from"./docker.store.js?v=1714377894636";import"./index76.js?v=1714377894636";import"./xterm-lib.js?v=1714377894636";import"./xterm.js?v=1714377894636";import"./index109.js?v=1714377894636";import"./index85.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./radio-button.js?v=1714377894636";import"./index110.js?v=1714377894636";import"./check.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index42.js?v=1714377894636";const b=t(n({__name:"StashPullDialogDev",props:{compData:{default:()=>({})}},setup(e,{expose:t}){const a=e,{getMList:m}=_(),{proxy:r}=u(),o=d("common"),l=c({name:"",image:"",cmd:""}),s=d(!1),i=d(),n=d(),b=c({model_index:"btdocker",mod_name:"image",def_name:"pull_from_some_registry",ws_callback:111,name:"",image:""}),g=d(),y={image:[{validator:(e,t,a)=>{""===t?a(new Error("请输入镜像名")):a()},trigger:["blur"]}]},j=d([]);p((async()=>{var e;try{(await f()).data.forEach((e=>{j.value.push({key:e.name,title:e.name})})),l.name=null==(e=j.value[0])?void 0:e.key}catch(t){}}));const x=async()=>{try{if(""===l.cmd)return void r.$message.error("请输入命令");s.value=!0,b.name="",b.image="",b.def_name="get_cmd_log";await v({cmd:l.cmd},"image");n.value.refreshTerminal(),setTimeout((()=>{n.value.socketSend()}),500)}catch(e){}},k=async()=>{try{if("cmd"===o.value)return void x();if(""===l.name)return void r.$message.error("请选择仓库名");s.value=!0,await r.$refs.cmdFormRef.validate((async e=>{e?(b.name=l.name,b.image=l.image,b.def_name="pull_from_some_registry",i.value.refreshTerminal(),setTimeout((()=>{i.value.socketSend()}),500)):s.value=!1}))}catch(e){}};return t({onConfirm:k,onCancel:()=>{let e=i.value.useSocket();null==e||e.close(),e=null,m()}}),{__sfc:!0,getMList:m,vm:r,props:a,menu:o,cmdForm:l,disabled:s,terminal:i,terminalCmd:n,param:b,cmdFormRef:g,cmdRules:y,options:j,changeName:e=>{l.name=e},completePull:()=>{try{s.value=!1,l.image="",l.cmd=""}catch(e){}},onCmdConfirm:x,onConfirm:k}}}),(function(){var t=this,n=t._self._c,d=t._self._setupProxy;return n("div",{staticClass:"flex flex-col p-16x lib-box"},[n(i,{attrs:{type:"navtwo"},model:{value:d.menu,callback:function(e){d.menu=e},expression:"menu"}},[n(m,{attrs:{name:"common",label:"常规拉取"}},[n(r,{ref:"cmdFormRef",staticClass:"relative w-full mt-[1.6rem]",attrs:{size:"small",model:d.cmdForm,rules:d.cmdRules,disabled:d.disabled,"label-position":"right"},nativeOn:{submit:function(e){e.preventDefault()}}},[n(o,{attrs:{prop:"name",label:"仓库名"}},[n(s,{staticClass:"w-[32rem]",attrs:{options:d.options,change:d.changeName},model:{value:d.cmdForm.name,callback:function(e){t.$set(d.cmdForm,"name",e)},expression:"cmdForm.name"}})],1),n(o,{attrs:{prop:"image",label:"镜像名"}},[n(l,{staticClass:"!w-[32rem]",attrs:{placeholder:"请输入镜像名，按回车拉取,如:image:v1"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:d.onConfirm.apply(null,arguments)}},model:{value:d.cmdForm.image,callback:function(e){t.$set(d.cmdForm,"image",e)},expression:"cmdForm.image"}},[n("template",{slot:"append"},[n(a,{attrs:{type:"default"},on:{click:d.onConfirm}},[t._v("拉取")])],1)],2)],1),n("div",{staticClass:"resultTitle px-[.2rem] py-[.4rem] mt-16x"},[t._v("拉取结果：")]),n("div",{staticClass:"rounded-default bg-[#333] h-[45.6rem]"},[n(e,{ref:"terminal",attrs:{url:"/ws_model","host-info":d.param,notInit:!0,destroy:!1},on:{complete:d.completePull}})],1)],1)],1),n(m,{attrs:{name:"cmd",label:"命令拉取"}},[n(r,{ref:"cmdRef",staticClass:"relative w-full mt-[1.6rem]",attrs:{size:"large",model:d.cmdForm,rules:d.cmdRules,disabled:d.disabled,"label-position":"right"},nativeOn:{submit:function(e){e.preventDefault()}}},[n(o,{attrs:{prop:"cmd"}},[n(l,{attrs:{autofocus:"",placeholder:"请输入需要执行的命令,docker pull redis:latest，按回车执行"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:d.onConfirm.apply(null,arguments)}},model:{value:d.cmdForm.cmd,callback:function(e){t.$set(d.cmdForm,"cmd",e)},expression:"cmdForm.cmd"}},[n("template",{slot:"append"},[n(a,{attrs:{type:"default"},on:{click:d.onConfirm}},[t._v("执行命令")])],1)],2)],1),n("div",{staticClass:"resultTitle px-[.2rem] py-[.4rem] mt-16x"},[t._v("拉取结果：")]),n("div",{staticClass:"rounded-default bg-[#333] h-[45.6rem]"},[n(e,{ref:"terminalCmd",attrs:{url:"/ws_model","host-info":d.param,notInit:!0,destroy:!1},on:{complete:d.completePull}})],1)],1)],1)],1)],1)}),[],!1,null,"83e7f44d",null,null).exports;export{b as default};
