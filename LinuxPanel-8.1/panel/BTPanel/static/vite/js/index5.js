import{a1 as t,c as s,bA as e,n as a,a as l,aZ as i}from"./main.js?v=1714377894636";import{F as n}from"./element-lib.js?v=1714377894636";import{e as o,A as c,l as r,j as m}from"./vue-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";const p=a(o({__name:"index",setup(a,{expose:l}){const{proxy:i,emit:n}=m(),o=t(),{getRealTimeTaskList:p}=o,{realTimeTaskList:_}=c(o);let u=null;const v=()=>{null!=u&&clearInterval(u)},d=()=>{u=setInterval((async()=>{await p();0===_.value.length&&(v(),n("close"))}),1e3)},C=()=>{d()},f=()=>{v()};return r((()=>{n("resize")})),l({onOpen:C,onCancel:f}),{__sfc:!0,vm:i,emit:n,global:o,getRealTimeTaskList:p,realTimeTaskList:_,timer:u,clearTimer:v,initTimer:d,getTotal:t=>s(t),onCancelTask:async t=>{let s=null;try{await i.$confirm("是否取消上传当前列表的文件，若取消上传，已上传的文件，需用户手动删除，是否继续？","取消上传文件"),s=i.$load("正在取消任务，请稍候...");const{data:a}=await e(t.id);s.close(),i.$message.request(a)}catch(a){null==s||s.close()}},onOpen:C,onCancel:f}}}),(function(){var t=this,s=t._self._c,e=t._self._setupProxy;return s("section",{staticClass:"max-h-[52rem] p-4 overflow-auto"},t._l(e.realTimeTaskList,(function(a){return s("div",{key:a.id},[-1==a.status?[1==a.type?[s("div",{staticClass:"p-4"},[s("div",{staticClass:"flex items-center"},[s("div",{staticClass:"flex-1 w-0 truncate",attrs:{title:"".concat(a.name,"：").concat(a.shell)}},[t._v(" "+t._s("".concat(a.name,"：").concat(a.shell))+" ")]),s("span",{staticClass:"mx-8 text-#999"},[t._v(t._s(a.log.pre)+"%")]),s(l,{on:{click:function(t){return e.onCancelTask(a)}}},[t._v("取消")])],1),s(n,{staticClass:"my-2",attrs:{percentage:Number(a.log.pre),"show-text":!1}}),s("div",{staticClass:"flex items-center text-#999"},[s("div",{staticClass:"flex-1 flex items-center"},[s("div",[t._v(t._s(a.log.used)+" / "+t._s(e.getTotal(a.log.total)))]),s("div",{staticClass:"ml-8"},[t._v("预计还要: "+t._s(a.log.time))])]),s("div",[t._v(t._s(a.log.speed)+"/s")])])],1)]:[s("div",{staticClass:"title"},[s("span",{staticClass:"text",attrs:{title:"".concat(a.name,": ").concat(a.shell)}},[t._v(t._s(a.name)+": "+t._s(a.shell))]),s(l,{on:{click:function(t){return e.onCancelTask(a)}}},[t._v("取消")])],1),s(i,{staticClass:"max-h-[27rem]",attrs:{"is-html":"",content:a.log}})],e.realTimeTaskList.length>1?s("div",{staticClass:"title"},[t._v("等待执行任务")]):t._e()]:[s("div",{staticClass:"title wait"},[s("span",{staticClass:"text",attrs:{title:"".concat(a.name,": ").concat(a.shell)}},[t._v(t._s(a.name)+": "+t._s(a.shell))]),s("i",{staticClass:"el-icon-close cursor-pointer font-bold",on:{click:function(t){return e.onCancelTask(a)}}})])]],2)})),0)}),[],!1,null,"735ae65c",null,null).exports;export{p as default};
