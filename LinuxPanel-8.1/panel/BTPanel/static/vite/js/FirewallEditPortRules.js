import{_ as e}from"./index51.js?v=1714377894636";import{g as t,cq as o,at as s,cr as r,cs as a,n as l,b as i}from"./main.js?v=1714377894636";import{_ as n}from"./index118.js?v=1714377894636";import{w as p,x as c,q as m,s as d,o as u}from"./element-lib.js?v=1714377894636";import{_ as f}from"./index85.js?v=1714377894636";import{_ as b}from"./index41.js?v=1714377894636";import{e as h,b as y,v as w,w as g,j as v}from"./vue-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{getFirewallStore as F}from"./firewall.store.js?v=1714377894636";import{o as P}from"./confirm.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./check.js?v=1714377894636";import"./config.js?v=1714377894636";const _=l(h({__name:"FirewallEditPortRules",props:{compData:{default:()=>{}}},setup(e,{expose:l}){const i=e,{refs:{authType:n}}=t(),{getFirewalInfoEvent:p}=F(),{proxy:c}=v(),m=y(!1),d=w({title:"指定域名-功能介绍",ps:"系统防火墙将会放行/阻止设置域名所解析的A/AAAA记录",source:106,desc:["放行/阻止域名解析记录"],tabImgs:[{title:"防火墙禁止端口",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/specify_domain_1.png"},{title:"域名解析已生效",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/specify_domain_2.png"},{title:"设置效果",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/specify_domain_3.png"}]}),u=w({protocol:"tcp",ports:"",choose:"all",types:"accept",brief:"",address:"",domain:""}),f=y(),b=y(!1),h=y([{text:"支持添加多个端口，如：80,88"},{text:"支持添加多个端口范围，如：80,88,90-99,110-120"}]),_=y({ports:"请输入指定IP，多个IP请用,隔开。\n例如192.168.1.1,192.168.1.2",domain:"请输入指定域名，多个域名请用,隔开。\n例如www.bt.cn,www.baidu.com"}),j=y([{title:"TCP",key:"tcp"},{title:"UDP",key:"udp"},{title:"TCP/UDP",key:"tcp/udp"}]),x=y([{title:"所有IP",key:"all"},{title:"指定IP",key:"point"},{title:"指定域名 -- 企业版专享",key:"domain"}]),k=y([{title:"允许",key:"accept"},{title:"拒绝",key:"drop"}]),$=y(!!i.compData.selectOptions),O=(e,t,o)=>{const s=t.split(","),r=/^\d+$/;for(let a of s)if(r.test(a)){const e=parseInt(a,10);if(e<1||e>65535)return o("端口输入范围不正确，请重新输入")}else if(a.includes("-")){const e=a.split("-"),t=parseInt(e[0],10),s=parseInt(e[1],10);if(t<1||s>65535||t>s)return o("端口输入范围不正确，请重新输入")}else{if(""!=a)return o("端口格式不正确，请重新输入");o("端口不可为空，请输入")}return o()},D={ports:[{validator:O,trigger:["blur","change"]}],address:[{validator:(e,t,o)=>{if(!(t.length>0))return o(new Error(c.$t("safety.specifiedIPPlaceHolder")));o()},trigger:["blur","change"]}],domain:[{validator:(e,t,o)=>{if(!(t.length>0))return o(new Error("请输入指定域名"));o()},trigger:["blur","change"]}]},C=async e=>{const t=u;"all"===t.choose?(t.address="",t.source=""):(t.address=t.address.replace(/\n/g,","),t.source=t.address,t.domain=t.domain.replace(/\n/g,",")),$.value&&(t.id=i.compData.selectOptions.id),P({$refs:f.value,loading:b,request:async()=>$.value?"domain"===t.choose?await o({data:JSON.stringify(t)}):await s({data:JSON.stringify(t)}):"domain"===t.choose?await r({data:JSON.stringify(t)}):await a({data:JSON.stringify(t)}),async complete(){i.compData.refreshEvent(),p(),$.value}})};return g((()=>{i.compData.selectOptions&&(Object.assign(u,i.compData.selectOptions),u.choose=i.compData.selectOptions.domain?"domain":i.compData.selectOptions.address?"point":"all")})),l({onConfirm:C}),{__sfc:!0,props:i,authType:n,getFirewalInfoEvent:p,vm:c,ltdPayShow:m,productData:d,ruleForm:u,editPortRules:f,formDisabled:b,helpList:h,formPromptMessages:_,protocolOptions:j,chooseOptions:x,typesOptions:k,isEdit:$,validatePort:O,rules:D,setProtocol:e=>{u.protocol=e},chooseChange:e=>{if(f.value.clearValidate(),"ltd"!==n.value&&"domain"===e)return u.choose="all",void(m.value=!0);u.choose=e},handleChangeType:e=>{u.types=e},submitFrom:C,openNps:()=>{}}}}),(function(){var t=this,o=t._self._c,s=t._self._setupProxy;return o(p,{ref:"editPortRules",staticClass:"p-[2rem] addfrom",attrs:{rules:s.rules,disabled:s.formDisabled,model:s.ruleForm,"label-width":"5rem"}},[o(c,{attrs:{label:t.$t("safety.protocol")}},[o(b,{staticClass:"w-[24rem]",attrs:{options:s.protocolOptions,change:s.setProtocol},model:{value:s.ruleForm.protocol,callback:function(e){t.$set(s.ruleForm,"protocol",e)},expression:"ruleForm.protocol"}})],1),o(c,{attrs:{label:t.$t("safety.ports"),prop:"ports"}},[o(f,{attrs:{width:"24rem",placeholder:"请输入端口",disabled:s.isEdit},model:{value:s.ruleForm.ports,callback:function(e){t.$set(s.ruleForm,"ports",e)},expression:"ruleForm.ports"}})],1),o(c,{attrs:{label:t.$t("safety.source")}},[o(m,{staticClass:"w-[24rem]",on:{change:s.chooseChange},model:{value:s.ruleForm.choose,callback:function(e){t.$set(s.ruleForm,"choose",e)},expression:"ruleForm.choose"}},t._l(s.chooseOptions,(function(e,t){return o(d,{key:t,attrs:{label:e.title,value:e.key}})})),1)],1),"point"===s.ruleForm.choose?o(c,{attrs:{label:t.$t("safety.specifiedIP"),prop:"address"}},[o(f,{attrs:{type:"textarea",rows:3,width:"24rem",placeholder:s.formPromptMessages.ports,clearable:""},model:{value:s.ruleForm.address,callback:function(e){t.$set(s.ruleForm,"address",e)},expression:"ruleForm.address"}})],1):t._e(),"ltd"===s.authType&&"domain"===s.ruleForm.choose?o(c,{attrs:{label:t.$t("safety.specifiedDomain"),prop:"domain"}},[o(f,{attrs:{type:"textarea",rows:3,width:"24rem",placeholder:s.formPromptMessages.domain,clearable:""},model:{value:s.ruleForm.domain,callback:function(e){t.$set(s.ruleForm,"domain",e)},expression:"ruleForm.domain"}})],1):t._e(),o(c,{attrs:{label:t.$t("safety.policy")}},[o(m,{staticClass:"w-[24rem]",on:{change:s.handleChangeType},model:{value:s.ruleForm.types,callback:function(e){t.$set(s.ruleForm,"types",e)},expression:"ruleForm.types"}},t._l(s.typesOptions,(function(e,t){return o(d,{key:t,attrs:{label:e.title,value:e.key}})})),1)],1),o(c,{attrs:{label:t.$t("safety.brief")}},[o(u,{staticClass:"!w-[24rem] special-input",attrs:{placeholder:t.$t("safety.briefPlaceHolder"),clearable:""},model:{value:s.ruleForm.brief,callback:function(e){t.$set(s.ruleForm,"brief",e)},expression:"ruleForm.brief"}})],1),o(n,{staticClass:"pl-[6rem] pt-[2.4rem]",attrs:{list:s.helpList,listStyle:"disc"}}),o(i,{attrs:{title:"指定域名-功能介绍",area:60,visible:s.ltdPayShow},on:{"update:visible":function(e){s.ltdPayShow=e}}},[o("div",[o(e,{staticClass:"p-40x",attrs:{data:s.productData}})],1)])],1)}),[],!1,null,"53e9a0ba",null,null).exports;export{_ as default};
