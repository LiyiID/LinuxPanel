import{M as e,N as t,O as a,_ as l}from"./element-lib.js?v=1714377894636";import{a6 as s,a7 as n,n as i,D as o,F as u}from"./main.js?v=1714377894636";import{e as r,b as m,f as c,h as d,l as p,j as f}from"./vue-lib.js?v=1714377894636";const v=i(r({__name:"index",props:{name:null,column:{default:()=>[]},disabled:{default:()=>[]},isRequest:{type:Boolean,default:!1},other:{default:()=>[]}},setup(e){const t=e,{proxy:a}=f(),l=m(),i=m(),o=m(!0),u=m(t.column);c((()=>t.other),(e=>{e&&e.map((e=>(u.value.splice(e.index,0,e.column),e)))}),{immediate:!0});const r=()=>new Promise((e=>{var t;a.$parent.$children.length>0&&(null==(t=a.$parent.$children)||t.forEach((t=>{var l;(null==(l=null==t?void 0:t._vnode.tag)?void 0:l.indexOf("ElTable"))>-1&&e({tableVm:t.$children[0],viewVm:a.$parent.$parent})})))})),v=async()=>{if(t.isRequest)try{const{data:e}=await s({table_name:t.name}),a=e[t.name];return a?JSON.parse(a):[]}catch(a){}const e=localStorage.getItem(t.name);return e?JSON.parse(e):[]},y=async()=>{const e=await v();e.length===u.value.length?(u.value.map(((t,a)=>("isCustom"in e[a]&&(t.isCustom=e[a].isCustom),t))),localStorage.setItem(t.name,JSON.stringify(u.value))):localStorage.removeItem("phpTableColumn")};return d((async()=>{p((async()=>{const{tableVm:e,viewVm:t}=await r();y(),l.value=e,i.value=t}))})),{__sfc:!0,vm:a,props:t,table:l,tableView:i,isDefault:o,newColumn:u,getTableData:r,getLocalColumn:v,syncColumn:y,handleCommand:e=>{p((async()=>{var s,i,o,r;if(l.value.doLayout(),t.isRequest)try{const{data:l}=await n({table_name:t.name,table_data:JSON.stringify(u.value)});(null==(i=null==(s=u.value)?void 0:s[e])?void 0:i.click)&&(null==(r=u.value)||r[e].click(null==(o=u.value)?void 0:o[e].isCustom)),localStorage.setItem(t.name,JSON.stringify(u.value)),a.$message.request(l)}catch(m){}else localStorage.setItem(t.name,JSON.stringify(u.value))}))}}}}),(function(){var s=this,n=s._self._c,i=s._self._setupProxy;return n("div",{staticClass:"flex"},[n(e,{attrs:{"hide-on-click":!1},scopedSlots:s._u([{key:"dropdown",fn:function(){return[n(t,[s._l(i.newColumn,(function(e,t){return["selection"!==e.type&&"toping"!==e.type?n(a,{key:t},["boolean"==typeof e.isCustom?[n(o,{on:{change:function(e){return i.handleCommand(t)}},model:{value:e.isCustom,callback:function(t){s.$set(e,"isCustom",t)},expression:"item.isCustom"}},[s._v(" "+s._s(e.label||e.subtitle)+" "),e.isLtd?n(u,{staticClass:"ml-4x",attrs:{name:"icon-ltd",size:"1.4"}}):s._e()],1)]:[n(o,{attrs:{disabled:""},model:{value:i.isDefault,callback:function(e){i.isDefault=e},expression:"isDefault"}},[s._v(" "+s._s(e.label||e.subtitle)+" "),e.isLtd?n(u,{staticClass:"ml-4x",attrs:{name:"icon-ltd",size:"1.4"}}):s._e()],1)]],2):s._e()]}))],2)]},proxy:!0}])},[n(l,{staticClass:"column-display",attrs:{type:"default",title:s.$t("SettingListField")}},[n("i",{staticClass:"el-icon-arrow-down el-icon-setting text-[1.4rem]"})])],1)],1)}),[],!1,null,"62fe6cf9",null,null).exports;export{v as _};
