import{z as t,A as a}from"./vue-lib.js?v=1714377894636";import{g as s,a as e}from"./soft.api.js?v=1714377894636";import{J as i}from"./main.js?v=1714377894636";const l=t("SOFT-STORE",{state:()=>({tabActive:"shop",deployTab:"0",inputZipFlag:!1,speedInstallView:!1,softTabList:[{name:"shop",label:"软件商店"}],softTableParams:{p:1,type:0,tojs:"soft.get_list",force:"0",query:"",row:10},softTableData:{list:[],Mlist:[],loading:!1,total:0,searchHistory:[]},deployTableData:{list:[],showList:[],search:"",loading:!1,total:0,p:1,limit:10},searchContent:""}),actions:{chunkArray(t){const a=[];for(let s=0;s<t.list.length;s+=t.limit)a.push(t.list.slice(s,s+t.limit));return a},async getSoftTableList(t,a){try{this.softTableData.loading=!0,this.softTableParams.force=t?"1":"0";const e=await s(this.softTableParams);if(e.status){const{data:s}=e;if(this.softTableData.list=s.list.data,this.softTableData.Mlist=s.m_list,this.softTableData.searchHistory=s.search_history,this.softTableData.Mlist.length>0){const t={...this.softTableData.Mlist[0],name:"docker",version:""};this.softTableData.list.unshift(t)}this.softTableData.total=i(s.list.page),t&&!s.is_force&&void 0!==a&&a.$message.msg({dangerouslyUseHTMLString:!0,message:"云端连接失败，暂时无法获取最新的软件列表，请检查网络情况或等待5-10分钟后重试",type:"warning",duration:2e3})}}catch(e){}finally{this.softTableData.loading=!1}},async getDeployTableList(t){try{if(this.deployTableData.loading=!0,t){const t={type:this.deployTab};""!==this.deployTableData.search&&(t.search=this.deployTableData.search);const a=await e(t);if(a.status){const{data:t}=a;this.deployTableData.list=t.list,this.deployTableData.showList=this.chunkArray(this.deployTableData)[this.deployTableData.p-1]||[],this.deployTableData.total=t.list.length}}else this.deployTableData.showList=this.chunkArray(this.deployTableData)[this.deployTableData.p-1]||[]}catch(a){}finally{this.deployTableData.loading=!1}}}}),o=()=>{const t=l();return{refs:a(t),...t}};export{o as g};
