import{_ as e}from"./index118.js?v=1714377894636";import{_ as s}from"./index39.js?v=1714377894636";import{a as t,q as a,aY as l,n as r,_ as i}from"./main.js?v=1714377894636";import{_ as o}from"./index129.js?v=1714377894636";import{_ as n}from"./index59.js?v=1714377894636";import{_ as c}from"./index45.js?v=1714377894636";import{e as p,b as m,H as u,f as d,h as f,j as h}from"./vue-lib.js?v=1714377894636";import{e as y}from"./element-ui.common.js?v=1714377894636";import{g as v,es as b,et as w,eu as g,ev as x,ew as j}from"./site.store.js?v=1714377894636";import{ac as S,a0 as _,a9 as C,a3 as k}from"./site.popup.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";import"./check.js?v=1714377894636";import"./index38.js?v=1714377894636";const I=r(p({__name:"BusSslList",setup(e){const{proxy:s}=h(),{refs:{siteInfo:r,sslInfo:i,sslAlertState:o,certVerifyInfo:n,isRefreshSSL:p},getSslVerifyInfo:I,renewalBusCert:L,verifyBusCert:E,getPhpModulesList:D,getModulesList:N,getSslInfoConfig:B}=v(),P=m(["企业级证书","极速申请","防劫持/防篡改","提高SEO权重","赔付保证","不成功可退款","官方推荐(宝塔官网bt.cn也在使用)"]),A=m([{text:"如果您的站点有使用CDN、高防IP、反向代理、301重定向等功能，可能导致验证失败",color:"text-danger"},{text:"证书支持购买多年，只能一年签发一次（有效期一年），需在到期前30天内续签(续签暂不需要验证域名)。"},{text:"申请www.bt.cn这种以www为二级域名的证书，需绑定并解析顶级域名(bt.cn)，否则将验证失败。"},{text:"商用证书相对于普通证书，具有更高的安全性、赔付保障和支持通配符和多域名等方式。"}]),$=m([]),M=m(!1),H=m([{label:"域名",prop:"domainName",width:110,render:(e,s)=>e.domainName?e.domainName.join("、"):"--"},{label:"证书类型",prop:"title",width:180},{label:"到期时间",prop:"endDate",width:90,render:(e,s)=>{const t=(new Date).getTime()/1e3;let a="text-green",l=0;if(e.endDate){const s=parseInt("".concat(e.endDate));return l=parseInt("".concat((s-t)/86400)),l<=15&&(a="text-orange"),u("span",{class:l<=7?"text-danger":a},[l>0?"剩余".concat(l," 天"):"已过期"])}return u("span",["--"])}},{label:"状态",prop:"expire",showOverflowTooltip:!1,render:(e,s)=>{const l=[],r=(e,s)=>u("span",{class:"text-".concat(e)},[s]),i=u(y.Popover,{attrs:{placement:"bottom-end",width:"400","popper-class":"white-theme",trigger:"click"}},[u(t,{slot:"reference"},["排查方法?"]),u("div",{class:"bus-ssl-popover"},[u("div",{class:"ssl-popover-item"},[u("span",{class:"ssl-popover-title"},["自行排查"]),u("p",["以图文的形式，一步步教您验证并部署商业SSL"]),u(t,{attrs:{href:"https://www.bt.cn/bbs/thread-85379-1-1.html",target:"_blank"}},["如何验证商用证书?"])]),u("div",{class:"ssl-popover-item"},[u("span",{class:"ssl-popover-title"},["购买人工"]),u("p",["不会部署?人工客服帮你全程部署，不成功可退款"]),u(a,{attrs:{size:"mini"},on:{click:()=>F(e)}},["购买人工"])])])]);if(""==e.certId)l.push(u(t,{attrs:{type:"warning"},on:{click:()=>V(e)}},["待完善资料"])),l.push(i);else if(1===e.status)switch(e.orderStatus){case"COMPLETE":l.push(r("primary","订单完成"));break;case"PENDING":l.push(r("orange","验证中")),l.push(i);break;case"CANCELLED":l.push(r("medium","已取消"));break;case"FAILED":l.push(r("danger","申请失败"));break;case"EXPIRED":l.push(r("medium","已过期"));break;default:l.push(r("orange","待验证"))}else switch(e.status){case 0:l.push(r("orange","未支付"));break;case-1:l.push(r("medium","已取消"))}const o=[];return l.map(((e,s)=>{o.push(e),s<l.length-1&&o.push(u(c))})),o}},{label:"操作",prop:"ps",width:92,align:"right",render:(e,s)=>{const a=[],i=u(t,{on:{click:()=>l()}},["人工服务"]);if(e.renew&&a.push(u(t,{on:{click:()=>L(e.oid)}},["续签"])),""==e.certId)e.install&&a.push(i),a.push(u(t,{on:{click:()=>V(e)}},["完善资料"]));else if(1===e.status)switch(e.orderStatus){case"COMPLETE":a.push(u(t,{on:{click:()=>q(e,r.value.name)}},["部署"])),a.push(u(t,{on:{click:()=>R(e)}},["下载"]));break;case"PENDING":default:e.install&&a.push(i),a.push(u(t,{on:{click:()=>T(e.oid)}},["验证"]));break;case"CANCELLED":a.push(u("span",["无操作"]));break;case"FAILED":a.push(u(t,{class:"text-danger"},["申请失败"]))}else a.push(u("span",["无操作"]));const o=[];return a.map(((e,s)=>{o.push(e),s<a.length-1&&o.push(u(c))})),o}}]),O=async()=>{try{M.value=!0;const{data:e}=await w();$.value=e}catch(e){}finally{M.value=!1}},V=async e=>{let t=null;try{t=s.$load("正在获取证书默认信息，请稍后..."),await I(),_({orderInfo:e,refreshEvent:()=>O()})}catch(a){}finally{t&&t.close()}},T=async e=>{await E(e),k(n.value.isCNAME)},q=async({oid:e,title:t,domainName:a},l)=>{var i;let o=null;try{await s.$confirm({title:"部署证书",useHtml:!0,message:"是否部署该证书,是否继续？<br>\n      证书类型：".concat(t,"<br>\n      证书支持域名：").concat(a.join("、"),"<br>\n      部署站点名:").concat(l)}),o=s.$load("正在部署证书，可能等待时间较长，请稍后...");const{data:n}="nginx"===r.value.project_type||"proxy"===r.value.project_type?await x({oid:e,site_name:r.value.name}):await j({oid:e,siteName:r.value.name});if(s.$message.request(n),O(),B(),"PHP"===r.value.project_type)D();else{let e=null==(i=r.value.project_type)?void 0:i.toLowerCase();"node"===e&&(e="nodejs"),N(e)}}catch(n){}finally{o&&o.close()}},R=({oid:e})=>{window.open("/ssl?action=download_cert&oid=".concat(e))},F=async({oid:e})=>{let t=null;try{t=s.$load("正在生成支付订单,请稍侯...");const{data:a}=await b({pdata:JSON.stringify({oid:e})});S(a)}catch(a){}finally{t&&t.close()}};return d((()=>p.value),(e=>{e&&(O(),p.value=!1)})),f((()=>{O()})),{__sfc:!0,vm:s,siteInfo:r,sslInfo:i,sslAlertState:o,certVerifyInfo:n,isRefreshSSL:p,getSslVerifyInfo:I,renewalBusCert:L,verifyBusCert:E,getPhpModulesList:D,getModulesList:N,getSslInfoConfig:B,recommendList:P,busSslHelp:A,tableData:$,tableLoading:M,tableColumn:H,getCretBusSsl:O,openBusCertVerifyInfoDialog:V,applyBusSsl:()=>{C()},certVerifyWay:T,renewalBusSsl:async({oid:e})=>{let t=null;try{await s.$confirm({title:"商业证书续签",message:"当前证书订单需要重新生成新订单，需要手动续签，和重新部署证书，是否继续操作？"}),t=s.$load("正在续签商业证书，可能等待时间较长，请稍后...");const{data:a}=await g({pdata:JSON.stringify({oid:e})});s.$message.request(a),O()}catch(a){}finally{t&&t.close()}},setBusSslDeploy:q,downloadBusSsl:R,verifyBusSsl:async()=>{},buyArtificialService:F}}}),(function(){var l=this,r=l._self._c,c=l._self._setupProxy;return r("div",{staticClass:"pt-16x h-full overflow-y-hidden"},[r("div",{staticClass:"recommendList"},l._l(c.recommendList,(function(e,s){return r("div",{class:"".concat(6===s?"w-[22rem]":"w-[14rem]"," recomItem")},[r("i",{staticClass:"el-icon-check font-bold text-[#ff8d00] text-[1.6rem]"}),r("span",{staticClass:"text-[1.3rem] ml-8x text-stroke-primary"},[l._v(l._s(e))])])})),0),r("div",{staticClass:"flex flex-col w-full pt-16x"},[r(n,{scopedSlots:l._u([{key:"header-left",fn:function(){return[r("div",{staticClass:"flex items-center"},[r(a,{staticClass:"mb-16x",attrs:{type:"primary"},on:{click:c.applyBusSsl}},[l._v("申请证书")]),r(o,{attrs:{placement:"right"}},[r("div",{staticClass:"flex items-center"},[r(i,{staticClass:"mx-4x w-2rem h-2rem",attrs:{src:"../icons/we-com.svg"}}),r(t,{on:{click:function(e){}}},[l._v("售前客服")])],1)])],1)]},proxy:!0},{key:"content",fn:function(){return[r("div",{class:c.sslAlertState?"h-[32rem]":"h-[38rem]"},[r(s,{directives:[{name:"loading",rawName:"v-loading",value:c.tableLoading,expression:"tableLoading"}],ref:"busTable",attrs:{data:c.tableData,"max-height":"320",column:c.tableColumn}})],1)]},proxy:!0}])})],1),r(e,{staticClass:"ml-20x",attrs:{list:c.busSslHelp,listStyle:"disc"}})],1)}),[],!1,null,"88e854b9",null,null).exports;export{I as default};
