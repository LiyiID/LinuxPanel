import{g as s,n as e,a as t}from"./main.js?v=1714377894636";import{w as a,x as o}from"./element-lib.js?v=1714377894636";import{_ as l}from"./index40.js?v=1714377894636";import{_ as r}from"./index85.js?v=1714377894636";import{_ as m}from"./index46.js?v=1714377894636";import{e as c,b as i,v as n,j as p}from"./vue-lib.js?v=1714377894636";import{o as u}from"./confirm.js?v=1714377894636";import{P as g,G as f}from"./logs.table.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./config.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";const d=e(c({__name:"PeriodicScan",props:{compData:{default:{scan:{}}}},setup(e,{expose:t}){var a,o;const l=e,{refs:{checkedLoad:r},getPushConfigInfo:m}=s(),{proxy:c}=p(),d=i(!1),{status:v,cycle:_}=l.compData.scan,j=null!=(o=null==(a=l.compData.scan.channel)?void 0:a.split(","))?o:[],b=i(),y=n({give:j,status:"1"===v||1===v,cycle:1}),x=()=>{const{give:s,cycle:e,status:t}=y;let a=s.join(",");if(0===a.indexOf(",")&&(a=a.substring(1)),0===s.length||""===a)return c.$message.error("请选择告警方式");const o={status:t?1:0,cycle:e,channel:a,path:"/www/wwwlogs/"+l.compData.name+".log"};u({$refs:b.value,loading:d,request:async()=>await g(o),async complete(){l.compData.refreshEvent()}})},h=async()=>{r.value=!0,await m(),r.value=!1};return t({onConfirm:x}),{__sfc:!0,checkedLoad:r,getPushConfigInfo:m,props:l,vm:c,formDisabled:d,status:v,cycle:_,give:j,logScanForm:b,msgForm:y,onConfirm:x,getScanData:async()=>{var s;try{const{status:e,channel:t,cycle:a}=await f({path:"/www/wwwlogs/"+l.compData.name+".log"});y.status="1"===e||1===e,y.cycle=a,""!=t&&(y.give=null!=(s=null==t?void 0:t.split(","))?s:[]),h(),c.$message.success("刷新成功")}catch(e){}},renderPushConfig:h}}}),(function(){var s=this,e=s._self._c,c=s._self._setupProxy;return e("div",{staticClass:"p-20x"},[e(a,{ref:"logScanForm",attrs:{model:c.msgForm,disabled:c.formDisabled}},[e(o,{attrs:{label:"自动扫描"}},[e(m,{model:{value:c.msgForm.status,callback:function(e){s.$set(c.msgForm,"status",e)},expression:"msgForm.status"}})],1),e(o,{attrs:{label:"周期"}},[e(r,{attrs:{type:"number",textType:"天",disabled:""},model:{value:c.msgForm.cycle,callback:function(e){s.$set(c.msgForm,"cycle",e)},expression:"msgForm.cycle"}})],1),e(o,{attrs:{label:"告警方式"}},[e(l,{model:{value:c.msgForm.give,callback:function(e){s.$set(c.msgForm,"give",e)},expression:"msgForm.give"}})],1),e(o,{attrs:{label:" "}},[e("div",{staticClass:"text-[#666]"},[s._v(" 配置后状态未更新,请尝试[ "),e(t,{on:{click:c.getScanData}},[s._v("手动刷新")]),s._v(" ] ")],1)])],1)],1)}),[],!1,null,null,null,null).exports;export{d as default};
