import{_ as t}from"./index118.js?v=1714377894636";import{_ as e}from"./index39.js?v=1714377894636";import{l as o,n as a,q as s}from"./main.js?v=1714377894636";import{_ as i}from"./index58.js?v=1714377894636";import{_ as r}from"./index59.js?v=1714377894636";import{_ as n}from"./preload-helper.js?v=1714377894636";import{e as p,b as m,v as l,h as c,j as f}from"./vue-lib.js?v=1714377894636";import{af as d}from"./site.popup.js?v=1714377894636";import{cD as u,eC as h}from"./site.store.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";import"./check.js?v=1714377894636";const _=a(p({__name:"SafeMonitor",props:{compData:{default:()=>({})}},setup(t){const e=t,{proxy:a}=f(),s=m(),i=l({list:[],load:!1}),r=m([{active:!0,content:"添加监视器",event:()=>{p()}}]),p=()=>o({title:"添加文件监视器",area:47,isAsync:!0,component:()=>n((()=>import("./AddSiteFileMonitor.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),compData:{name:e.compData.name,path:e.compData.path,refresh:y},showFooter:!0}),_=async t=>{try{await a.$confirm({title:"删除监视器",width:"35rem",icon:"warning",iconColor:"#E6A23C",message:"您真的要删除路径【".concat(t.path,"】的监视器吗？")});const o=await h({domain:e.compData.name,type:t.type,path:t.path});o.status?(a.$message.success("删除成功"),y()):a.$message.error(o.msg)}catch(o){}},j=async t=>{o({title:"编辑文件监视器",area:47,isAsync:!0,component:()=>n((()=>import("./AddSiteFileMonitor.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),compData:{name:e.compData.name,path:t.path,refresh:y,row:t},showFooter:!0})},y=async()=>{try{i.load=!0;const t=await u();t.status||a.$message.error(t.msg);const o=t.data.sites.find((t=>t.path===e.compData.path&&t.site_name===e.compData.name));if(o){const t=[];for(const e in o.config.file_info)Object.prototype.hasOwnProperty.call(o.config.file_info,e)&&t.push({...o.config.file_info[e],path:e});i.list=t}}catch(t){}finally{i.load=!1}},b=d({deleteEvent:_,openSetting:j});return c((()=>{y()})),{__sfc:!0,vm:a,props:e,ftpTable:s,monitorData:i,helpList:[{text:"安全告警默认会监视当前网站访问非当前网站文件的行为(例：你的站点A.com访问了站点B.com的文件或者目录)，通过添加监视器路径，当路径被访问时发送告警"},{text:"告警频率：60秒某一个告警行为只会发送一次告警"},{useHtml:!0,content:'<a class="btlink" style="color:#20a53a;" href="https://www.bt.cn/bbs/thread-112442-1-1.html" target="_blank">使用教程</a>'}],tableBtnGroup:r,addMonitorDirDialog:p,deleteEvent:_,openSetting:j,getList:y,tableColumn:b}}}),(function(){var o=this,a=o._self._c,n=o._self._setupProxy;return a("div",{staticClass:"relative p-16x"},[a(r,{scopedSlots:o._u([{key:"header-left",fn:function(){return[a(i,{attrs:{group:n.tableBtnGroup}})]},proxy:!0},{key:"header-right",fn:function(){return[a(s,{attrs:{type:"default"},on:{click:n.getList}},[a("span",{staticClass:"el-icon-refresh font-bold"})])]},proxy:!0},{key:"content",fn:function(){return[a(e,{directives:[{name:"bt-loading",rawName:"v-bt-loading",value:n.monitorData.load,expression:"monitorData.load"}],ref:"ftpTable",attrs:{column:n.tableColumn,"max-height":360,data:n.monitorData.list,description:"暂无数据","element-loading-text":"正在加载，请稍后..."}})]},proxy:!0},{key:"footer-left",fn:function(){return[a(t,{staticClass:"ml-20x mt-20x",attrs:{list:n.helpList,"list-style":"disc"}})]},proxy:!0}])})],1)}),[],!1,null,"23eecdb2",null,null).exports;export{_ as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./AddSiteFileMonitor.js?v=1714377894636","./index118.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index85.js?v=1714377894636","./element-lib.js?v=1714377894636","./confirm.js?v=1714377894636","./config.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
