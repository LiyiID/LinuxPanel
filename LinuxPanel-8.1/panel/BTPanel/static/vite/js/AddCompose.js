import{w as e,x as t,o as a}from"./element-lib.js?v=1714377894636";import{n as r}from"./main.js?v=1714377894636";import{_ as s}from"./index41.js?v=1714377894636";import{e as o,A as m,v as l,f as i,b as p,h as c,j as d}from"./vue-lib.js?v=1714377894636";import{n}from"./docker.popup.js?v=1714377894636";import{Q as u,R as f}from"./docker.api.js?v=1714377894636";import{u as v}from"./docker.store.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./check.js?v=1714377894636";const _=r(o({__name:"AddCompose",props:{compData:{default:()=>({})}},setup(e,{expose:t}){const a=e,{proxy:r}=d(),s=r.$root,o=v(),{getIList:_,getTList:j}=o,{templateTableData:b}=m(o),k=l({template_id:"",project_name:"",remark:""});i((()=>a.compData),(e=>{e.isEdit&&(k.template_id=e.template_id,k.project_name=e.name,k.remark=e.remark)}),{immediate:!0});const g=p(!1),x=p([]),y=async()=>{var e,t;x.value=b.value.list.map((e=>({key:e.id,title:e.name,remark:e.remark}))),k.template_id=null==(e=x.value[0])?void 0:e.key,k.remark=null==(t=x.value[0])?void 0:t.remark};i((()=>b.value.list),(()=>{y()}),{immediate:!0});const F=p(),C={template_id:[{validator:(e,t,a)=>{""===t?a(new Error("请选择容器编排模板")):a()},trigger:["blur"]}],project_name:[{validator:(e,t,a)=>{""===t?a(new Error("请输入名称")):a()},trigger:["blur"]}]};c((()=>{0==b.value.list.length&&j(),y()}));const h=async()=>{let e=null;try{if(""===k.template_id)return void r.$message.error("请选择容器编排模板");await r.$refs.cmdFormRef.validate((async t=>{var o;if(t){e=s.loading(g,"提交中...");let t={...k,project_id:null==(o=a.compData)?void 0:o.id};const m=a.compData.isEdit?await u({data:JSON.stringify(t)}):await f({data:JSON.stringify(k)});m.status?(r.$emit("close"),_(),r.$message.success(m.msg)):(e.close(),r.$message.error(m.msg))}}))}catch(t){}};return t({onConfirm:h}),{__sfc:!0,vm:r,popupVm:s,store:o,getIList:_,getTList:j,templateTableData:b,props:a,cmdForm:k,disabled:g,selectId:e=>{var t;k.template_id=e,k.remark=null==(t=x.value.find((t=>t.key===e)))?void 0:t.remark},options:x,getOptions:y,cmdFormRef:F,cmdRules:C,onConfirm:h,addTemplateDialog:n}}}),(function(){var r=this,o=r._self._c,m=r._self._setupProxy;return o("div",{staticClass:"flex flex-col p-[2rem] lib-box"},[o(e,{ref:"cmdFormRef",staticClass:"relative w-full",attrs:{size:"small",model:m.cmdForm,rules:m.cmdRules,disabled:m.disabled,"label-position":"right"},nativeOn:{submit:function(e){e.preventDefault()}}},[o("div",{staticClass:"flex items-center mb-[1.5rem]"},[o(t,{attrs:{prop:"template_id",label:"容器编排模板"}},[o(s,{staticClass:"w-[30rem]",attrs:{options:m.options,change:m.selectId},model:{value:m.cmdForm.template_id,callback:function(e){r.$set(m.cmdForm,"template_id",e)},expression:"cmdForm.template_id"}})],1),o("div",{staticClass:"text-[#20a53a] hover:text-[#1d9534] cursor-pointer ml-[1rem]",on:{click:function(e){return m.addTemplateDialog()}}},[r._v(" 创建 ")])],1),o(t,{staticClass:"justify-center",attrs:{prop:"project_name",label:"名称"}},[o(a,{staticClass:"!w-[30rem]",attrs:{placeholder:"请输入容器编排名称"},model:{value:m.cmdForm.project_name,callback:function(e){r.$set(m.cmdForm,"project_name",e)},expression:"cmdForm.project_name"}})],1),o(t,{staticClass:"justify-center",attrs:{prop:"remark",label:"备注"}},[o(a,{staticClass:"!w-[30rem]",attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:m.cmdForm.remark,callback:function(e){r.$set(m.cmdForm,"remark",e)},expression:"cmdForm.remark"}})],1)],1)],1)}),[],!1,null,"bdefc6dd",null,null).exports;export{_ as default};
