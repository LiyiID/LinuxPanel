import{Y as e,C as t,j as a,F as s,P as l}from"./element-lib.js?v=1714377894636";import{g as i,aY as r,s as n,bY as o,j as c,p as m,n as u,q as v,D as p,a as d,F as f,b as x}from"./main.js?v=1714377894636";import{g as _}from"./__commonjsHelpers__.js?v=1714377894636";import{_ as g}from"./index118.js?v=1714377894636";import{_ as h}from"./index39.js?v=1714377894636";import{_ as w}from"./index119.js?v=1714377894636";import{_ as C}from"./preload-helper.js?v=1714377894636";import{e as y,b,v as k,c as D,H as S,i as R,j as T}from"./vue-lib.js?v=1714377894636";import{n as j,o as A,p as I,q as H,t as N,v as F,w as B}from"./home.api.js?v=1714377894636";import{getFirewallStore as P}from"./firewall.store.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./check.js?v=1714377894636";const $=_(e());const O=u(y({__name:"HomeSecurityRisks",setup(e,{expose:t}){const{refs:{authType:a}}=i(),{refs:{firewallTabActive:s,safeDetectActive:l}}=P(),{proxy:u}=T(),v=b(""),p=b(""),d=b(!1),f=b(!1),x=b(""),_=b(!1),g=b(!1),h=b(!1),w=b(!1),y=b(),$=b(!0),O=b(!1),E=b("primary"),L=b(100),M=b("!text-[#20a53A]"),J=b("safe"),q=b(),z=b("当前服务器未进行安全扫描，可能存在风险"),V=b(""),Y=b(),G=b([]),K=b([]),Q=b([]),U=b(!0),W=b([]),X=b([]),Z=b(!0),ee=b(!1),te=b("正在扫描中，请耐心等待..."),ae=k({progress:1,repairProgress:!1,repairText:"修复中.."}),se=k({processPercentage:0,processColor:"#20a53a"}),le={risk:{type:"danger",label:u.$t("HomeSecurityRisks.RiskClass[0]"),list:[]},security:{type:"primary",label:u.$t("HomeSecurityRisks.RiskClass[1]"),list:[]},ignore:{type:"warning",label:u.$t("HomeSecurityRisks.RiskClass[2]"),list:[]}},ie=k({cannot_automatically:0,failed:0,success:0}),re=b(0),ne=D((()=>K.value.filter((e=>1==e.selection)).map((e=>e.m_name)).length)),oe=b([{label:"风险项",prop:"m_name",width:150,render:e=>S("span",[e.m_name])},{label:"修复内容",prop:"msg",width:150},{label:"相关信息",prop:"type",align:"center",render:e=>Array.isArray(e.type)&&e.type.length>0?S("span",{class:"h-[3.2rem] inline-block whitespace-pre-wrap"},[e.type.join("，")]):"无"},{label:"操作结果",align:"right",render:e=>e.status?S("span",{class:"text-[#20a53a]"},["修复成功"]):S("span",{class:"text-[red]"},["修复失败"])}]),ce=k({1:{text:u.$t("HomeSecurityRisks.RiskLevel[0]"),bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:u.$t("HomeSecurityRisks.RiskLevel[1]"),bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:u.$t("HomeSecurityRisks.RiskLevel[2]"),bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),me=e=>{Q.value=e.is_autofix;for(const t in le){const a=e[t];if(Array.isArray(a)){for(let e=0;e<a.length;e++){const s=le[t].list[e];a[e].show=(null==s?void 0:s.show)||!1,a[e].selection=(null==s?void 0:s.selection)||!1}Object.keys(le).includes(t)&&"risk"==t&&(K.value=[...K.value,...a]),le[t].list=a}}x.value=e.check_time,E.value="primary",_.value=!0,O.value=!0,ve(!0),y.value=" !animate-none",localStorage.setItem("scanData",JSON.stringify(K.value)),localStorage.setItem("ignoreData",JSON.stringify(le.ignore.list)),n("lastScanTime",x.value)},ue=async(e=!1)=>{d.value=!0,te.value="正在扫描中，请稍等...";try{const t={};e&&(t.force=1);const{data:a}=await F(t);K.value=[],a.interrupt||(K.value=[],me(a),L.value=a.score,re.value=K.value.length,z.value="已完成安全扫描，",X.value=a.ignore)}catch(t){}d.value=!1},ve=e=>{let t=!1;W.value=[],K.value.forEach((e=>{Q.value.includes(e.m_name)&&(e.selection=!0,W.value.push(e),t=!0)})),t&&e?(U.value=!1,f.value=W.value.every((e=>1==e.selection))):t&&!e&&(f.value=!f.value,f.value||(W.value=[],K.value.forEach((e=>{Q.value.includes(e.m_name)&&(e.selection=!1)}))))},pe=async e=>{Y.value=[],g.value=!0,ie.cannot_automatically=e.cannot_automatically.length,ie.failed=e.failed.length,ie.success=e.success.length;for(let t in e)for(let a of e[t])G.value.push({m_name:a.m_name,type:a.result.type,msg:a.result.msg,status:a.result.status,name:t});Y.value=G,d.value=!1,K.value=K.value.filter((t=>!e.success.some((e=>e.m_name===t.m_name)))),re.value=K.value.length,localStorage.setItem("scanData",JSON.stringify(K.value))},de=()=>{const e=localStorage.getItem("scanData"),t=localStorage.getItem("ignoreData");t&&JSON.parse(t).length&&(X.value=JSON.parse(t)),e&&JSON.parse(e).length?(K.value=JSON.parse(e),O.value=!0,_.value=!0,Z.value=!1):(h.value=!0,_.value=!1),$.value=!1,x.value=o("lastScanTime")},fe=()=>{m({sourceId:68})};return R((()=>{clearInterval(q.value)})),t({onOpen:de}),{__sfc:!0,authType:a,firewallTabActive:s,safeDetectActive:l,vm:u,activeMent:v,activeMentIgnore:p,loading:d,allSelect:f,lastScanTime:x,repairAutoRiskButton:_,resultConfirm:g,emptyDetail:h,showAnimation:w,animateFlag:y,cookieRepair:$,scanSelectShow:O,scanButtonType:E,scanScore:L,scanTextClass:M,scanOuterClass:J,scanTimer:q,scanPreText:z,scanItemText:V,resultTable:Y,tableData:G,allData:K,is_autofix:Q,allSelectionDis:U,checkedData:W,ignoreData:X,isShow:Z,isIgnoreAll:ee,loadingText:te,repairData:ae,processData:se,scanData:le,resultItemLength:ie,riskNum:re,repairCheckedFlag:ne,resultColumn:oe,levelData:ce,vulnerabilityInvolvesSoftware:e=>{let t=Object.keys(e.soft_name),a="";return t.forEach(((s,l)=>{l===t.length-1?a+="".concat(t,":").concat(e.soft_name[s]):a+="".concat(t,":").concat(e.soft_name[s],"\n")})),a},handleDownloadReport:()=>{window.open("/project/security/report/html","_blank")},changeSelectValue:e=>{e.selection=!e.selection,f.value=W.value.every((e=>1==e.selection))},scanningProcess:async()=>{if(Z.value=!1,h.value=!1,L.value=100,J.value="safe",M.value="!text-[#20a53A]","info"==E.value){clearInterval(q.value),await j();const e=await A();me(e.data),L.value="?",M.value="!text-[#EF0808]",J.value="danger",d.value=!1,re.value=e.data.risk.length,z.value="扫描中断，"}else{se.processPercentage=0,w.value=!0,z.value="正在进行安全扫描...",re.value=0,V.value="正在检测...",y.value="",E.value="info",$.value=!0,_.value=!1,ue(!0);try{clearInterval(q.value),q.value=setInterval((async function(){const e=await I();se.processPercentage=e.data.percentage,re.value=e.data.count,V.value=e.data.status,L.value=e.data.score,e.data.count&&"100"!=e.data.percentage&&(M.value="!text-[#EF0808]",J.value="danger",z.value="正在进行安全扫描，"),"100"==e.data.percentage&&clearInterval(q.value),L.value>=80&&L.value<=99?(M.value="!text-[#E8D544]",J.value="risk",se.processColor="#E8D544"):L.value>=60&&L.value<=79?(M.value="!text-[#F0AD4E]",se.processColor="#F0AD4E",J.value="warn"):L.value<60&&(M.value="!text-[#EF0808]",se.processColor="#EF0808",J.value="danger")}),1e3)}catch(e){}}},handleRepairAutoRisk:()=>{if("ltd"!==a.value)return fe();try{let e=K.value.filter((e=>1==e.selection)).map((e=>e.m_name));if(0==e.length)return d.value=!1,void u.$message.error("暂无可自动修复的风险项！");d.value=!0,te.value="正在修复中,可能耗时较长,请耐心等候...",ae.progress=0;const t=H({data:JSON.stringify({m_name:e})});ae.repairProgress=!0;let a=setInterval((async()=>{const{data:e}=await N();if(ae.progress=e.percentage,ae.repairText=e.status,100===e.percentage){ae.repairText="修复完成",ae.repairProgress=!1,ae.progress=100,clearInterval(a);let e=await t;pe(e.data),ue(!0)}}),800)}catch(e){}finally{d.value=!1}},resultAssignment:me,getScanList:ue,handelAllSelection:ve,handleRepair:async(e,t)=>{if("ltd"!==a.value)return void fe();let s=K.value.filter((e=>1==e.selection)).map((e=>e.m_name));try{if(!e&&0==s.length)return void u.$message.error("请选择需要修复的风险项！");W.value.length,d.value=!0,te.value="正在修复中,可能耗时较长,请耐心等候...";const{data:a}=await H({data:JSON.stringify({m_name:e?[t.m_name]:s})});e&&a.success.length>0?(u.$message.success("修复成功"),re.value--,K.value=K.value.filter((e=>e.m_name!==t.m_name)),pe(a)):pe(a)}catch(l){}finally{d.value=!1}},handleIgnore:async(e,t)=>{try{d.value=!0,te.value="正在忽略风险项,请耐心等候...";const{data:a}=await B({m_name:e.m_name});u.$message.request(a),a.status&&(t?X.value=X.value.filter((t=>t.m_name!==e.m_name)):K.value=K.value.filter((t=>t.m_name!==e.m_name)),ue(!0))}catch(a){}finally{d.value=!1}},getRepairResult:pe,onToggle:(e,t)=>{e.show||t.forEach((e=>e.show=!1)),e.show=!e.show},onOpen:de,jumpFirewall:async(e,t)=>{await C((()=>import("./main.js?v=1714377894636").then((e=>e.ek))),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url),s.value=e,t&&(l.value=t),c("/firewall"),u.$emit("close")},openPayView:fe,onlineServiceDialog:r}}}),(function(){var e=this,i=e._self._c,r=e._self._setupProxy;return i("div",{staticClass:"h-full p-4rem"},[i("div",{staticClass:"scan-header flex items-center"},[i("div",{staticClass:"flex items-center w-full"},[r.showAnimation?e._e():i("div",{staticClass:"w-[10rem] h-[10rem] relative flex-shrink-0"},[i("span",{staticClass:"inline-block scan-icon-img icon-img-safe"}),i("span",{staticClass:"scan-icon-img-bg"}),i("span",{staticClass:"text-[3.2rem] h-[3.4rem] w-[0.7rem] text-[#20a53a] font-bold absolute-center"},[e._v("i")])]),r.showAnimation?i("div",{staticClass:"w-[10rem] h-[10rem] relative flex-shrink-0"},[i("p",{class:"box-text w-[5.8rem] "+r.scanTextClass},[e._v(" "+e._s(r.scanScore)+" "),i("span",[e._v("分")])]),i("span",{class:"scan-icon-img icon-img-"+r.scanOuterClass}),i("span",{staticClass:"circle-inner"}),i("span",{class:"circle-outer "+r.scanOuterClass}),i("div",{class:"animate-box"+r.animateFlag},[i("div",{class:"animate-box-left linear-"+r.scanOuterClass}),i("div",{staticClass:"animate-box-right"}),i("div",{staticClass:"animate-box-bottom"})])]):e._e(),i("div",{staticClass:"w-full text-[#333] text-[2rem] flex flex-col ml-[3rem]"},[i("div",{staticClass:"flex items-center w-full justify-between"},[i("span",[e._v(e._s(r.scanPreText)),r.riskNum?i("span",[e._v("已检测到"),i("span",{staticClass:"mx-4x text-[2.4rem] mx-4x text-danger"},[e._v(e._s(r.riskNum))]),e._v("个风险")]):e._e()]),i("div",{staticClass:"flex items-center"},[r.repairAutoRiskButton&&r.cookieRepair?e._e():i(v,{class:"w-[9rem] "+("info"==r.scanButtonType?"bg-[#CBCBCB]":""),attrs:{type:r.scanButtonType,round:""},nativeOn:{click:function(e){return r.scanningProcess.apply(null,arguments)}}},[e._v(" "+e._s("info"==r.scanButtonType?"停止扫描":"立即扫描")+" ")]),r.repairAutoRiskButton&&r.cookieRepair?i(v,{staticClass:"!p-[0]",attrs:{type:"text",round:""},on:{click:r.scanningProcess}},[e._v(" 重新扫描 ")]):e._e(),r.repairAutoRiskButton&&r.cookieRepair?i(v,{staticClass:"w-[9rem]",attrs:{round:"",type:r.scanButtonType},on:{click:r.handleRepairAutoRisk}},[e._v(" 一键修复 ")]):e._e()],1)]),"info"===r.scanButtonType||r.repairAutoRiskButton?e._e():i("span",{staticClass:"text-[1.4rem] text-[#666] mt-[1rem]"},[e._v(" 扫描后将自动修复所有可修复的风险项，并获取最新安全扫描报告 ")]),"info"===r.scanButtonType||r.repairAutoRiskButton?e._e():i(v,{staticClass:"w-[1.6rem] !p-0 !mt-12x text-[1.4rem]",attrs:{type:"text"},on:{click:r.handleDownloadReport}},[e._v(" >>下载当前安全扫描报告 ")]),"info"==r.scanButtonType?i("span",{staticClass:"text-[1.4rem] text-[#666] mt-[1rem]"},[e._v(e._s(r.scanItemText))]):e._e(),"info"==r.scanButtonType?i(w,{staticClass:"mt-[1.6rem] h-[1rem]",attrs:{"process-color":r.processData.processColor,percentage:r.processData.processPercentage,"stroke-width":10,"show-text":!1}}):e._e(),r.repairAutoRiskButton?i("span",{staticClass:"text-[1.4rem] mt-12x text-[#666] flex items-center"},[e._v(" 上次扫描时间："+e._s(r.lastScanTime)+" ")]):e._e(),r.repairAutoRiskButton&&r.cookieRepair?i("span",{staticClass:"text-[1.4rem] mt-12x text-[#F0AD4E] flex items-center"},[e._v(" 若安装了【系统加固】，请先关闭再进行一键修复 ")]):e._e()],1)])]),r.scanSelectShow?i("div",{staticClass:"mt-[4rem] text-[1.4rem] w-full flex items-center justify-between"},[i("div",{staticClass:"items-center flex"},[i(p,{staticClass:"text-[#666] font-500",attrs:{value:r.allSelect,disabled:r.allSelectionDis},on:{change:r.handelAllSelection}},[e._v("全选")]),i("span",{class:r.repairCheckedFlag?"ml-20x text-[1.4rem] text-[#20a53a] cursor-pointer hover:text-[#1d9534]":"ml-20x text-[1.4rem] text-[#999] cursor-not-allowed ",on:{click:function(e){return r.handleRepair(!1,null)}}},[e._v("修复选中项 ")])],1),i("div",[i(d,{staticClass:"mr-[1rem]",on:{click:function(e){r.isIgnoreAll=!0}}},[e._v("忽略扫描项")]),i("span",{staticClass:"text-[#999] mx-4x"},[e._v("|")]),i(v,{staticClass:"text-[#20a53a] !text-[1.4rem]",attrs:{type:"text"},on:{click:r.handleDownloadReport}},[i(f,{staticClass:"mr-4x",attrs:{name:"icon-safe-report",size:"1.4"}}),e._v("下载安全扫描报告")],1)],1)]):e._e(),r.emptyDetail?e._e():i("div",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],staticClass:"scan-body my-[2rem]",class:r.isShow?"h-[28rem]":"h-[38rem]",attrs:{"element-loading-text":r.loadingText}},[i(t,{attrs:{accordion:""},model:{value:r.activeMent,callback:function(e){r.activeMent=e},expression:"activeMent"}},[i("div",{staticClass:"module-list overflow-auto",class:r.isShow?"h-[28rem]":"h-[38rem]"},e._l(r.allData,(function(t,a){return i("div",{key:"".concat(a),staticClass:"module-item text-[1.2rem]"},[i("div",{staticClass:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},[i("div",{staticClass:"w-full flex items-center"},[i(p,{attrs:{value:t.selection,disabled:!r.is_autofix.includes(t.m_name)},on:{change:function(e){return r.changeSelectValue(t)}}}),i("span",{staticClass:"text-[1.2rem] h-[2.2rem] flex items-center px-8x rounded-[0.2rem] ml-8x mr-[1rem]",style:{color:r.levelData[t.level].color,backgroundColor:r.levelData[t.level].bg}},[e._v(e._s(r.levelData[t.level].text))]),i("div",{staticClass:"w-[16rem] max-w-[16rem] truncate",style:{color:r.levelData[t.level].color},attrs:{title:t.ps?t.ps:t.vuln_name}},[e._v(" "+e._s(t.ps?t.ps:t.vuln_name)+" ")]),r.is_autofix.includes(t.m_name)?e._e():i("div",{staticClass:"text-[#666] text-[1.2rem] ml-[6rem]"},[e._v(" 无法自动修复，请手动处理或"),i(d,{on:{click:function(e){return r.onlineServiceDialog()}}},[e._v("联系人工")])],1)],1),i("div",{staticClass:"flex items-center"},[i(d,{directives:[{name:"show",rawName:"v-show",value:!!r.is_autofix.includes(t.m_name),expression:"is_autofix.includes(item.m_name) ? true : false"}],staticClass:"w-[4.2rem]",on:{click:function(e){return r.handleRepair(!0,t)}}},[e._v(" 修复 "),i("span",{staticClass:"text-[#999] mx-4x"},[e._v("|")])]),i(d,{staticClass:"w-[4.2rem]",attrs:{type:"info",underline:!1},on:{click:function(e){return r.handleIgnore(t,!1)}}},[e._v(" 忽略 "),i("span",{staticClass:"text-[#999] mx-4x"},[e._v("|")])]),i(d,{staticClass:"w-[5.4rem] flex items-center",on:{click:function(e){return r.onToggle(t,r.allData)}}},[e._v(" "+e._s(t.show?e.$t("HomeSecurityRisks.Fold"):e.$t("HomeSecurityRisks.Details"))),i("i",{class:"text-[1.4rem] text-[#999] ml-4x el-icon-arrow-"+(t.show?"up":"down")})])],1)]),i($,[i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],staticClass:"px-[3rem] py-[3.2rem] bg-[#F8F8F8]"},[i("div",{staticClass:"flex items-center"},[i("div",{staticClass:"text-[#333]"},[e._v(" "+e._s(t.ps?e.$t("HomeSecurityRisks.RiskDetails[2]"):e.$t("HomeSecurityRisks.RiskDetails[5]"))+" ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.msg,expression:"item.msg"}],staticClass:"collapse-item",domProps:{innerHTML:e._s(t.msg)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.soft_name,expression:"item.soft_name"}],staticClass:"collapse-item"},[e._v(" "+e._s(t.soft_name?r.vulnerabilityInvolvesSoftware(t):"")+" ")])]),i("div",{staticClass:"flex mt-16x items-center"},[i("div",{directives:[{name:"t",rawName:"v-t",value:"HomeSecurityRisks.RiskDetails[3]",expression:"`HomeSecurityRisks.RiskDetails[3]`"}]}),t.tips?i("div",{staticClass:"collapse-item flex-col !items-start"},e._l(t.tips,(function(t,a){return i("p",{key:a,class:0==a?"":"mt-4x"},[e._v(" "+e._s(a+1)+"、"+e._s(t)+" ")])})),0):e._e(),t.vuln_solution?i("div",{staticClass:"collapse-item"},[e._v(" "+e._s(t.vuln_solution)+" ")]):e._e()]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.remind,expression:"item.remind"}],staticClass:"flex mt-16x items-center"},[i("div",{directives:[{name:"t",rawName:"v-t",value:"HomeSecurityRisks.RiskDetails[6]",expression:"`HomeSecurityRisks.RiskDetails[6]`"}]}),i("div",{staticClass:"collapse-item"},[e._v(" "+e._s(t.remind)+" ")])])])])],1)})),0)])],1),r.emptyDetail?i("div",{staticClass:"scan-body flex justify-center flex-col my-[2rem] relative",class:r.isShow?"h-[30rem]":"h-[40rem]"},[i("span",{staticClass:"bg-[#f2f2f2] h-[3rem] w-[33%] mb-12x"}),e._l(4,(function(e,t){return i("span",{staticClass:"bg-[#f2f2f2] h-[3rem] w-full mb-12x"})})),i("span",{staticClass:"bg-[#f2f2f2] h-[3rem] w-[60%] mb-12x"}),e._l(3,(function(e,t){return i("span",{staticClass:"bg-[#f2f2f2] h-[3rem] w-full mb-12x"})})),i("span",{staticClass:"bg-[#f2f2f2] h-[3rem] w-[40%] mb-12x"})],2):e._e(),i("div",{staticClass:"scan-recommend"},[i("span",{staticClass:"cursor-pointer",on:{click:function(e){r.isShow=!r.isShow}}},[i("i",{staticClass:"mr-[0.6rem]",class:r.isShow?"el-icon-arrow-up":"el-icon-arrow-down"}),i("span",[e._v("更多安全工具")])]),r.isShow?i("div",{staticClass:"scan-recommend-body"},[i(a,{staticClass:"relative item",attrs:{effect:"dark",content:"点击跳转到功能页",placement:"top-start"}},[i("div",{staticClass:"scan-recommend-body-box",on:{click:function(e){return r.jumpFirewall("safeDetect")}}},[i("div",{staticClass:"scan-recommend-body-box-title"},[e._v("动态查杀")]),i("div",{staticClass:"scan-recommend-body-box-desc"},[e._v("支持定时动态查杀木马隔离")]),i(f,{staticClass:"absolute bottom-0 left-[0.8rem]",attrs:{name:"icon-dynamic-kill",size:"5"}})],1)]),i(a,{staticClass:"relative tem",attrs:{effect:"dark",content:"点击跳转到功能页",placement:"top-start"}},[i("div",{staticClass:"scan-recommend-body-box safaty-detect",on:{click:function(e){return r.jumpFirewall("safeDetect","safeDetect")}}},[i("div",{staticClass:"scan-recommend-body-box-title"},[e._v("安全检测")]),i("div",{staticClass:"scan-recommend-body-box-desc"},[e._v("更全面的服务器检测")]),i(f,{staticClass:"absolute bottom-0 left-[0.8rem]",attrs:{name:"icon-safaty-detect",size:"5"}})],1)]),i(a,{staticClass:"relative item",attrs:{effect:"dark",content:"点击跳转到功能页",placement:"top-start"}},[i("div",{staticClass:"scan-recommend-body-box bug-scan",on:{click:function(e){return r.jumpFirewall("safeDetect","vulnerabilityScanning")}}},[i("div",{staticClass:"scan-recommend-body-box-title"},[e._v("网站漏洞扫描")]),i("div",{staticClass:"scan-recommend-body-box-desc"},[e._v("针对网站漏洞的专享扫描工具")]),i(f,{staticClass:"absolute bottom-0 left-[0.8rem]",attrs:{name:"icon-bug-scan",size:"5"}})],1)])],1):e._e()]),i(x,{attrs:{title:"结果确认","show-footer":!1,area:54,visible:r.resultConfirm},on:{"update:visible":function(e){r.resultConfirm=e}}},[i("div",{staticClass:"flex flex-col p-20x"},[i("span",{staticClass:"text-[1.6rem] mb-20x"},[e._v("修复结果：修复成功"),i("span",{staticClass:"text-primary"},[e._v(e._s(r.resultItemLength.success))]),e._v("项，修复失败"),i("span",{staticClass:"text-danger"},[e._v(" "+e._s(r.resultItemLength.failed))]),e._v("项，忽略"),i("span",{staticClass:"text-medium"},[e._v(e._s(r.resultItemLength.cannot_automatically))]),e._v("项")]),i(h,{attrs:{"max-height":"400",data:r.resultTable,column:r.resultColumn}}),i(g,{staticClass:"ml-8x mt-12x",attrs:{list:[{text:"如有修复失败项，请关闭当前窗口，根据解决方案手动进行修复"}]}})],1)]),i(x,{attrs:{title:"","show-footer":!1,area:54,visible:r.repairData.repairProgress,showClose:!1},on:{"update:visible":function(t){return e.$set(r.repairData,"repairProgress",t)}}},[i("div",{staticClass:"p-12x flex flex-col items-start"},[i(s,{staticClass:"!w-full",attrs:{color:"#20a53a","text-inside":!0,"stroke-width":20,percentage:r.repairData.progress}}),i("span",[e._v(e._s(r.repairData.repairText))])],1)]),i(x,{attrs:{title:"忽略风险项",area:66,visible:r.isIgnoreAll,"show-footer":!1},on:{"update:visible":function(e){r.isIgnoreAll=e}}},[r.emptyDetail?e._e():i("div",{directives:[{name:"bt-loading",rawName:"v-bt-loading",value:r.loading,expression:"loading"}],staticClass:"scan-body p-[2rem]"},[i(t,{class:"".concat(r.ignoreData.length?"":"!border-top-0"),attrs:{accordion:""},model:{value:r.activeMentIgnore,callback:function(e){r.activeMentIgnore=e},expression:"activeMentIgnore"}},[i("div",{staticClass:"module-list overflow-auto h-[38rem]"},[e._l(r.ignoreData,(function(t,a){return i("div",{key:"".concat(a),staticClass:"module-item text-[1.2rem]"},[i("div",{staticClass:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},[i("div",{staticClass:"w-full flex items-center"},[i("span",{staticClass:"text-[1.2rem] h-[2.2rem] flex items-center px-8x rounded-[0.2rem] ml-8x mr-[1rem]",style:{color:r.levelData[t.level].color,backgroundColor:r.levelData[t.level].bg}},[e._v(e._s(r.levelData[t.level].text))]),i("div",{staticClass:"w-[36rem] max-w-[36rem] truncate",style:{color:r.levelData[t.level].color},attrs:{title:t.ps?t.ps:t.vuln_name}},[e._v(" "+e._s(t.ps?t.ps:t.vuln_name)+" ")])]),i("div",{staticClass:"flex items-center"},[i(d,{staticClass:"w-[6.6rem]",on:{click:function(e){return r.handleIgnore(t,!0)}}},[e._v(" 移除忽略 "),i("span",{staticClass:"text-[#999] mx-4x"},[e._v("|")])]),i(d,{staticClass:"w-[5.4rem] flex items-center",on:{click:function(e){return r.onToggle(t,r.ignoreData)}}},[e._v(" "+e._s(t.show?e.$t("HomeSecurityRisks.Fold"):e.$t("HomeSecurityRisks.Details"))),i("i",{class:"text-[1.4rem] text-[#999] ml-4x el-icon-arrow-"+(t.show?"up":"down")})])],1)]),i($,[i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],staticClass:"px-[3rem] py-[3.2rem] bg-[#F8F8F8]"},[i("div",{staticClass:"flex items-center"},[i("div",{staticClass:"text-[#333]"},[e._v(" "+e._s(t.ps?e.$t("HomeSecurityRisks.RiskDetails[2]"):e.$t("HomeSecurityRisks.RiskDetails[5]"))+" ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.msg,expression:"item.msg"}],staticClass:"collapse-item",domProps:{innerHTML:e._s(t.msg)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.soft_name,expression:"item.soft_name"}],staticClass:"collapse-item"},[e._v(" "+e._s(t.soft_name?r.vulnerabilityInvolvesSoftware(t):"")+" ")])]),i("div",{staticClass:"flex mt-16x items-center"},[i("div",{directives:[{name:"t",rawName:"v-t",value:"HomeSecurityRisks.RiskDetails[3]",expression:"`HomeSecurityRisks.RiskDetails[3]`"}]}),t.tips?i("div",{staticClass:"collapse-item flex-col !items-start"},e._l(t.tips,(function(t,a){return i("p",{key:a,class:0==a?"":"mt-4x"},[e._v(" "+e._s(a+1)+"、"+e._s(t)+" ")])})),0):e._e(),t.vuln_solution?i("div",{staticClass:"collapse-item"},[e._v(" "+e._s(t.vuln_solution)+" ")]):e._e()]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.remind,expression:"item.remind"}],staticClass:"flex mt-16x items-center"},[i("div",{directives:[{name:"t",rawName:"v-t",value:"HomeSecurityRisks.RiskDetails[6]",expression:"`HomeSecurityRisks.RiskDetails[6]`"}]}),i("div",{staticClass:"collapse-item"},[e._v(" "+e._s(t.remind)+" ")])])])])],1)})),r.ignoreData.length?e._e():i(l,{attrs:{description:"暂无忽略的风险项"}})],2)])],1)])],1)}),[],!1,null,"aa0aeb05",null,null).exports;export{O as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
