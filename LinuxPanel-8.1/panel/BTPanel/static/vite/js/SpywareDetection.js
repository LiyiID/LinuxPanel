import{_ as t}from"./index118.js?v=1714377894636";import{_ as e}from"./index53.js?v=1714377894636";import{_ as a}from"./index39.js?v=1714377894636";import{_ as s}from"./index46.js?v=1714377894636";import{du as l,dv as i,dw as n,dx as o,n as r,q as c}from"./main.js?v=1714377894636";import{_ as p}from"./index58.js?v=1714377894636";import{_ as m}from"./index59.js?v=1714377894636";import{e as d,b as h,v as u,h as y,j as f}from"./vue-lib.js?v=1714377894636";import{getFirewallStore as b}from"./firewall.store.js?v=1714377894636";import{p as w}from"./firewall.table.js?v=1714377894636";import{q as g,r as v,I as x,S as _}from"./firewall.popup.js?v=1714377894636";import{o as j}from"./index61.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./check.js?v=1714377894636";import"./index38.js?v=1714377894636";const S=r(d({__name:"SpywareDetection",setup(t){const{proxy:e}=f(),{refs:{isSpywareDetection:a,webshellTotal:s,spywareTableData:r,loading:c},getServiceStatusEvent:p,getIsolationFileNum:m,spywareTableDataEvent:d}=b(),S=h([{text:"注意：隔离文件后的数字表示隔离文件总数"},{color:"text-[#FF6500]",text:"动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离"}]),C=h([]),D=u({isRecurrence:!1,describe:{title:"",th:"",message:""}}),k=h([{active:!0,content:"添加目录",event:()=>{g()}},{content:"白名单",event:()=>{v()}}]),T=[{value:"startOpen",label:"开启监听目录",diyBatch:()=>{B(!0)}},{value:"stopOpen",label:"关闭监听目录",diyBatch:()=>{B(!1)}},{value:"deleteMonitorDir",label:"删除监听目录",diyBatch:()=>{j({title:"批量删除监听目录，该目录将不在自动进行木马查杀和病毒文件隔离，是否继续操作？",titleType:"批量删除监听目录",dataList:C.value,requestFun:async t=>await l({path:t.path}),isRecurrence:!0,tableColumn:[{prop:"path",label:"目录"},{prop:"status",label:"状态"}],callback:()=>{d()}})}}],B=t=>j({title:"".concat(t?"开启":"关闭","监听目录,").concat(t?"开启后目录将会对自动的进行木马查杀并进行隔离":"关闭后目录将不会对自动的进行木马查杀并进行隔离",",是否继续操作？"),titleType:"".concat(t?"开启":"关闭","监听目录"),dataList:C.value,requestFun:async e=>await i(!t,{data:JSON.stringify({path:e.path})}),isRecurrence:!0,tableColumn:[{prop:"path",label:"目录"},{prop:"status",label:"状态"}],callback:()=>{d()}}),q=async t=>{_(t)},E=async t=>{try{await e.$confirm({icon:"warning",title:"删除监控【"+t.path+"】",width:"34rem",message:"删除后无法继续监控该网站，是否继续？"});const a=e.$load("正在删除监控，请稍后..."),s=await l({path:t.path});await e.$message.request(s),d(),a.close()}catch(a){}},$=async t=>{try{const a=e.$load("正在设置监控状态，请稍后..."),s=await n({path:t.path,ps:t.ps});await e.$message.request(s),a.close()}catch(a){}},F=async t=>{try{const a=e.$load("正在切换监控状态，请稍后..."),s=await i(t.open,{data:JSON.stringify({path:t.path})});await e.$message.request(s),d(),a.close()}catch(a){}},O=w({changeStatus:F,setPsEvent:$,scanRow:q,deleteRow:E});return y((()=>{d(),m(),p()})),{__sfc:!0,vm:e,isSpywareDetection:a,webshellTotal:s,getData:r,loading:c,getServiceStatusEvent:p,getIsolationFileNum:m,spywareTableDataEvent:d,help_list:S,checkedList:C,batchConfig:D,tableBtnGroup:k,tableBatch:T,handleBatchSet:B,handleSelectionChange:t=>{C.value=t},handleBatchClick:async t=>{},scanRow:q,deleteRow:E,setPsEvent:$,onChangeSpywareDetection:async t=>{const a=e.$load("正在"+(t?"开启":"关闭")+"动态查杀开关，请稍后...");try{const s=await o(!t);await e.$message.request(s),a.close()}catch(s){}finally{a&&a.close()}},changeStatus:F,batchEvent:async(t,e,a)=>{switch(t){case"startOpen":case"stopOpen":return await i("startOpen"!==t,{data:JSON.stringify({path:e.path})});case"deleteMonitorDir":return await l({path:e.path})}return Promise.resolve()},tableColumn:O,IsolationFileDialog:x}}}),(function(){var l=this,i=l._self._c,n=l._self._setupProxy;return i("div",{staticClass:"py-20x"},[i(m,{scopedSlots:l._u([{key:"header-left",fn:function(){return[i("div",{staticClass:"flex items-center"},[i(p,{attrs:{group:n.tableBtnGroup}}),i(c,{staticClass:"!ml-12x",attrs:{type:"default"},on:{click:function(t){return n.IsolationFileDialog()}}},[i("span",[l._v("隔离文件")]),i("span",{class:(n.webshellTotal>0?"bg-[red]":"bg-[#f0ad4e]")+" ml-4x py-1x px-4x text-white text-center font-bold"},[l._v(l._s(n.webshellTotal))])]),i("div",{staticClass:"bg-[#ccc] w-[1px] h-2rem mx-8"}),i("div",{staticClass:"mr-4"},[l._v("动态查杀开关")]),i("div",[i(s,{attrs:{width:36},on:{change:n.onChangeSpywareDetection},model:{value:n.isSpywareDetection,callback:function(t){n.isSpywareDetection=t},expression:"isSpywareDetection"}})],1)],1)]},proxy:!0},{key:"content",fn:function(){return[i(a,{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],ref:"portTable",attrs:{column:n.tableColumn,data:n.getData,description:"木马查杀列表为空","element-loading-text":"正在加载木马查杀列表，请稍后..."},on:{"selection-change":n.handleSelectionChange}})]},proxy:!0},{key:"footer-left",fn:function(){return[i(e,{attrs:{config:n.batchConfig,data:n.tableBatch,"batch-fn":n.batchEvent},on:{"handle-complete":function(t){return n.spywareTableDataEvent()},"handle-batch":n.handleBatchClick}})]},proxy:!0}])}),i(t,{staticClass:"mx-[1.6rem] my-[0.6rem]",attrs:{list:n.help_list,listStyle:"disc"}})],1)}),[],!1,null,null,null,null).exports;export{S as default};
