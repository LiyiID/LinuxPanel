import{_ as r}from"./index118.js?v=1714377894636";import{_ as e}from"./index85.js?v=1714377894636";import{w as t,x as o}from"./element-lib.js?v=1714377894636";import{cu as s,cv as a,n as l}from"./main.js?v=1714377894636";import{_ as p}from"./index41.js?v=1714377894636";import{e as i,b as d,f as m,S as c,j as n}from"./vue-lib.js?v=1714377894636";import{b as u}from"./check.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{getFirewallStore as _}from"./firewall.store.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";const f=l(i({__name:"FirewallEditForward",props:{compData:{default:()=>{}}},setup(r,{expose:e}){const t=r,{getFirewalInfoEvent:o}=_(),{proxy:l}=n(),p=d({protocol:t.compData.protocol?t.compData.protocol:"tcp",s_ports:t.compData.start_port?t.compData.start_port:"",d_ports:t.compData.ended_port?t.compData.ended_port:"",d_address:t.compData.ended_ip?t.compData.ended_ip:"",id:t.compData.id?t.compData.id:""}),i=d([{text:"如果是本机端口转发，目标IP为：127.0.0.1"},{text:"如果目标IP不填写，默认则为本机端口转发!"}]),f=d([{title:"TCP",key:"tcp"},{title:"UDP",key:"udp"},{title:"TCP/UDP",key:"tcp/udp"}]),b=d(!!t.compData.id);m((()=>t.compData),(r=>{b.value=!!r.id,p.value.protocol=r.protocol?r.protocol:"tcp",p.value.s_ports=r.start_port?r.start_port:"",p.value.d_ports=r.ended_port?r.ended_port:"",p.value.d_address=r.ended_ip?r.ended_ip:"",p.value.id=r.id?r.id:""}));const v={s_ports:[{validator:(r,e,t)=>{if(!(e.length>0))return t(new Error("请输入源端口"));u(e)?t():t(new Error(l.$t("safety.portPlaceHolder")))},trigger:["blur","change"]}],d_ports:[{validator:(r,e,t)=>{if(!(e.length>0))return t(new Error("请输入目标端口"));u(e)?t():t(new Error(l.$t("safety.portPlaceHolder")))},trigger:["blur","change"]}]},F=c("reload",(()=>{})),j=()=>{l.$refs.editIpRules.resetFields(),F()},h=async r=>{l.$refs.editIpRules.validate((async e=>{let i=l.$load(l.$t("Loading"));try{if(e){const e=p.value;b.value||delete e.id,""==e.d_address&&(e.d_address="127.0.0.1");const i=b.value?await s({data:JSON.stringify(e)}):await a({data:JSON.stringify(e)});l.$message.request(i),i.status&&(j(),r(),t.compData.refresh(),o())}!e&&await l.$message.error("请检查输入内容是否正确！")}catch(d){}finally{i.close()}}))};return e({onConfirm:h,onCancel:j}),{__sfc:!0,props:t,getFirewalInfoEvent:o,vm:l,ruleForm:p,helpList:i,protocolOptions:f,isEdit:b,rules:v,reloadData:F,onCancel:j,submitFrom:h}}}),(function(){var s=this,a=s._self._c,l=s._self._setupProxy;return a(t,{ref:"editIpRules",staticClass:"p-[2rem] addfrom",attrs:{rules:l.rules,model:l.ruleForm,"label-width":"5rem"}},[a(o,{attrs:{label:"协议"}},[a(p,{staticClass:"w-[20rem]",attrs:{options:l.protocolOptions},model:{value:l.ruleForm.protocol,callback:function(r){s.$set(l.ruleForm,"protocol",r)},expression:"ruleForm.protocol"}})],1),a(o,{attrs:{label:"源端口",prop:"s_ports"}},[a(e,{attrs:{type:"number",min:"1",max:"65535",width:"20rem",placeholder:"请输入源端口"},model:{value:l.ruleForm.s_ports,callback:function(r){s.$set(l.ruleForm,"s_ports",r)},expression:"ruleForm.s_ports"}})],1),a(o,{attrs:{label:"目标IP"}},[a(e,{attrs:{width:"20rem",placeholder:"请输入目标IP地址",clearable:""},model:{value:l.ruleForm.d_address,callback:function(r){s.$set(l.ruleForm,"d_address",r)},expression:"ruleForm.d_address"}})],1),a(o,{attrs:{label:"目标端口",prop:"d_ports"}},[a(e,{attrs:{width:"20rem",placeholder:"请输入目标端口",clearable:""},model:{value:l.ruleForm.d_ports,callback:function(r){s.$set(l.ruleForm,"d_ports",r)},expression:"ruleForm.d_ports"}})],1),a(r,{staticClass:"pl-[3.6rem] pt-[2.4rem]",attrs:{list:l.helpList,listStyle:"disc"}})],1)}),[],!1,null,null,null,null).exports;export{f as default};
