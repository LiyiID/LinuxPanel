import{H as a,I as s}from"./element-lib.js?v=1714377894636";import{c1 as e,n as t}from"./main.js?v=1714377894636";import"./index39.js?v=1714377894636";import{e as o,b as l,h as r,j as c}from"./vue-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";const p=t(o({__name:"bachDialog",props:{compData:{default:{title:"批量操作",dataList:[],requestFun:async()=>{},isRecurrence:!1,diyRes:!1,isCloseRes:!1,tableColumn:[{prop:"name",label:"名称"},{prop:"status",label:"状态"}],resDescription:{success:"处理成功",wait:"等待处理",error:"处理失败"},resDescriptionColor:{success:"text-primary",error:"text-danger",wait:"text-warning"},isReturnResult:!1,callback:()=>{}}}},setup(a,{expose:s}){const t=a,o=l(t.compData.resDescription),p=l(0),{proxy:i}=c(),{loading:n,showFooterFun:u}=e(i),m=l(!1),D=l([]),d=async()=>{for(let a=0;a<D.value.length;a++){const s=await t.compData.requestFun(D.value[a]);(null==s?void 0:s.status)?D.value[a][t.compData.tableColumn[1].prop]="success":(D.value[a][t.compData.tableColumn[1].prop]="error",o.value.error=s.msg?s.msg:s.data),t.compData.isReturnResult&&(D.value[a].resultMsg=s.msg||s.data),p.value++}m.value=!0};let b=null;const v=l(!1),f=async a=>{if(b=n(v,"修改中..."),t.compData.diyRes)return await t.compData.requestFun(i),"function"==typeof u&&u(!1),void(t.compData.isCloseRes&&a());if(t.compData.isRecurrence)await d(),b.close(),t.compData.callback&&t.compData.callback(),"function"==typeof u&&u(!1);else{const a=await t.compData.requestFun(t.compData.dataList);(null==a?void 0:a.status)?D.value.forEach((s=>{s[t.compData.tableColumn[1].prop]="success",t.compData.isReturnResult&&(s.resultMsg=a.msg||a.data)})):D.value.forEach((s=>{s[t.compData.tableColumn[1].prop]="error",t.compData.isReturnResult&&(s.resultMsg=a.msg||a.data)})),m.value=!0,t.compData.callback&&t.compData.callback(),b.close(),"function"==typeof u&&u(!1)}};return s({onConfirm:f,tableList:D,successShow:m,showFooterFun:u}),r((()=>{var a;null==(a=t.compData.dataList)||a.forEach((a=>{D.value.push({...a,[t.compData.tableColumn[1].prop]:"wait"})}))})),{__sfc:!0,props:t,resDescription:o,itemKey:p,vm:i,loading:n,showFooterFun:u,successShow:m,tableList:D,recurrence:d,load:b,formDisabled:v,onConfirm:f}}}),(function(){var e,t,o,l=this,r=l._self._c,c=l._self._setupProxy;return r("div",{staticClass:"p-[2rem] flex flex-col"},[r("div",{staticClass:"flex items-center mb-20x"},[r("i",{class:c.successShow?"text-[4rem] el-icon-success text-primary":"text-[4rem] el-icon-warning text-warning"}),r("div",{directives:[{name:"show",rawName:"v-show",value:!c.successShow,expression:"!successShow"}],staticClass:"pl-2x text-[1.5rem] leading-8 ml-4x"},[l._v(" "+l._s(c.props.compData.title)+" ")]),r("div",{directives:[{name:"show",rawName:"v-show",value:c.successShow,expression:"successShow"}],staticClass:"pl-2x text-[1.5rem] leading-8 ml-4x"},[l._v("批量操作已完成！")])]),r("div",{staticClass:"res-table"},[r(a,{key:c.itemKey,attrs:{maxHeight:"360",data:c.tableList||[]}},[r(s,{attrs:{prop:"".concat((null==(e=c.props.compData.tableColumn[0])?void 0:e.prop)||"name"),label:"".concat((null==(t=c.props.compData.tableColumn[0])?void 0:t.label)||"操作项")},scopedSlots:l._u([(null==(o=l.compData.tableColumn[0])?void 0:o.prop)?null:{key:"default",fn:function({row:a}){var s;return[l._v(" "+l._s(null==(s=c.props.compData.tableColumn[0])?void 0:s.render(a))+" ")]}}],null,!0)}),r(s,{staticClass:"truncate w-[100%]",attrs:{align:"right",prop:"".concat(c.props.compData.tableColumn[1].prop),label:"".concat(c.props.compData.tableColumn[1].label)},scopedSlots:l._u([{key:"default",fn:function({row:a}){return[r("span",{staticClass:"truncate",class:"success"===a[c.props.compData.tableColumn[1].prop]?c.props.compData.resDescriptionColor.success:"wait"===a[c.props.compData.tableColumn[1].prop]?c.props.compData.resDescriptionColor.wait:c.props.compData.resDescriptionColor.error},[l._v(" "+l._s(a.resultMsg?a.resultMsg:"success"===a[c.props.compData.tableColumn[1].prop]?c.resDescription.success:"wait"===a[c.props.compData.tableColumn[1].prop]?c.resDescription.wait:c.resDescription.error)+" ")])]}}])})],1)],1)])}),[],!1,null,"4d5bcf17",null,null).exports;export{p as default};
