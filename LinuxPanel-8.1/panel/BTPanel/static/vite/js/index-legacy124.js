!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return a};var n,a={},r=Object.prototype,s=r.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(n){f=function(t,e,n){return t[e]=n}}function p(t,e,n,a){var r=e&&e.prototype instanceof w?e:w,s=Object.create(r.prototype),o=new O(a||[]);return i(s,"_invoke",{value:j(t,n,o)}),s}function m(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=p;var v="suspendedStart",d="suspendedYield",h="executing",g="completed",y={};function w(){}function _(){}function b(){}var x={};f(x,c,(function(){return this}));var P=Object.getPrototypeOf,S=P&&P(P(N([])));S&&S!==r&&s.call(S,c)&&(x=S);var E=b.prototype=w.prototype=Object.create(x);function k(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function C(e,n){function a(r,i,o,c){var l=m(e[r],e,i);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==t(f)&&s.call(f,"__await")?n.resolve(f.__await).then((function(t){a("next",t,o,c)}),(function(t){a("throw",t,o,c)})):n.resolve(f).then((function(t){u.value=t,o(u)}),(function(t){return a("throw",t,o,c)}))}c(l.arg)}var r;i(this,"_invoke",{value:function(t,e){function s(){return new n((function(n,r){a(t,e,n,r)}))}return r=r?r.then(s,s):s()}})}function j(t,e,a){var r=v;return function(s,i){if(r===h)throw new Error("Generator is already running");if(r===g){if("throw"===s)throw i;return{value:n,done:!0}}for(a.method=s,a.arg=i;;){var o=a.delegate;if(o){var c=L(o,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===v)throw r=g,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=h;var l=m(t,e,a);if("normal"===l.type){if(r=a.done?g:d,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(r=g,a.method="throw",a.arg=l.arg)}}}function L(t,e){var a=e.method,r=t.iterator[a];if(r===n)return e.delegate=null,"throw"===a&&t.iterator.return&&(e.method="return",e.arg=n,L(t,e),"throw"===e.method)||"return"!==a&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var s=m(r,t.iterator,e.arg);if("throw"===s.type)return e.method="throw",e.arg=s.arg,e.delegate=null,y;var i=s.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function N(e){if(e||""===e){var a=e[c];if(a)return a.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(s.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}throw new TypeError(t(e)+" is not iterable")}return _.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:_,configurable:!0}),_.displayName=f(b,u,"GeneratorFunction"),a.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,f(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},a.awrap=function(t){return{__await:t}},k(C.prototype),f(C.prototype,l,(function(){return this})),a.AsyncIterator=C,a.async=function(t,e,n,r,s){void 0===s&&(s=Promise);var i=new C(p(t,e,n,r),s);return a.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},k(E),f(E,u,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),a.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},a.values=N,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function a(a,r){return o.type="throw",o.arg=t,e.next=a,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=s.call(i,"catchLoc"),l=s.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&s.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,a){return this.delegate={iterator:N(t),resultName:e,nextLoc:a},"next"===this.method&&(this.arg=n),y}},a}function n(t,e,n,a,r,s,i){try{var o=t[s](i),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(a,r)}function a(t){return function(){var e=this,a=arguments;return new Promise((function(r,s){var i=t.apply(e,a);function o(t){n(i,r,s,o,c,"next",t)}function c(t){n(i,r,s,o,c,"throw",t)}o(void 0)}))}}System.register(["./index-legacy77.js?v=1714377894636","./preload-helper-legacy.js?v=1714377894636","./vue-lib-legacy.js?v=1714377894636","./main-legacy.js?v=1714377894636","./locales-lib-legacy.js?v=1714377894636","./index-legacy51.js?v=1714377894636","./element-lib-legacy.js?v=1714377894636","./index-legacy45.js?v=1714377894636","./site.store-legacy.js?v=1714377894636","./tabs-legacy.js?v=1714377894636","./index-legacy42.js?v=1714377894636","./request-lib-legacy.js?v=1714377894636","./__commonjsHelpers__-legacy.js?v=1714377894636","./modulepreload-polyfill-legacy.js?v=1714377894636","./public-lib-legacy.js?v=1714377894636","./check-legacy.js?v=1714377894636"],(function(t,n){"use strict";var r,s,i,o,c,l,u,f,p,m,v,d,h,g,y,w,_,b,x;return{setters:[function(t){r=t._},function(t){s=t._},function(t){i=t.e,o=t.b,c=t.v,l=t.c,u=t.h,f=t.j},function(t){p=t.g,m=t.aY,v=t.Q,d=t.f,h=t.n,g=t.F,y=t.q,w=t._},null,function(t){_=t._},function(t){b=t.L},null,function(t){x=t.d7},null,null,null,null,null,null,null],execute:function(){var P=i({__name:"SiteScan",props:{compData:{default:{}}},setup:function(t,n){var r,s=n.expose,i=t,h=f().proxy,g=p().refs.authType,y=o(!1),w=o([{name:"vulscan",title:"漏洞扫描"},{name:"webscan",title:"网站配置安全性"},{name:"filescan",title:"文件泄露"},{name:"backup",title:"备份文件"},{name:"webshell",title:"木马程序"},{name:"index",title:"首页内容风险"},{name:"webhorse",title:"挂马排查"},{name:"deadchain",title:"坏链检测"},{name:"database",title:"数据库安全"},{name:"ftps",title:"网站FTP风险"},{name:"backend",title:"网站后台安全"}]),_=o(0),b=o(""),P=o(""),S=c({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{},statusTotal:{},result:{},progressStatus:{},active:{}}),E=null,k=c({title:"安全扫描-功能介绍",height:36,ps:"扫描服务器系统的漏洞，异常用户，已安装软件的安全问题并提供修复方案.",source:66,desc:["漏洞扫描","网站配置安全性","文件泄露","备份文件","木马程序"],tabImgs:["https://www.bt.cn/Public/new/plugin/introduce/site/security-Introduction.png"]}),C=function(){E=v({route:"/ws_project",onMessage:D})},j=l((function(){return S.scanStatus&&!S.isEnd?"正在扫描":"定期扫描网站，提升网站安全性"})),L=l((function(){return S.scanStatus&&!S.isEnd?"".concat(b.value):S.time?"上次检测时间：".concat(S.time):"当前安全风险未知，请立即检测"})),D=function(t,e){if(e.data){var n=JSON.parse(e.data.replace(/'/g,'"'));if(n.hasOwnProperty("end")&&n.end){var a,r,s;if((null===(a=n.webinfo)||void 0===a||null===(a=a.result)||void 0===a?void 0:a[n.type].length)>0?(S.progressConfig[n.type]=n.webinfo.result[n.type],S.statusTotal[n.type]=n.webinfo.result[n.type].length):S.statusTotal[n.type]=0,b.value=n.info,_.value===w.value.length-1)return null===(s=E)||void 0===s||s.close(),_.value=0,S.scanStatus=!1,void(S.isEnd=!0);var o=(new Date).getTime();_.value++,null===(r=E)||void 0===r||r.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:o,name:i.compData.name,scan_list:[w.value[_.value].name]})}else b.value=n.info,P.value=n.type,n.is_error&&S.error++}},T=function(){var t=a(e().mark((function t(){var n,a,r,s,o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(S.scanStatus&&!S.isEnd||S.isEnd,!S.scanStatus||S.isEnd){t.next=10;break}return t.next=4,h.$confirm({title:"取消扫描",message:"确定取消扫描吗?",icon:"warning"});case 4:return null===(r=E)||void 0===r||r.close(),_.value=0,O(),t.abrupt("return");case 10:if(!S.isEnd){t.next=16;break}return t.next=13,null===(s=E)||void 0===s?void 0:s.close();case 13:return _.value=0,t.next=16,O();case 16:S.scanStatus=!0,C(),o=(new Date).getTime(),null===(n=E)||void 0===n||n.send({"x-http-token":window.vite_public_request_token}),null===(a=E)||void 0===a||a.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:o,name:i.compData.name,scan_list:[w.value[_.value].name]});case 21:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=function(){S.scanStatus=!1,S.isEnd=!1,S.error=0,S.warn=0,S.time=0,S.progress=0,S.progressConfig={vulscan:[],webscan:[],filescan:[],backup:[],webshell:[],index:[],webhorse:[],deadchain:[],database:[],ftps:[],backend:[]},S.statusTotal={},S.result={},S.progressStatus={},S.active={vulscan:!1,webscan:!1,filescan:!1,backup:!1,webshell:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1}},N=function(){var t=a(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y.value=!0,t.prev=1,t.next=4,x({data:JSON.stringify({name:i.compData.name})});case 4:if((n=t.sent).status){t.next=8;break}return h.$message.request(n),t.abrupt("return");case 8:S.isEnd=S.time||!1,S.time=d(n.data.time,"yyyy-MM-dd"),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1);case 15:return t.prev=15,y.value=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,12,15,18]])})));return function(){return t.apply(this,arguments)}}();return u((function(){N(),O()})),s({onRefresh:(r=a(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:N(),O();case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}),{__sfc:!0,vm:h,props:i,authType:g,viewLoading:y,scanIconData:w,scanIndex:_,checkName:b,checkTopic:P,scanParam:S,useSocket:E,productData:k,createWebSocket:C,progressTitle:j,progressSubTitle:L,onWSReceive:D,titleClick:function(t){S.active[t]=!S.active[t]},scanDetectEvent:T,resetData:O,getScanNum:N,onlineServiceDialog:m}}}),S=function(){var t=this,e=t._self._c,n=t._self._setupProxy;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:n.viewLoading,expression:"viewLoading"}],attrs:{id:"safeDetectList"}},["ltd"===n.authType?e("div",[e("div",{staticClass:"progress-header"},[e("div",{staticClass:"progress-header-cot"},[e("div",{staticClass:"flex items-center"},[n.scanParam.scanStatus&&!n.scanParam.isEnd?e("div",{staticClass:"scan-icon relative h-[8rem] w-[8rem]"},[e("div",{staticClass:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"}),e(g,{staticClass:"absolute top-0 left-0 right-0 bottom-0 m-[auto]",attrs:{name:"scanning-scan",size:"5"}})],1):e("div",[n.scanParam.warn||n.scanParam.error?e(g,{attrs:{name:"scanning-danger",size:"7.6"}}):e(g,{attrs:{name:"scanning-"+(n.scanParam.isEnd?"success":"risk"),size:"7.6"}})],1)])]),e("div",{staticClass:"progress-header-cot"},[e("div",{staticClass:"scanning-progress-title"},[n.scanParam.isEnd?[t._v(" 检测完成 "),n.scanParam.error>0||n.scanParam.warn>0?[t._v(" ，共发现 "),n.scanParam.error>0?[e("span",{staticClass:"text-danger"},[t._v(t._s(n.scanParam.error))]),t._v(" 项风险 ")]:t._e()]:t._e()]:[t._v(" "+t._s(n.progressTitle)+" ")]],2),e("div",{staticClass:"scanning-progress-cont"},[t._v(t._s(n.progressSubTitle))])]),e("div",{staticClass:"progress-header-cot"},[e(y,{class:{"warning-hover":n.scanParam.scanStatus&&!n.scanParam.isEnd},attrs:{type:n.scanParam.scanStatus&&!n.scanParam.isEnd?"warning":"primary",plain:!(!n.scanParam.scanStatus||n.scanParam.isEnd)},on:{click:n.scanDetectEvent}},[t._v(t._s(n.scanParam.scanStatus&&!n.scanParam.isEnd?"取消扫描":n.scanParam.isEnd?"重新检测":"立即检测"))]),n.scanParam.isEnd?e(y,{attrs:{type:"default"},on:{click:function(t){return n.onlineServiceDialog()}}},[t._v("立即修复")]):t._e()],1)]),e(b,{staticClass:"!mt-0 !mb-20x !bg-[#F1F1F1]"}),e("div",{staticClass:"progress-cont-list"},[n.scanParam.scanStatus||n.scanParam.isEnd?t._e():e("div",[e("div",{staticClass:"font-bold text-[1.6rem] text-[#666] my-[4rem]"},[t._v("支持网站以下安全扫描项:")]),e("div",{staticClass:"inline-grid grid-cols-4 w-full mt-20x"},t._l(n.scanIconData,(function(n,a){return e("div",{key:a,staticClass:"flex flex-col inline-block items-center mb-20x"},[e(w,{staticClass:"w-[6rem] inline-block mb-8x opacity-90",attrs:{src:"scan/scanning-"+n.name+"-ico.svg"}}),t._v(" "+t._s(n.title)+" ")],1)})),0)]),t._l(n.scanIconData,(function(a,r){return n.scanParam.scanStatus||n.scanParam.isEnd?e("div",{key:r,staticClass:"progress_item",class:a.name+"_item "+(n.scanParam.active[a.name]?"active":"")},[e("div",{staticClass:"progress_item_header",on:{click:function(t){return n.titleClick(a.name)}}},[e("div",{staticClass:"progress_type"},[e(w,{staticClass:"mr-12x w-[2rem]",attrs:{src:"scan/scanning-"+a.name+"-ico.svg"}}),e("span",[t._v(t._s(a.title))])],1),e("div",{staticClass:"flex-1"},[n.scanParam.statusTotal[a.name]?e("span",{staticClass:"text-danger mr-4x"},[t._v("发现"+t._s(n.scanParam.statusTotal[a.name])+"项危险")]):t._e(),n.scanParam.scanStatus&&n.checkTopic==a.name?e("span",[t._v("正在扫描...")]):t._e(),n.scanParam.scanStatus||n.scanParam.statusTotal[a.name]?t._e():e("span",{staticClass:"text-primary"},[t._v("无风险项")]),n.scanParam.scanStatus&&n.checkTopic!=a.name&&!n.scanParam.statusTotal[a.name]?e("span",[t._v("等待扫描")]):t._e()]),e("div",{staticClass:"progress_fold text-[1.2rem] flex items-center"},[e("span",{staticClass:"mr-4x"},[t._v(" "+t._s(n.scanParam.active[a.name]?"收起":"展开")+" ")]),e("i",{class:n.scanParam.active[a.name]?"el-icon-arrow-up":"el-icon-arrow-down"})])]),e("div",{directives:[{name:"show",rawName:"v-show",value:n.scanParam.active[a.name],expression:"scanParam.active[value.name]"}],staticClass:"progress_item_body"},t._l(n.scanParam.progressConfig[a.name],(function(n,a){return e("div",{key:a,staticClass:"progress_item_info"},[e("div",{staticClass:"flex flex-col py-8x px-12x text-[1.2rem]"},[e("span",[t._v(t._s(n.name))]),e("div",{directives:[{name:"show",rawName:"v-show",value:n.repair,expression:"item.repair"}]},[e(b,{staticClass:"!my-8x"}),e("span",{staticClass:"whitespace-normal leading-2rem"},[t._v(t._s(n.repair))])],1)])])})),0)]):t._e()}))],2)],1):e(_,{staticClass:"p-20x",attrs:{data:n.productData}})],1)},E=h(P,S,[],!1,null,"95d377f3",null,null).exports;t("default",h(i({__name:"index",props:{compData:{default:{}}},setup:function(t){var e=t,a=f().proxy,r=o("safeScan"),i=o([{title:"安全扫描",type:"safeScan",component:E,compData:e.compData},{title:"违规词检测",type:"wordDetection",component:function(){return s((function(){return n.import("./WordDetection-legacy.js?v=1714377894636")}),void 0,n.meta.url)},compData:e.compData},{title:"动态查杀",type:"dynamicKilling",component:function(){return s((function(){return n.import("./DynamicKilling-legacy.js?v=1714377894636")}),void 0,n.meta.url)},compData:e.compData}]);return u((function(){i.value.splice(1,2)})),{__sfc:!0,vm:a,props:e,tabActive:r,tabConfig:i}}}),(function(){var t=this._self._c,e=this._self._setupProxy;return t("div",[t(r,{ref:"addDeploy",attrs:{type:"navtwo",config:e.tabConfig},model:{value:e.tabActive,callback:function(t){e.tabActive=t},expression:"tabActive"}})],1)}),[],!1,null,"7549eaf4",null,null).exports)}}}))}();
