import{l as e,n as a,q as t}from"./main.js?v=1714377894636";import{_ as s}from"./date-picker.js?v=1714377894636";import{_ as o}from"./preload-helper.js?v=1714377894636";import{e as l,b as r,h as i,j as p}from"./vue-lib.js?v=1714377894636";import{g as u,af as m,ag as c,ah as d}from"./site.store.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./check.js?v=1714377894636";const n=a(l({__name:"EndDateSetting",props:{compData:{default:()=>{}}},setup(a,{expose:t}){const s=a,{refs:{phpModulesTableParams:l,modulesTableParams:n},getPhpModulesList:f,getModulesList:v}=u(),{proxy:D}=p(),_=r(s.compData.rowData.edate||""),h=r(!1),j={disabledDate:e=>e.getTime()<Date.now()-864e5},b=async a=>{if(!_.value&&!h.value)return D.$message.error("请选择到期时间");try{if(s.compData.isMult){let a=[],t=[];s.compData.rowData.forEach((e=>{a.push(e.id)}));const l=await m({edate:h.value?"0000-00-00":_.value,sites_id:a});Object.keys(l.error).forEach((e=>{t.push({name:e,status:!1})})),await l.success.forEach((e=>{t.push({name:e,status:!0})})),e({title:"批量设置结果",area:42,component:()=>o((()=>import("./index63.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url),compData:{resultData:t,resultTitle:"设置结果"}}),f(),D.$root.close()}else{let e,a=D.$load("正在设置到期时间，请稍后...");if(s.compData.siteType){const e=await c({sites_id:s.compData.rowData.id,edate:h.value?"0000-00-00":_.value});e.data.status?(D.$message.request(e),n.value.list.forEach((e=>{e.id===s.compData.rowData.id&&(e.edate=h.value?"0000-00-00":_.value)}))):D.$message.error(e.data.msg)}else e=await d({id:s.compData.rowData.id,edate:h.value?"0000-00-00":_.value}),D.$message.request(e),e.status&&l.value.list.forEach((e=>{e.id===s.compData.rowData.id&&(e.edate=h.value?"0000-00-00":_.value)}));a.close(),D.$root.close()}}catch(t){}finally{h.value=!1}};return t({onConfirm:b}),i((()=>{"0000-00-00"===s.compData.rowData.edate&&(_.value="")})),{__sfc:!0,props:s,phpModulesTableParams:l,modulesTableParams:n,getPhpModulesList:f,getModulesList:v,vm:D,dateValue:_,isPermanent:h,pickerOptions:j,setPermanent:()=>{h.value=!0,_.value="",b()},onConfirm:b}}}),(function(){var e=this,a=e._self._c,o=e._self._setupProxy;return a("div",{staticClass:"p-20x flex items-center"},[e._v(" 到期时间："),a(s,{attrs:{"value-format":"yyyy-MM-dd","picker-options":o.pickerOptions,type:"date",placeholder:"选择日期"},model:{value:o.dateValue,callback:function(e){o.dateValue=e},expression:"dateValue"}}),a(t,{staticClass:"!ml-4x",attrs:{type:"default"},on:{click:o.setPermanent}},[e._v(" 设为永久 ")])],1)}),[],!1,null,"e05a6225",null,null).exports;export{n as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index63.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./vue-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./element-lib.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
