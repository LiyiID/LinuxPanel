import{_ as s}from"./index51.js?v=1714377894636";import{_ as t}from"./index77.js?v=1714377894636";import{_ as a}from"./preload-helper.js?v=1714377894636";import{e,b as r,v as c,c as o,h as i,j as n}from"./vue-lib.js?v=1714377894636";import{aL as l,f as p,aY as m,Q as u,c9 as _,n as d,_ as g,q as f,a as v,g as w}from"./main.js?v=1714377894636";import{getFirewallStore as y}from"./firewall.store.js?v=1714377894636";import{F as P}from"./element-lib.js?v=1714377894636";import"./index42.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./check.js?v=1714377894636";const h=d(e({__name:"SafeDetect",setup(s){const{refs:{progressType:t,loading:a}}=y(),e=r({}),n=c({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],website_permissions:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{system_account:!1,sshd_service:!1,file_mode:!1,software:!1,website_permissions:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}});let d=null;const g=()=>{d=u({route:"/ws_project",onMessage:h})},f=o((()=>n.scanStatus&&!n.isEnd?"正在扫描":e.value.status?"上次检测时间 "+("刚刚"===l(e.value.msg.time)?"一分钟内":l(e.value.msg.time)):"当前未进行安全检测")),v=r(""),w=r(""),P=o((()=>n.scanStatus&&!n.isEnd?"正在扫描-".concat(v.value):n.isEnd?"检测时间："+p(n.time/1e3,"yyyy-MM-dd"):e.value.status?"若长时间未检测，服务器可能存在安全风险，建议立即检测":"当前安全风险未知，请立即检测")),h=(s,t)=>{if(t.data){const s=JSON.parse(t.data.replace(/'/g,'"'));s.hasOwnProperty("callback")?(null==d||d.close(),n.scanStatus=!1,n.isEnd=!0,n.time=(new Date).getTime()):(v.value=s.name,w.value=s.topic,n.progress=parseInt(s.progress),n.progressConfig[s.topic].push(s),n.statusTotal[s.topic]=b(n.progressConfig[s.topic]),n.allArr.push(s),3===s.status?n.error++:2===s.status&&n.warn++,1!==s.status&&(n.progressColor="#fc6d26"))}},b=s=>{const t={};return s.forEach((s=>{t[s.status]?t[s.status]++:t[s.status]=1})),t},C=()=>{n.scanStatus=!1,n.isEnd=!1,n.error=0,n.warn=0,n.time=0,n.progress=0,n.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],website_permissions:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},n.statusTotal={},n.allArr=[],n.result={},n.progressStatus={},n.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,website_permissions:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},S=async()=>{try{a.value=!0;const s=await _();e.value=s,a.value=!1}catch(s){}};return i((()=>{a.value=!1,S()})),{__sfc:!0,progressType:t,loading:a,statusType:[{color:"#888",text:"未安装"},{color:"#666",text:"良好"},{color:"#e6a23c",text:"警告"},{color:"red",text:"危险"}],scanDetect:e,scanParam:n,format:s=>s+" 分",useSocket:d,createWebSocket:g,progressTitle:f,checkName:v,checkTopic:w,progressSubTitle:P,onWSReceive:h,getArrNum:b,titleClick:s=>{n.active[s]=!n.active[s]},scanDetectEvent:()=>{if(n.scanStatus&&!n.isEnd||n.isEnd,n.scanStatus&&!n.isEnd)return null==d||d.close(),void C();n.isEnd&&C(),n.scanStatus=!0,g(),null==d||d.send({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""})},resetData:C,getSafeCountEvent:S,onlineServiceDialog:m}}}),(function(){var s,t,a=this,e=a._self._c,r=a._self._setupProxy;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],attrs:{id:"safeDetectList"}},[e("div",{staticClass:"progress-header"},[e("div",{staticClass:"progress-header-cot"},[e("div",{class:"progresscirclebar "+(r.scanDetect.status?"security ":"")+"text-["+(100===(null==(s=r.scanDetect.msg)?void 0:s.security_count)?" #20a53a ":" #fc6d26 ")+"]"},[r.scanDetect.status?[r.scanParam.scanStatus&&!r.scanParam.isEnd?e("div",{staticClass:"relative"},[e(P,{staticClass:"animate-spin",attrs:{type:"circle",percentage:70,"show-text":!1,"stroke-width":4,"define-back-color":"#fff",color:r.scanParam.warn||r.scanParam.error?"#fc6d26":"#20a53a",width:100}}),e("div",{staticClass:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},[e(g,{staticClass:"w-[full] px-4x",attrs:{src:"/firewall/icon-safe-detect".concat(r.scanParam.warn||r.scanParam.error?"-org":"",".svg")}}),e("span",{staticClass:"text-[1.2rem] font-bold py-4x"},[a._v("安全检测")])],1)],1):e(P,{attrs:{type:"circle",percentage:null==(t=r.scanDetect.msg)?void 0:t.security_count,format:r.format,color:r.scanParam.warn||r.scanParam.error?"#fc6d26":"#20a53a",width:100}})]:e(g,{staticClass:"w-[10rem]",attrs:{src:"/firewall/icon-safe-detect.svg"}})],2)]),e("div",{staticClass:"progress-header-cot"},[e("div",{staticClass:"scanning-progress-title"},[r.scanParam.isEnd?[a._v(" 检测已完成 "),r.scanParam.error>0||r.scanParam.warn>0?[a._v(" ，一共发现 "),r.scanParam.warn>0?[e("span",{staticClass:"color-org"},[a._v(a._s(r.scanParam.warn))]),a._v(" 项风险项 ")]:a._e(),r.scanParam.error>0?[a._v(" （包含 "),e("span",{staticClass:"color-red"},[a._v(a._s(r.scanParam.error))]),a._v(" 项危险项，请立即处理） ")]:a._e()]:a._e()]:[a._v(" "+a._s(r.progressTitle)+" ")]],2),r.scanParam.scanStatus?e(P,{attrs:{percentage:r.scanParam.progress,color:r.scanParam.warn||r.scanParam.error?"#fc6d26":"#20a53a","stroke-width":10}}):a._e(),e("div",{staticClass:"scanning-progress-cont"},[a._v(a._s(r.progressSubTitle))])],1),e("div",{staticClass:"progress-header-cot"},[e(f,{attrs:{type:r.scanParam.scanStatus&&!r.scanParam.isEnd?"warning":"primary",plain:!(!r.scanParam.scanStatus||r.scanParam.isEnd)},on:{click:r.scanDetectEvent}},[a._v(a._s(r.scanParam.scanStatus&&!r.scanParam.isEnd?"取消扫描":r.scanParam.isEnd?"重新检测":"立即检测"))]),r.scanParam.isEnd?e(f,{attrs:{type:"default"},on:{click:r.onlineServiceDialog}},[a._v("立即修复")]):a._e(),e(v,{staticClass:"absolute -bottom-[2.5rem] right-[1.4rem]",attrs:{href:"https://www.bt.cn/bbs/thread-126643-1-1.html"}},[a._v("需求反馈>>")])],1)]),e("div",{staticClass:"progress-cont-list"},a._l(r.progressType,(function(s,t){return e("div",{key:t,staticClass:"progress_item",class:t+"_item "+(r.scanParam.active[t]?"active":"")},[e("div",{staticClass:"progress_item_header",on:{click:function(s){return r.titleClick(t)}}},[e("div",{staticClass:"progress_type"},[e(g,{staticClass:"title-icon",attrs:{src:"/firewall/icon-"+t+".svg"}}),e("span",[a._v(a._s(s))])],1),e("div",{staticClass:"progress_status"},[r.scanParam.statusTotal[t]?[r.scanParam.statusTotal[t][3]||r.scanParam.statusTotal[t][2]?[r.scanParam.statusTotal[t][3]?e("span",{staticClass:"text-danger"},[a._v("发现"+a._s(r.scanParam.statusTotal[t][3])+"项危险")]):a._e(),r.scanParam.statusTotal[t][2]?e("span",{staticClass:"text-warning"},[a._v(a._s((r.scanParam.statusTotal[t][3]?"":"发现")+r.scanParam.statusTotal[t][2])+"项警告")]):a._e()]:r.scanParam.scanStatus&&r.checkTopic==t?e("span",[a._v("正在扫描...")]):e("span",{staticClass:"text-[#666]"},[a._v("无风险项")])]:[r.scanParam.scanStatus&&!r.scanParam.statusTotal[t]?e("span",[a._v("等待扫描")]):a._e()]],2),e("div",{staticClass:"progress_fold"},[e(g,{attrs:{src:"/firewall/arrow-down.svg"}})],1)]),e("div",{staticClass:"progress_item_body"},[r.scanParam.progressConfig[t]&&r.scanParam.progressConfig[t].length?a._l(r.scanParam.progressConfig[t],(function(s,t){return e("div",{key:t,staticClass:"progress_item_info",class:s.info?"active":""},[e("div",{staticClass:"info_cont"},[e("div",[a._v(a._s(s.name.replace("分析网站","")))]),e("div",{class:"text-["+r.statusType[s.status<0?0:s.status].color+"]"},[a._v(" "+a._s(r.statusType[s.status<0?0:s.status].text)+" ")])]),e("div",{staticClass:"info_cont_desc"},[a._v(a._s(s.info||""))])])})):a._e()],2)])})),0)])}),[],!1,null,"c8458926",null,null).exports;const b=d(e({__name:"index",setup(s){const{refs:{authType:t}}=w(),{refs:{safeDetectActive:e}}=y(),{proxy:o}=n(),l=r([{title:"安全检测",type:"safeDetect",component:h},{title:"木马查杀",type:"spywareDetection",component:()=>a((()=>import("./SpywareDetection.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]),import.meta.url)},{title:"漏洞扫描",type:"vulnerabilityScanning",component:()=>a((()=>import("./VulnerabilityScanning.js?v=1714377894636")),__vite__mapDeps([29,4,5,2,3,6,7,8,9,10,30,31,32,21,26,33,24]),import.meta.url)},{title:"文件完整性检测",type:"fileIntegrityDetection",component:()=>a((()=>import("./FileIntegrityDetection.js?v=1714377894636")),__vite__mapDeps([34,35,3,10,2,9,4,5,6,7,8,1,36,13,14,19,20,21,22,25,16,17,18,26,24,27]),import.meta.url)}]),p=c({title:"安全检测-功能介绍",ps:"扫描服务器系统目录下的风险漏洞，开启主动防御后，能多查杀目录中的文件进行动态保护，自动进行木马查杀并隔离。",source:101,desc:["实时检测木马","安全扫描加固","漏洞扫描","完整性检测"],tabImgs:[{title:"动态查杀",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_1.png"},{title:"安全检测",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_2.png"},{title:"漏洞扫描",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_3.png"},{title:"文件完整性检测",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_4.png"}]});return i((()=>{})),{__sfc:!0,authType:t,safeDetectActive:e,vm:o,tabComponent:l,productData:p}}}),(function(){var a=this._self._c,e=this._self._setupProxy;return a("div",{staticClass:"flex flex-col"},["ltd"===e.authType?a(t,{attrs:{type:"navtwo",config:e.tabComponent},model:{value:e.safeDetectActive,callback:function(s){e.safeDetectActive=s},expression:"safeDetectActive"}}):a(s,{staticClass:"px-[20%] my-[8rem]",attrs:{data:e.productData}})],1)}),[],!1,null,null,null,null).exports;export{b as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./SpywareDetection.js?v=1714377894636","./index118.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index53.js?v=1714377894636","./element-lib.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index46.js?v=1714377894636","./element-lib.js?v=1714377894636","./index.vue_vue_type_style_index_0_lang.js?v=1714377894636","./index58.js?v=1714377894636","./element-lib.js?v=1714377894636","./index45.js?v=1714377894636","./index59.js?v=1714377894636","./firewall.store.js?v=1714377894636","./check.js?v=1714377894636","./firewall.table.js?v=1714377894636","./firewall.popup.js?v=1714377894636","./index38.js?v=1714377894636","./index61.js?v=1714377894636","./VulnerabilityScanning.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./site.store.js?v=1714377894636","./FileIntegrityDetection.js?v=1714377894636","./descriptions.js?v=1714377894636","./index52.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
