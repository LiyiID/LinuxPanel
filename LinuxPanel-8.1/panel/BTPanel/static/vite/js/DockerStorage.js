import{_ as e}from"./index52.js?v=1714377894636";import{_ as t}from"./index53.js?v=1714377894636";import{_ as a}from"./index39.js?v=1714377894636";import{_ as r}from"./index54.js?v=1714377894636";import{_ as s}from"./index58.js?v=1714377894636";import{_ as o}from"./index59.js?v=1714377894636";import{e as n,b as i,A as l,v as c,L as m,h as p,j as u,H as g}from"./vue-lib.js?v=1714377894636";import{g as d,P as h,n as f}from"./main.js?v=1714377894636";import{u as b}from"./docker.store.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{e as j}from"./docker.table.js?v=1714377894636";import{u as v,N as x}from"./docker.popup.js?v=1714377894636";import{m as y,n as D}from"./docker.api.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./check.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";const _=f(n({__name:"DockerStorage",setup(e){var t;const{proxy:a}=u(),r=i(),s=i(JSON.parse(null!=(t=localStorage.getItem("dockerStorageTableColumn"))?t:"[]")||[]),o=b(),{getSList:n}=o,{storageTableData:f}=l(o),{refs:{mainHeight:_}}=d(),C=c({selectList:[]}),k=i("");m("storageRowData",(()=>f.value.rowData)),m("selectList",(()=>C.selectList));const S=i([{label:"批量删除",value:"delete",event:()=>{}}]),T=i([{active:!0,content:a.$t("Docker.addSVolume"),event:()=>{v()}},{active:!1,content:a.$t("Docker.clearStor"),event:async()=>{await a.$confirm({type:"calc",title:"清理存储卷",icon:"warning",iconColor:"#E6A23C",width:"35rem",message:"您真的要清理所有未被容器使用的存储卷吗？（可能不会包含您自己创建的卷）"});const e=await y();e.status?(a.$message.success(e.msg),n()):a.$message.error(e.msg)}}]);let w=[],N=!1,L=0;const P=c({isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:"Name"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>g("span",{class:0!==w.length||N?w.includes(e.Name)?"text-primary":"text-danger":"text-warning"},(()=>{if(0!==w.length||N){let t=w.includes(e.Name)?"执行成功":"执行失败";return L++,t}return"等待执行"})())}}),$=async e=>{await a.$confirm({type:"calc",title:"删除存储卷【".concat(e.Name,"】"),width:"35rem",message:"您真的要删除存储卷【".concat(e.Name,"】吗？")});const t=await D({data:JSON.stringify({name:e.Name})});t.status?(n(),a.$message.success(t.msg)):a.$message.error(t.msg)},B=async({Name:e})=>{try{const{data:t}=await D({data:JSON.stringify({name:e})});return t.status?(w.push(e),t):Promise.reject(t)}catch(t){return Promise.reject(!1)}},E=j({deleteDataEvent:$});return p((async()=>{n(),E.value=h(s.value,E.value)})),{__sfc:!0,vm:a,Table:r,ftpTbaleColumnLocal:s,store:o,getSList:n,storageTableData:f,mainHeight:_,select:C,batchType:k,tableBatchData:S,tableBtnGroup:T,list:w,isComplete:N,index:L,batchConfig:P,batchEvent:(e,t,a)=>{if("delete"===e)return B(t)},handleBathComplete:e=>{N=!0,n()},changePageLimit:e=>{f.value.limit=e,f.value.p=1,n()},changePageSize:e=>{f.value.p=e,n()},deleteDataEvent:$,batchDeleteData:B,handleBatch:e=>{N=!1,w=[],L=0;let t=[];if("delete"===e)t=["删除","彻底失去访问和操作权限"];k.value=e,P.isRecurrence=!0,P.describe.th="存储卷",P.describe.title="批量".concat(t[0],"存储卷"),P.describe.message="批量".concat(t[0],"已选的存储卷，是否继续操作！")},handleSelectionChange:e=>{C.selectList=e},tableColumn:E,NPSDialog:x}}}),(function(){var n=this,i=n._self._c,l=n._self._setupProxy;return i("div",{staticClass:"relative"},[i(o,{scopedSlots:n._u([{key:"header-left",fn:function(){return[i("div",{staticClass:"flex items-center"},[i(s,{attrs:{group:l.tableBtnGroup}}),i("a",{staticClass:"cursor-pointer ml-[1rem] text-[#20a53a] hover:text-[#1d9534]",on:{click:function(e){return l.NPSDialog()}}},[n._v(" 需求反馈 ")])],1)]},proxy:!0},{key:"header-right",fn:function(){return[i(r,{attrs:{name:"dockerStorageTableColumn",column:l.tableColumn}})]},proxy:!0},{key:"content",fn:function(){return[i(a,{directives:[{name:"loading",rawName:"v-loading",value:l.storageTableData.loading,expression:"storageTableData.loading"}],key:"storageTable",ref:"Table",attrs:{column:l.tableColumn,"max-height":l.mainHeight-220,data:l.storageTableData.showList,description:"存储卷列表为空","element-loading-text":"正在加载存储卷列表，请稍后..."},on:{"selection-change":l.handleSelectionChange}})]},proxy:!0},{key:"footer-left",fn:function(){return[i(t,{attrs:{data:l.tableBatchData,config:l.batchConfig,"batch-fn":l.batchEvent},on:{"handle-batch":l.handleBatch,"handle-complete":l.handleBathComplete}})]},proxy:!0},{key:"footer-right",fn:function(){return[i(e,{attrs:{total:l.storageTableData.total,"current-page":l.storageTableData.p,"page-size":l.storageTableData.limit},on:{"update:currentPage":function(e){return n.$set(l.storageTableData,"p",e)},"update:current-page":function(e){return n.$set(l.storageTableData,"p",e)},"size-change":l.changePageLimit,"current-change":l.changePageSize}})]},proxy:!0},{key:"popup",fn:function(){},proxy:!0}])})],1)}),[],!1,null,"c4bb5a3d",null,null).exports;export{_ as default};
