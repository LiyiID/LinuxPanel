import{g as e,k as s,n as t,a}from"./main.js?v=1714377894636";import{_ as o}from"./index40.js?v=1714377894636";import{w as i,x as r,B as l}from"./element-lib.js?v=1714377894636";import{e as m,b as n,v as u,f as p,h as c,j as g}from"./vue-lib.js?v=1714377894636";import{g as f}from"./home.store.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./config.js?v=1714377894636";const h=t(m({__name:"HomeUpdateReminder",props:{compData:{default:()=>({})}},setup(t,{expose:a}){const o=t,{refs:{updatePush:i,modulePush:r}}=f(),{refs:{pushConfigInfo:l},getPushConfigInfo:m,getAlarmData:h}=e(),{proxy:v}=g(),d=n(o.compData.status),j=n(!1),_=u({switch:i.value,give:[""],option:{}}),w={give:[{required:!0,validator:(e,s,t)=>{0===_.give.length?t(new Error("请选择至少一种告警方式")):t()},trigger:["blur","change"]}]};p((()=>_.switch),(e=>{e||(i.value=e)}));const b=async()=>{j.value=!0,await m(),j.value=!1,_.give=r.value,_.option=l.value},C=()=>{try{v.$refs.pushMsg.validate((async e=>{if(e){if(!_.give.length)return v.$message.error("请选择告警方式");let e="";e=_.give.join(",");const t=await s({name:"site_push",id:"panel_update",data:JSON.stringify({status:_.switch,type:"panel_update",title:"面板更新提醒",module:e,interval:600})});t.status&&(r.value=_.give),v.$emit("close"),v.$message.request(t)}}))}catch(e){}},x=()=>{i.value=d.value};return c((async()=>{b()})),a({onCancel:x,onConfirm:C}),{__sfc:!0,updatePush:i,modulePush:r,pushConfigInfo:l,getPushConfigInfo:m,getAlarmData:h,vm:v,props:o,updatePushBack:d,checkedLoad:j,msgForm:_,rules:w,renderPushConfig:b,changePush:()=>{i.value=_.switch},onRefershData:async()=>{await b(),h(),v.$message.success("刷新成功")},onConfirm:C,onCancel:x}}}),(function(){var e=this,s=e._self._c,t=e._self._setupProxy;return s("div",{staticClass:"p-[2.4rem] give-dialog"},[s(i,{ref:"pushMsg",attrs:{model:t.msgForm,"label-width":"80px",rules:t.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[s(r,{attrs:{label:"更新提醒",prop:"switch"}},[s(l,{attrs:{name:"switch"},on:{change:t.changePush},model:{value:t.msgForm.switch,callback:function(s){e.$set(t.msgForm,"switch",s)},expression:"msgForm.switch"}})],1),s(r,{attrs:{label:"告警方式",prop:"give"}},[s(o,{model:{value:t.msgForm.give,callback:function(s){e.$set(t.msgForm,"give",s)},expression:"msgForm.give"}})],1)],1),s("div",{staticClass:"mt-1.6rem ml-2.4rem"},[s("ul",{staticClass:"list-disc"},[s("li",[e._v(" 点击安装后状态未更新，尝试点击【"),s(a,{on:{click:t.onRefershData}},[e._v("手动刷新")]),e._v("】 ")],1)])])],1)}),[],!1,null,"6d660f53",null,null).exports;export{h as default};
