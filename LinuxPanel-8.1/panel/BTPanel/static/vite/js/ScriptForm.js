import{_ as s}from"./index118.js?v=1714377894636";import{_ as t}from"./index85.js?v=1714377894636";import{w as r,x as a,q as e,s as i}from"./element-lib.js?v=1714377894636";import{n as o}from"./main.js?v=1714377894636";import{_ as l}from"./index120.js?v=1714377894636";import{e as p,b as m,v as c,w as n,j as _}from"./vue-lib.js?v=1714377894636";import{o as f}from"./confirm.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{F as d,G as u}from"./crontab.api.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./config.js?v=1714377894636";const g=o(p({__name:"ScriptForm",props:{compData:{default:{}}},setup(s,{expose:t}){const r=s,{proxy:a}=_(),e=m(!1),i=m(),o=c({args_title:"",args_ps:""}),l=c({name:"",return_type:"string",is_args:"0",ps:"",script:"",type_id:r.compData.type_id}),p=m([{text:"当前仅支持Python和Shell脚本"},{text:"请根据返回类型在脚本执行结束时输出符合预期的值"},{text:"如果选择需要脚本参数，试用当前脚本时需传递一个参数，在脚本中的第一个参数中接收"}]),g=m(),b=m({mode:"ace/mode/nginx",theme:"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!1,fontSize:"12px"}),x=async s=>{let t={...l};"1"==l.is_args&&(t={...l,...o}),f({$refs:i.value,loading:e,request:async()=>r.compData.rowData?(t.script_id=r.compData.rowData.script_id,await d({data:JSON.stringify(t)})):await u({data:JSON.stringify(t)}),async complete(){r.compData.refreshEvent()}})};return n((()=>{if(r.compData.rowData){const{name:s,return_type:t,is_args:a,ps:e,script:i,type_id:p,args_title:m,args_ps:c}=r.compData.rowData;Object.assign(l,{name:s,return_type:t,is_args:String(a),ps:e,script:i,type_id:p}),"1"==a&&Object.assign(o,{args_title:m,args_ps:c})}})),t({onConfirm:x}),{__sfc:!0,props:r,vm:a,formDisabled:e,scriptFormRef:i,args_form:o,scriptForm:l,helpList:p,scriptAceEditor:g,config:b,onConfirm:x}}}),(function(){var o=this,p=o._self._c,m=o._self._setupProxy;return p("div",{staticClass:"p-20x"},[p(r,{ref:"scriptFormRef",attrs:{disabled:m.formDisabled,model:m.scriptForm,"label-width":"80px"}},[p(a,{attrs:{label:"名称"}},[p(t,{attrs:{placeholder:"请输入脚本名称",width:"36rem"},model:{value:m.scriptForm.name,callback:function(s){o.$set(m.scriptForm,"name",s)},expression:"scriptForm.name"}})],1),p(a,{attrs:{label:"返回类型"}},[p(e,{model:{value:m.scriptForm.return_type,callback:function(s){o.$set(m.scriptForm,"return_type",s)},expression:"scriptForm.return_type"}},[p(i,{attrs:{label:"字符串",value:"string"}}),p(i,{attrs:{label:"整数",value:"int"}}),p(i,{attrs:{label:"浮点数",value:"float"}})],1)],1),p(a,{attrs:{label:"脚本参数"}},[p("div",{staticClass:"flex items-center"},[p(e,{staticClass:"w-[8.2rem]",model:{value:m.scriptForm.is_args,callback:function(s){o.$set(m.scriptForm,"is_args",s)},expression:"scriptForm.is_args"}},[p(i,{attrs:{label:"需要",value:"1"}}),p(i,{attrs:{label:"不需要",value:"0"}})],1),"1"==m.scriptForm.is_args?p("div",{staticClass:"flex items-center"},[p(t,{staticClass:"mx-8x",attrs:{width:"10rem",placeholder:"参数标题"},model:{value:m.args_form.args_title,callback:function(s){o.$set(m.args_form,"args_title",s)},expression:"args_form.args_title"}}),p(t,{attrs:{width:"16rem",placeholder:"参数说明"},model:{value:m.args_form.args_ps,callback:function(s){o.$set(m.args_form,"args_ps",s)},expression:"args_form.args_ps"}})],1):o._e()],1)]),p(a,{attrs:{label:"内容"}},[p("div",{staticClass:"h-[16rem]"},[p(l,{ref:"scriptAceEditor",staticClass:"!h-[16rem] !w-[36rem]",attrs:{id:"scriptEditor","is-zoom":!0,config:m.config},model:{value:m.scriptForm.script,callback:function(s){o.$set(m.scriptForm,"script",s)},expression:"scriptForm.script"}})],1)]),p(a,{attrs:{label:"备注"}},[p(t,{attrs:{placeholder:"备注",width:"36rem"},model:{value:m.scriptForm.ps,callback:function(s){o.$set(m.scriptForm,"ps",s)},expression:"scriptForm.ps"}})],1)],1),p(s,{staticClass:"ml-24x mt-20x",attrs:{list:m.helpList,"list-style":"disc"}})],1)}),[],!1,null,null,null,null).exports;export{g as default};
