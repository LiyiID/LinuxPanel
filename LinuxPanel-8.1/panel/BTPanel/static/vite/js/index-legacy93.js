!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return a};var r,a={},n=Object.prototype,s=n.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(r){f=function(t,e,r){return t[e]=r}}function p(t,e,r,a){var n=e&&e.prototype instanceof _?e:_,s=Object.create(n.prototype),i=new O(a||[]);return o(s,"_invoke",{value:j(t,r,i)}),s}function v(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}a.wrap=p;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",y={};function _(){}function w(){}function b(){}var x={};f(x,c,(function(){return this}));var P=Object.getPrototypeOf,S=P&&P(P(N([])));S&&S!==n&&s.call(S,c)&&(x=S);var C=b.prototype=_.prototype=Object.create(x);function E(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(e,r){function a(n,o,i,c){var l=v(e[n],e,o);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==t(f)&&s.call(f,"__await")?r.resolve(f.__await).then((function(t){a("next",t,i,c)}),(function(t){a("throw",t,i,c)})):r.resolve(f).then((function(t){u.value=t,i(u)}),(function(t){return a("throw",t,i,c)}))}c(l.arg)}var n;o(this,"_invoke",{value:function(t,e){function s(){return new r((function(r,n){a(t,e,r,n)}))}return n=n?n.then(s,s):s()}})}function j(t,e,a){var n=d;return function(s,o){if(n===g)throw new Error("Generator is already running");if(n===m){if("throw"===s)throw o;return{value:r,done:!0}}for(a.method=s,a.arg=o;;){var i=a.delegate;if(i){var c=T(i,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===d)throw n=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=g;var l=v(t,e,a);if("normal"===l.type){if(n=a.done?m:h,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=m,a.method="throw",a.arg=l.arg)}}}function T(t,e){var a=e.method,n=t.iterator[a];if(n===r)return e.delegate=null,"throw"===a&&t.iterator.return&&(e.method="return",e.arg=r,T(t,e),"throw"===e.method)||"return"!==a&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var s=v(n,t.iterator,e.arg);if("throw"===s.type)return e.method="throw",e.arg=s.arg,e.delegate=null,y;var o=s.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function N(e){if(e||""===e){var a=e[c];if(a)return a.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(s.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=b,o(C,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:w,configurable:!0}),w.displayName=f(b,u,"GeneratorFunction"),a.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,f(t,u,"GeneratorFunction")),t.prototype=Object.create(C),t},a.awrap=function(t){return{__await:t}},E(k.prototype),f(k.prototype,l,(function(){return this})),a.AsyncIterator=k,a.async=function(t,e,r,n,s){void 0===s&&(s=Promise);var o=new k(p(t,e,r,n),s);return a.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},E(C),f(C,u,"Generator"),f(C,c,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),a.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},a.values=N,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(D),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function a(a,n){return i.type="throw",i.arg=t,e.next=a,n&&(e.method="next",e.arg=r),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),l=s.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&s.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var n=a;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=t,o.arg=e,n?(this.method="next",this.next=n.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;D(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,a){return this.delegate={iterator:N(t),resultName:e,nextLoc:a},"next"===this.method&&(this.arg=r),y}},a}function r(t,e,r,a,n,s,o){try{var i=t[s](o),c=i.value}catch(l){return void r(l)}i.done?e(c):Promise.resolve(c).then(a,n)}System.register(["./index-legacy51.js?v=1714377894636","./index-legacy77.js?v=1714377894636","./preload-helper-legacy.js?v=1714377894636","./vue-lib-legacy.js?v=1714377894636","./main-legacy.js?v=1714377894636","./firewall.store-legacy.js?v=1714377894636","./element-lib-legacy.js?v=1714377894636","./progress-legacy.js?v=1714377894636","./tabs-legacy.js?v=1714377894636","./index-legacy42.js?v=1714377894636","./request-lib-legacy.js?v=1714377894636","./__commonjsHelpers__-legacy.js?v=1714377894636","./modulepreload-polyfill-legacy.js?v=1714377894636","./locales-lib-legacy.js?v=1714377894636","./public-lib-legacy.js?v=1714377894636","./check-legacy.js?v=1714377894636"],(function(t,a){"use strict";var n,s,o,i,c,l,u,f,p,v,d,h,g,m,y,_,w,b,x,P,S;return{setters:[function(t){n=t._},function(t){s=t._},function(t){o=t._},function(t){i=t.e,c=t.b,l=t.v,u=t.c,f=t.h,p=t.j},function(t){v=t.aL,d=t.f,h=t.aY,g=t.Q,m=t.c9,y=t.n,_=t._,w=t.q,b=t.a,x=t.g},function(t){P=t.getFirewallStore},function(t){S=t.F},null,null,null,null,null,null,null,null,null],execute:function(){var C=i({__name:"SafeDetect",setup:function(t){var a=P().refs,n=a.progressType,s=a.loading,o=c({}),i=l({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],website_permissions:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{system_account:!1,sshd_service:!1,file_mode:!1,software:!1,website_permissions:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}}),p=null,y=function(){p=g({route:"/ws_project",onMessage:S})},_=u((function(){return i.scanStatus&&!i.isEnd?"正在扫描":o.value.status?"上次检测时间 "+("刚刚"===v(o.value.msg.time)?"一分钟内":v(o.value.msg.time)):"当前未进行安全检测"})),w=c(""),b=c(""),x=u((function(){return i.scanStatus&&!i.isEnd?"正在扫描-".concat(w.value):i.isEnd?"检测时间："+d(i.time/1e3,"yyyy-MM-dd"):o.value.status?"若长时间未检测，服务器可能存在安全风险，建议立即检测":"当前安全风险未知，请立即检测"})),S=function(t,e){if(e.data){var r,a=JSON.parse(e.data.replace(/'/g,'"'));if(a.hasOwnProperty("callback"))null===(r=p)||void 0===r||r.close(),i.scanStatus=!1,i.isEnd=!0,i.time=(new Date).getTime();else w.value=a.name,b.value=a.topic,i.progress=parseInt(a.progress),i.progressConfig[a.topic].push(a),i.statusTotal[a.topic]=C(i.progressConfig[a.topic]),i.allArr.push(a),3===a.status?i.error++:2===a.status&&i.warn++,1!==a.status&&(i.progressColor="#fc6d26")}},C=function(t){var e={};return t.forEach((function(t){e[t.status]?e[t.status]++:e[t.status]=1})),e},E=function(){i.scanStatus=!1,i.isEnd=!1,i.error=0,i.warn=0,i.time=0,i.progress=0,i.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],website_permissions:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},i.statusTotal={},i.allArr=[],i.result={},i.progressStatus={},i.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,website_permissions:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},k=function(){var t,a=(t=e().mark((function t(){var r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s.value=!0,t.next=4,m();case 4:r=t.sent,o.value=r,s.value=!1,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})),function(){var e=this,a=arguments;return new Promise((function(n,s){var o=t.apply(e,a);function i(t){r(o,n,s,i,c,"next",t)}function c(t){r(o,n,s,i,c,"throw",t)}i(void 0)}))});return function(){return a.apply(this,arguments)}}();return f((function(){s.value=!1,k()})),{__sfc:!0,progressType:n,loading:s,statusType:[{color:"#888",text:"未安装"},{color:"#666",text:"良好"},{color:"#e6a23c",text:"警告"},{color:"red",text:"危险"}],scanDetect:o,scanParam:i,format:function(t){return t+" 分"},useSocket:p,createWebSocket:y,progressTitle:_,checkName:w,checkTopic:b,progressSubTitle:x,onWSReceive:S,getArrNum:C,titleClick:function(t){i.active[t]=!i.active[t]},scanDetectEvent:function(){var t,e;if(i.scanStatus&&!i.isEnd||i.isEnd,i.scanStatus&&!i.isEnd)return null===(e=p)||void 0===e||e.close(),void E();i.isEnd&&E(),i.scanStatus=!0,y(),null===(t=p)||void 0===t||t.send({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""})},resetData:E,getSafeCountEvent:k,onlineServiceDialog:h}}}),E=function(){var t,e,r=this,a=r._self._c,n=r._self._setupProxy;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],attrs:{id:"safeDetectList"}},[a("div",{staticClass:"progress-header"},[a("div",{staticClass:"progress-header-cot"},[a("div",{class:"progresscirclebar "+(n.scanDetect.status?"security ":"")+"text-["+(100===(null===(t=n.scanDetect.msg)||void 0===t?void 0:t.security_count)?" #20a53a ":" #fc6d26 ")+"]"},[n.scanDetect.status?[n.scanParam.scanStatus&&!n.scanParam.isEnd?a("div",{staticClass:"relative"},[a(S,{staticClass:"animate-spin",attrs:{type:"circle",percentage:70,"show-text":!1,"stroke-width":4,"define-back-color":"#fff",color:n.scanParam.warn||n.scanParam.error?"#fc6d26":"#20a53a",width:100}}),a("div",{staticClass:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},[a(_,{staticClass:"w-[full] px-4x",attrs:{src:"/firewall/icon-safe-detect".concat(n.scanParam.warn||n.scanParam.error?"-org":"",".svg")}}),a("span",{staticClass:"text-[1.2rem] font-bold py-4x"},[r._v("安全检测")])],1)],1):a(S,{attrs:{type:"circle",percentage:null===(e=n.scanDetect.msg)||void 0===e?void 0:e.security_count,format:n.format,color:n.scanParam.warn||n.scanParam.error?"#fc6d26":"#20a53a",width:100}})]:a(_,{staticClass:"w-[10rem]",attrs:{src:"/firewall/icon-safe-detect.svg"}})],2)]),a("div",{staticClass:"progress-header-cot"},[a("div",{staticClass:"scanning-progress-title"},[n.scanParam.isEnd?[r._v(" 检测已完成 "),n.scanParam.error>0||n.scanParam.warn>0?[r._v(" ，一共发现 "),n.scanParam.warn>0?[a("span",{staticClass:"color-org"},[r._v(r._s(n.scanParam.warn))]),r._v(" 项风险项 ")]:r._e(),n.scanParam.error>0?[r._v(" （包含 "),a("span",{staticClass:"color-red"},[r._v(r._s(n.scanParam.error))]),r._v(" 项危险项，请立即处理） ")]:r._e()]:r._e()]:[r._v(" "+r._s(n.progressTitle)+" ")]],2),n.scanParam.scanStatus?a(S,{attrs:{percentage:n.scanParam.progress,color:n.scanParam.warn||n.scanParam.error?"#fc6d26":"#20a53a","stroke-width":10}}):r._e(),a("div",{staticClass:"scanning-progress-cont"},[r._v(r._s(n.progressSubTitle))])],1),a("div",{staticClass:"progress-header-cot"},[a(w,{attrs:{type:n.scanParam.scanStatus&&!n.scanParam.isEnd?"warning":"primary",plain:!(!n.scanParam.scanStatus||n.scanParam.isEnd)},on:{click:n.scanDetectEvent}},[r._v(r._s(n.scanParam.scanStatus&&!n.scanParam.isEnd?"取消扫描":n.scanParam.isEnd?"重新检测":"立即检测"))]),n.scanParam.isEnd?a(w,{attrs:{type:"default"},on:{click:n.onlineServiceDialog}},[r._v("立即修复")]):r._e(),a(b,{staticClass:"absolute -bottom-[2.5rem] right-[1.4rem]",attrs:{href:"https://www.bt.cn/bbs/thread-126643-1-1.html"}},[r._v("需求反馈>>")])],1)]),a("div",{staticClass:"progress-cont-list"},r._l(n.progressType,(function(t,e){return a("div",{key:e,staticClass:"progress_item",class:e+"_item "+(n.scanParam.active[e]?"active":"")},[a("div",{staticClass:"progress_item_header",on:{click:function(t){return n.titleClick(e)}}},[a("div",{staticClass:"progress_type"},[a(_,{staticClass:"title-icon",attrs:{src:"/firewall/icon-"+e+".svg"}}),a("span",[r._v(r._s(t))])],1),a("div",{staticClass:"progress_status"},[n.scanParam.statusTotal[e]?[n.scanParam.statusTotal[e][3]||n.scanParam.statusTotal[e][2]?[n.scanParam.statusTotal[e][3]?a("span",{staticClass:"text-danger"},[r._v("发现"+r._s(n.scanParam.statusTotal[e][3])+"项危险")]):r._e(),n.scanParam.statusTotal[e][2]?a("span",{staticClass:"text-warning"},[r._v(r._s((n.scanParam.statusTotal[e][3]?"":"发现")+n.scanParam.statusTotal[e][2])+"项警告")]):r._e()]:n.scanParam.scanStatus&&n.checkTopic==e?a("span",[r._v("正在扫描...")]):a("span",{staticClass:"text-[#666]"},[r._v("无风险项")])]:[n.scanParam.scanStatus&&!n.scanParam.statusTotal[e]?a("span",[r._v("等待扫描")]):r._e()]],2),a("div",{staticClass:"progress_fold"},[a(_,{attrs:{src:"/firewall/arrow-down.svg"}})],1)]),a("div",{staticClass:"progress_item_body"},[n.scanParam.progressConfig[e]&&n.scanParam.progressConfig[e].length?r._l(n.scanParam.progressConfig[e],(function(t,e){return a("div",{key:e,staticClass:"progress_item_info",class:t.info?"active":""},[a("div",{staticClass:"info_cont"},[a("div",[r._v(r._s(t.name.replace("分析网站","")))]),a("div",{class:"text-["+n.statusType[t.status<0?0:t.status].color+"]"},[r._v(" "+r._s(n.statusType[t.status<0?0:t.status].text)+" ")])]),a("div",{staticClass:"info_cont_desc"},[r._v(r._s(t.info||""))])])})):r._e()],2)])})),0)])},k=y(C,E,[],!1,null,"c8458926",null,null).exports;t("default",y(i({__name:"index",setup:function(t){var e=x().refs.authType,r=P().refs.safeDetectActive,n=p().proxy,s=c([{title:"安全检测",type:"safeDetect",component:k},{title:"木马查杀",type:"spywareDetection",component:function(){return o((function(){return a.import("./SpywareDetection-legacy.js?v=1714377894636")}),void 0,a.meta.url)}},{title:"漏洞扫描",type:"vulnerabilityScanning",component:function(){return o((function(){return a.import("./VulnerabilityScanning-legacy.js?v=1714377894636")}),void 0,a.meta.url)}},{title:"文件完整性检测",type:"fileIntegrityDetection",component:function(){return o((function(){return a.import("./FileIntegrityDetection-legacy.js?v=1714377894636")}),void 0,a.meta.url)}}]),i=l({title:"安全检测-功能介绍",ps:"扫描服务器系统目录下的风险漏洞，开启主动防御后，能多查杀目录中的文件进行动态保护，自动进行木马查杀并隔离。",source:101,desc:["实时检测木马","安全扫描加固","漏洞扫描","完整性检测"],tabImgs:[{title:"动态查杀",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_1.png"},{title:"安全检测",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_2.png"},{title:"漏洞扫描",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_3.png"},{title:"文件完整性检测",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/safe_detect_4.png"}]});return f((function(){})),{__sfc:!0,authType:e,safeDetectActive:r,vm:n,tabComponent:s,productData:i}}}),(function(){var t=this._self._c,e=this._self._setupProxy;return t("div",{staticClass:"flex flex-col"},["ltd"===e.authType?t(s,{attrs:{type:"navtwo",config:e.tabComponent},model:{value:e.safeDetectActive,callback:function(t){e.safeDetectActive=t},expression:"safeDetectActive"}}):t(n,{staticClass:"px-[20%] my-[8rem]",attrs:{data:e.productData}})],1)}),[],!1,null,null,null,null).exports)}}}))}();
