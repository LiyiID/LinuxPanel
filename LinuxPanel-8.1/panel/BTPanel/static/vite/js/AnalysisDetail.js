import{_ as a}from"./index39.js?v=1714377894636";import{n as e,a as t}from"./main.js?v=1714377894636";import{a9 as l}from"./element-lib.js?v=1714377894636";import{e as s,b as o,H as p,h as r,j as i}from"./vue-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{o as n}from"./software2.js?v=1714377894636";import{g as m,O as u}from"./logs.table.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";const c=e(s({__name:"AnalysisDetail",props:{compData:{default:{}}},setup(a){const e=a,{proxy:t}=i(),{refs:{webSiteName:l}}=m(),s=o(!1),c=o(),b=o([{label:"攻击ip",prop:"ip"},{label:"攻击时间",prop:"time"},{label:"user-agent",prop:"ua"},{label:"请求URL",prop:"url",width:210,render:a=>"san"===e.compData.type?p("span",[a.url]):p("span",{class:"bg-[#f9f2f4] text-[#c7254e]"},a.url)}]),f=o([{label:"访问次数",prop:"num"},{label:"url"===e.compData.type?"访问URL":"访问ip",prop:"path"}]),d=o([]),v=async()=>{try{s.value=!0;const a=await u({path:"/www/wwwlogs/"+l.value+".log",type:e.compData.type,time:e.compData.row.start_time});d.value=a.data.value;const t=["sql","san","xss","php"];c.value=t.includes(e.compData.type)?b.value:f.value}catch(a){}finally{s.value=!1}};return r((async()=>{await v()})),{__sfc:!0,props:e,vm:t,webSiteName:l,loading:s,column:c,sqlCol:b,ipCol:f,tableData:d,getLos:v,openPluginView:()=>{n({name:"btwaf"})}}}}),(function(){var e=this,s=e._self._c,o=e._self._setupProxy;return s("div",{staticClass:"p-20x"},[s(l,{staticClass:"!mb-20x",attrs:{closable:!1,type:"info","show-icon":""},scopedSlots:e._u([{key:"title",fn:function(){return[s("span",[e._v("为了保护您的网站安全，建议使用【"),s(t,{on:{click:o.openPluginView}},[e._v("Nginx防火墙")]),e._v("】以有效防御当前站点的sql攻击")],1)]},proxy:!0}])}),s(a,{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],attrs:{"element-loading-text":"正在加载数据中....",column:o.column,data:o.tableData,border:"","max-height":"360"}})],1)}),[],!1,null,"4a4e0b0d",null,null).exports;export{c as default};
