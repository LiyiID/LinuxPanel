import{_ as a}from"./index77.js?v=1714377894636";import{_ as s}from"./preload-helper.js?v=1714377894636";import{e,b as t,v as n,c as i,h as r,j as c}from"./vue-lib.js?v=1714377894636";import{g as l,aY as o,Q as m,f as p,n as d,F as u,q as v,_}from"./main.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{_ as g}from"./index51.js?v=1714377894636";import{L as f}from"./element-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import{d7 as b}from"./site.store.js?v=1714377894636";import"./index42.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./check.js?v=1714377894636";const w=d(e({__name:"SiteScan",props:{compData:{default:{}}},setup(a,{expose:s}){const e=a,{proxy:d}=c(),{refs:{authType:u}}=l(),v=t(!1),_=t([{name:"vulscan",title:"漏洞扫描"},{name:"webscan",title:"网站配置安全性"},{name:"filescan",title:"文件泄露"},{name:"backup",title:"备份文件"},{name:"webshell",title:"木马程序"},{name:"index",title:"首页内容风险"},{name:"webhorse",title:"挂马排查"},{name:"deadchain",title:"坏链检测"},{name:"database",title:"数据库安全"},{name:"ftps",title:"网站FTP风险"},{name:"backend",title:"网站后台安全"}]),g=t(0),f=t(""),w=t(""),x=n({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{},statusTotal:{},result:{},progressStatus:{},active:{}});let y=null;const h=n({title:"安全扫描-功能介绍",height:36,ps:"扫描服务器系统的漏洞，异常用户，已安装软件的安全问题并提供修复方案.",source:66,desc:["漏洞扫描","网站配置安全性","文件泄露","备份文件","木马程序"],tabImgs:["https://www.bt.cn/Public/new/plugin/introduce/site/security-Introduction.png"]}),P=()=>{y=m({route:"/ws_project",onMessage:D})},C=i((()=>x.scanStatus&&!x.isEnd?"正在扫描":"定期扫描网站，提升网站安全性")),S=i((()=>x.scanStatus&&!x.isEnd?"".concat(f.value):x.time?"上次检测时间：".concat(x.time):"当前安全风险未知，请立即检测")),D=(a,s)=>{var t,n;if(s.data){const a=JSON.parse(s.data.replace(/'/g,'"'));if(a.hasOwnProperty("end")&&a.end){if((null==(n=null==(t=a.webinfo)?void 0:t.result)?void 0:n[a.type].length)>0?(x.progressConfig[a.type]=a.webinfo.result[a.type],x.statusTotal[a.type]=a.webinfo.result[a.type].length):x.statusTotal[a.type]=0,f.value=a.info,g.value===_.value.length-1)return null==y||y.close(),g.value=0,x.scanStatus=!1,void(x.isEnd=!0);let s=(new Date).getTime();g.value++,null==y||y.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:s,name:e.compData.name,scan_list:[_.value[g.value].name]})}else f.value=a.info,w.value=a.type,a.is_error&&x.error++}},k=()=>{x.scanStatus=!1,x.isEnd=!1,x.error=0,x.warn=0,x.time=0,x.progress=0,x.progressConfig={vulscan:[],webscan:[],filescan:[],backup:[],webshell:[],index:[],webhorse:[],deadchain:[],database:[],ftps:[],backend:[]},x.statusTotal={},x.result={},x.progressStatus={},x.active={vulscan:!1,webscan:!1,filescan:!1,backup:!1,webshell:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1}},E=async()=>{v.value=!0;try{const a=await b({data:JSON.stringify({name:e.compData.name})});if(!a.status)return void d.$message.request(a);x.isEnd=x.time||!1,x.time=p(a.data.time,"yyyy-MM-dd")}catch(a){}finally{v.value=!1}};return r((()=>{E(),k()})),s({onRefresh:async()=>{E(),k()}}),{__sfc:!0,vm:d,props:e,authType:u,viewLoading:v,scanIconData:_,scanIndex:g,checkName:f,checkTopic:w,scanParam:x,useSocket:y,productData:h,createWebSocket:P,progressTitle:C,progressSubTitle:S,onWSReceive:D,titleClick:a=>{x.active[a]=!x.active[a]},scanDetectEvent:async()=>{if(x.scanStatus&&!x.isEnd||x.isEnd,x.scanStatus&&!x.isEnd)return await d.$confirm({title:"取消扫描",message:"确定取消扫描吗?",icon:"warning"}),null==y||y.close(),g.value=0,void k();x.isEnd&&(await(null==y?void 0:y.close()),g.value=0,await k()),x.scanStatus=!0,P();let a=(new Date).getTime();null==y||y.send({"x-http-token":window.vite_public_request_token}),null==y||y.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:a,name:e.compData.name,scan_list:[_.value[g.value].name]})},resetData:k,getScanNum:E,onlineServiceDialog:o}}}),(function(){var a=this,s=a._self._c,e=a._self._setupProxy;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.viewLoading,expression:"viewLoading"}],attrs:{id:"safeDetectList"}},["ltd"===e.authType?s("div",[s("div",{staticClass:"progress-header"},[s("div",{staticClass:"progress-header-cot"},[s("div",{staticClass:"flex items-center"},[e.scanParam.scanStatus&&!e.scanParam.isEnd?s("div",{staticClass:"scan-icon relative h-[8rem] w-[8rem]"},[s("div",{staticClass:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"}),s(u,{staticClass:"absolute top-0 left-0 right-0 bottom-0 m-[auto]",attrs:{name:"scanning-scan",size:"5"}})],1):s("div",[e.scanParam.warn||e.scanParam.error?s(u,{attrs:{name:"scanning-danger",size:"7.6"}}):s(u,{attrs:{name:"scanning-"+(e.scanParam.isEnd?"success":"risk"),size:"7.6"}})],1)])]),s("div",{staticClass:"progress-header-cot"},[s("div",{staticClass:"scanning-progress-title"},[e.scanParam.isEnd?[a._v(" 检测完成 "),e.scanParam.error>0||e.scanParam.warn>0?[a._v(" ，共发现 "),e.scanParam.error>0?[s("span",{staticClass:"text-danger"},[a._v(a._s(e.scanParam.error))]),a._v(" 项风险 ")]:a._e()]:a._e()]:[a._v(" "+a._s(e.progressTitle)+" ")]],2),s("div",{staticClass:"scanning-progress-cont"},[a._v(a._s(e.progressSubTitle))])]),s("div",{staticClass:"progress-header-cot"},[s(v,{class:{"warning-hover":e.scanParam.scanStatus&&!e.scanParam.isEnd},attrs:{type:e.scanParam.scanStatus&&!e.scanParam.isEnd?"warning":"primary",plain:!(!e.scanParam.scanStatus||e.scanParam.isEnd)},on:{click:e.scanDetectEvent}},[a._v(a._s(e.scanParam.scanStatus&&!e.scanParam.isEnd?"取消扫描":e.scanParam.isEnd?"重新检测":"立即检测"))]),e.scanParam.isEnd?s(v,{attrs:{type:"default"},on:{click:function(a){return e.onlineServiceDialog()}}},[a._v("立即修复")]):a._e()],1)]),s(f,{staticClass:"!mt-0 !mb-20x !bg-[#F1F1F1]"}),s("div",{staticClass:"progress-cont-list"},[e.scanParam.scanStatus||e.scanParam.isEnd?a._e():s("div",[s("div",{staticClass:"font-bold text-[1.6rem] text-[#666] my-[4rem]"},[a._v("支持网站以下安全扫描项:")]),s("div",{staticClass:"inline-grid grid-cols-4 w-full mt-20x"},a._l(e.scanIconData,(function(e,t){return s("div",{key:t,staticClass:"flex flex-col inline-block items-center mb-20x"},[s(_,{staticClass:"w-[6rem] inline-block mb-8x opacity-90",attrs:{src:"scan/scanning-"+e.name+"-ico.svg"}}),a._v(" "+a._s(e.title)+" ")],1)})),0)]),a._l(e.scanIconData,(function(t,n){return e.scanParam.scanStatus||e.scanParam.isEnd?s("div",{key:n,staticClass:"progress_item",class:t.name+"_item "+(e.scanParam.active[t.name]?"active":"")},[s("div",{staticClass:"progress_item_header",on:{click:function(a){return e.titleClick(t.name)}}},[s("div",{staticClass:"progress_type"},[s(_,{staticClass:"mr-12x w-[2rem]",attrs:{src:"scan/scanning-"+t.name+"-ico.svg"}}),s("span",[a._v(a._s(t.title))])],1),s("div",{staticClass:"flex-1"},[e.scanParam.statusTotal[t.name]?s("span",{staticClass:"text-danger mr-4x"},[a._v("发现"+a._s(e.scanParam.statusTotal[t.name])+"项危险")]):a._e(),e.scanParam.scanStatus&&e.checkTopic==t.name?s("span",[a._v("正在扫描...")]):a._e(),e.scanParam.scanStatus||e.scanParam.statusTotal[t.name]?a._e():s("span",{staticClass:"text-primary"},[a._v("无风险项")]),e.scanParam.scanStatus&&e.checkTopic!=t.name&&!e.scanParam.statusTotal[t.name]?s("span",[a._v("等待扫描")]):a._e()]),s("div",{staticClass:"progress_fold text-[1.2rem] flex items-center"},[s("span",{staticClass:"mr-4x"},[a._v(" "+a._s(e.scanParam.active[t.name]?"收起":"展开")+" ")]),s("i",{class:e.scanParam.active[t.name]?"el-icon-arrow-up":"el-icon-arrow-down"})])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.scanParam.active[t.name],expression:"scanParam.active[value.name]"}],staticClass:"progress_item_body"},a._l(e.scanParam.progressConfig[t.name],(function(e,t){return s("div",{key:t,staticClass:"progress_item_info"},[s("div",{staticClass:"flex flex-col py-8x px-12x text-[1.2rem]"},[s("span",[a._v(a._s(e.name))]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.repair,expression:"item.repair"}]},[s(f,{staticClass:"!my-8x"}),s("span",{staticClass:"whitespace-normal leading-2rem"},[a._v(a._s(e.repair))])],1)])])})),0)]):a._e()}))],2)],1):s(g,{staticClass:"p-20x",attrs:{data:e.productData}})],1)}),[],!1,null,"95d377f3",null,null).exports;const x=d(e({__name:"index",props:{compData:{default:{}}},setup(a){const e=a,{proxy:n}=c(),i=t("safeScan"),l=t([{title:"安全扫描",type:"safeScan",component:w,compData:e.compData},{title:"违规词检测",type:"wordDetection",component:()=>s((()=>import("./WordDetection.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url),compData:e.compData},{title:"动态查杀",type:"dynamicKilling",component:()=>s((()=>import("./DynamicKilling.js?v=1714377894636")),__vite__mapDeps([25,26,6,7,5,4,2,3,8,9,10,11,12,17,27,28,29,21,13,20,23,24,22]),import.meta.url),compData:e.compData}]);return r((()=>{l.value.splice(1,2)})),{__sfc:!0,vm:n,props:e,tabActive:i,tabConfig:l}}}),(function(){var s=this._self._c,e=this._self._setupProxy;return s("div",[s(a,{ref:"addDeploy",attrs:{type:"navtwo",config:e.tabConfig},model:{value:e.tabActive,callback:function(a){e.tabActive=a},expression:"tabActive"}})],1)}),[],!1,null,"7549eaf4",null,null).exports;export{x as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./WordDetection.js?v=1714377894636","./index51.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./index59.js?v=1714377894636","./index85.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index55.js?v=1714377894636","./confirm.js?v=1714377894636","./config.js?v=1714377894636","./index38.js?v=1714377894636","./index45.js?v=1714377894636","./firewall.popup.js?v=1714377894636","./site.store.js?v=1714377894636","./check.js?v=1714377894636","./DynamicKilling.js?v=1714377894636","./index120.js?v=1714377894636","./index46.js?v=1714377894636","./element-lib.js?v=1714377894636","./index.vue_vue_type_style_index_0_lang.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
