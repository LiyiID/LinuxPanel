import{_ as e}from"./index118.js?v=1714377894636";import{w as s,x as t,y as a,j as i,z as r,q as o,s as l,L as n,o as m}from"./element-lib.js?v=1714377894636";import{a3 as c,n as u,r as d,q as p,a as v,b as f}from"./main.js?v=1714377894636";import{_ as x}from"./index130.js?v=1714377894636";import"./index45.js?v=1714377894636";import{_ as b}from"./index85.js?v=1714377894636";import{e as h,b as w,c as y,h as C,j as A}from"./vue-lib.js?v=1714377894636";import{g as _,bs as D,bt as S,bu as g}from"./site.store.js?v=1714377894636";import{a2 as k,a3 as j}from"./site.popup.js?v=1714377894636";import{f as H}from"./check.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";const T=u(h({__name:"BusCertVerifyInfo",props:{compData:{default:{orderInfo:{}}}},setup(e){const s=e,{refs:{sslApplicationInfo:t,sslDnsApiInfo:a,certVerifyInfo:i},getSslDnsApiInfo:r,verifyBusCert:o}=_(),l=[{text:"OV/EV证书申请流程条件："},{text:"1、填写网站验证信息(文件验证或DNS验证)"},{text:"2、完成邮箱认证，根据CA发送的邮件完善邮件内容(中文填写即可)"},{text:"3、企查查或者爱企查、百度地图、114best能查询到相关企业信息，且公司名和公司地址完全匹配"},{text:"4、企查查或其他平台留下的电话能保证周一到周五(7:00 - 15:00)能接听到CA的认证电话，电话号码归属地来自美国，请留意接听。"}],n=[{text:"https或者http验证，必须保证网站能通过http/https访问"},{text:"域名前缀是www,提醒用户解析上级根域名，如申请www.bt.cn，请确保解析bt.cn"},{useHtml:!0,content:'<a class="text-primary" href="https://www.bt.cn/bbs/thread-85379-1-1.html" target="_blank">如何验证商用证书?</a>'}],{proxy:m}=A(),u=[{text:"通配符证书只支持DNS验证"}],d=[{text:"多域名只支持DNS验证"}],p=w(!1),v=w(!1),f=w(""),x=w(""),b=w([]),h=w([]),T=w(!1),N=w({domain:""}),$=w({pid:0,oid:0,title:"",limit:1,type:"dv",install:!1,isWildcard:!1,isMulti:!1}),I=w({domains:"",dcvMethod:"",auth_to:"",Administrator:{address:"",city:"",country:"",email:"",firstName:"",lastName:"",job:"",name:"",mobile:"",organation:"",postCode:"",state:""}}),M=w([{value:"CNAME_CSR_HASH",label:"DNS验证(CNAME解析)",tips:"如网站还未备案完成，可选【DNS验证】",isCheck:"",checkTips:[]},{value:"HTTP_CSR_HASH",label:"文件验证(HTTP)",tips:"如网站未开启301、302、强制HTTPS、反向代理功能，请选择HTTP",isCheck:"",checkTips:[]},{value:"HTTPS_CSR_HASH",label:"文件验证(HTTPS)",tips:"如网站开启【强制HTTPS】，请选【HTTPS验证】",isCheck:"",checkTips:[]}]),V=w("CNAME_CSR_HASH"),E=w(!0),P=w("dns"),B=w(!1),R=w(!1),L=y((()=>{const e=[];return R.value&&e.push(...u),B.value&&e.push(...d),e.push(...n),"dv"!==$.value.type&&e.push(...l),e})),O=y((()=>{const e=R.value?"*":"www";return B.value?"多域名".concat(R.value?"通配符":"","证书，每行一个域名，支持").concat($.value.limit,"个域名，必填项,例如：\r").concat(e,".bt.cn\r").concat(e,".bttest.cn"):"请输入需要申请证书的域名（单域名".concat(R.value?"通配符":"","证书），必填项，例如：").concat(e,".bt.cn")})),F=y((()=>I.value.Administrator.lastName+I.value.Administrator.firstName)),W=()=>{I.value.Administrator={...t.value,name:""},I.value.Administrator.name=F.value;const{pid:e,oid:a,title:i,limit:r,install:o,code:l}=s.compData.orderInfo,n=l.indexOf("ev")>-1?"ev":l.indexOf("ov")>-1?"ov":"dv";B.value=l.indexOf("multi")>-1,R.value=l.indexOf("wildcard")>-1,$.value={pid:e,oid:a,title:i,limit:r,install:o,isMulti:B.value,isWildcard:R.value,type:n}},q=async()=>{T.value=!0;const{data:e}=await S(x.value);T.value=!1,M.value.forEach((s=>{const t=c(e[s.value]);s.isCheck="number"===t&&!!e[s.value],s.checkTips="number"===t?!!e[s.value]:e[s.value]}))};return C((()=>{W(),r()})),{__sfc:!0,props:s,sslApplicationInfo:t,sslDnsApiInfo:a,certVerifyInfo:i,getSslDnsApiInfo:r,verifyBusCert:o,isNotDvHelp:l,defalutHelp:n,vm:m,addDomainHelp:[{text:"申请之前，请确保域名已解析，如未解析会导致审核失败(包括根域名)"},{text:"申请www.bt.cn这种以www为二级域名的证书，需绑定并解析顶级域名(bt.cn)，否则将验证失败"},{text:"SSL证书可选名称赠送规则："},{text:"1、申请根域名(如：bt.cn),赠送下一级为www的域名(如：www.bt.cn)"},{text:"2、申请当前host为www的域名（如：www.bt.cn）,赠送上一级域名，(如: bt.cn)"},{text:"3、申请其它二级域名，(如：app.bt.cn)，赠送下一级为www的域名 (如：www.app.bt.cn)"}],isWildcardHelp:u,isMultiHelp:d,selectExistDomainPopup:p,customDomainPopup:v,existDomainSerach:f,existDomainActive:x,existDomainList:b,existDomainBackupList:h,checkDomainMethod:T,customDomainForm:N,orderInfo:$,form:I,sslVerifyTypeList:M,sslVerifyType:V,userBaseShow:E,dnsVerify:P,isMulti:B,isWildcard:R,sslVerifyHelp:L,sslDomainsTips:O,adminName:F,cutCretUserBase:()=>{E.value=!E.value},sslInfoHandle:W,selectExistDomain:async()=>{let e=null;try{e=m.$load("正在获取域名列表,请稍后...");const{data:{data:s}}=await D();p.value=!0,b.value=s,x.value=s[0].name,h.value=s}catch(s){}finally{e&&e.close()}},serachExistDomain:e=>{b.value=[],h.value.forEach((s=>{s.name.indexOf(e)>-1&&b.value.push(s)})),b.value.length||(b.value=h.value)},selectExistDomainConfirm:async()=>{I.value.domains=x.value,p.value=!1,R.value||q()},showCheckResult:e=>{m.$message.msg({customClass:"el-error-html-message",dangerouslyUseHTMLString:!0,message:e.join("<br>"),type:"error"})},reanderDomainCheck:q,selectCustomDomain:()=>{v.value=!0},submitCustomDomain:()=>N.value.domain?H(N.value.domain)?!R.value&&N.value.domain.indexOf("*")>-1?m.$message.error("当前为单域名证书，不支持通配符申请"):(I.value.domains=N.value.domain,v.value=!1,void(R.value||q())):m.$message.error("域名格式错误，请重新输入"):m.$message.error("域名不能为空"),setSslDnsApi:e=>{const s=P.value;if("dns"!==s){const t=a.value.find((e=>e.value===s)),i=!t.data;(!e||e&&i)&&k({title:"设置".concat(t.info.title,"接口"),row:t.info})}},sslInfoSubmit:async()=>{var e;let t=null;if(!I.value.domains)return m.$message.error("域名不能为空");if(!I.value.Administrator.state&&!I.value.Administrator.city)return m.$message.error("所在地区不能为空");if(!I.value.Administrator.address&&"dv"!==$.value.type)return m.$message.error("公司详细地址不能为空");if(!I.value.Administrator.organation)return m.$message.error("公司名称不能为空");if(!I.value.Administrator.name)return m.$message.error("姓名不能为空");if(!I.value.Administrator.email)return m.$message.error("邮箱不能为空");if(!I.value.Administrator.mobile)return m.$message.error("手机不能为空");try{t=m.$load("正在提交证书信息，请稍后...");const{job:a,postCode:r,country:l,firstName:n,lastName:c,name:u,state:d,city:p,address:v,organation:f,email:x,mobile:b}=I.value.Administrator,{data:h}=await g(JSON.stringify({pid:$.value.pid,oid:$.value.oid,domains:null==(e=I.value.domains)?void 0:e.split("\n").filter((e=>e.trim())),dcvMethod:V.value,auth_to:P.value,Administrator:{job:a,postCode:r,country:l,lastName:u,state:d,city:p,address:v,organation:f,email:x,mobile:b}}));m.$message.request(h),h.status&&(m.$emit("close"),s.compData.refreshEvent(),await o($.value.oid),j(i.value.isCNAME))}catch(a){}finally{t&&t.close()}}}}}),(function(){var c=this,u=c._self._c,h=c._self._setupProxy;return u("div",{staticClass:"px-3rem py-3rem"},[u(s,{ref:"form",attrs:{model:h.form,"label-width":"80px"}},[u(t,{attrs:{label:"证书信息"}},[u("span",{staticClass:"text-primary"},[u("span",[c._v(c._s(h.orderInfo.title))]),h.orderInfo.limit>1?u("span",[c._v("，包含"+c._s(h.orderInfo.limit)+"个域名")]):c._e()])]),u(t,{attrs:{label:"域名",prop:"domains"}},[u("div",{staticClass:"flex flex-col"},[u(d,{ref:"popover",attrs:{placement:"top-start","popper-class":"green-tips-popover",title:"",width:"200",disabled:!h.isMulti,trigger:"focus"}},[u("div",{staticClass:"!p-12x bg-[#20a53a] text-white"},[c._v(c._s(h.sslDomainsTips))]),u(b,{staticClass:"disabled-input",attrs:{slot:"reference",disabled:!h.isMulti,width:"42rem",resize:"none",type:h.isMulti?"textarea":"text",placeholder:h.sslDomainsTips},slot:"reference",model:{value:h.form.domains,callback:function(e){c.$set(h.form,"domains",e)},expression:"form.domains"}})],1),u("div",{directives:[{name:"show",rawName:"v-show",value:!h.isMulti,expression:"!isMulti"}]},[u(p,{attrs:{size:"mini"},on:{click:h.selectExistDomain}},[c._v("选择已有域名")]),u(p,{attrs:{size:"mini",type:"defalut"},on:{click:h.selectCustomDomain}},[c._v("自定义域名")])],1)],1)]),u(t,{attrs:{label:"验证方式"}},[u(a,{staticClass:"!leading-[2.4rem]",model:{value:h.sslVerifyType,callback:function(e){h.sslVerifyType=e},expression:"sslVerifyType"}},c._l(h.sslVerifyTypeList,(function(e){return u(i,{key:e.value,staticClass:"item",attrs:{effect:"dark",enterable:!1,content:e.tips,placement:"top-start"}},[h.isWildcard&&"CNAME_CSR_HASH"===e.value||!h.isWildcard?[u(r,{attrs:{label:e.value}},[u("span",{staticClass:"mr-[2px]"},[c._v(c._s(e.label))]),u(v,{directives:[{name:"show",rawName:"v-show",value:""!==e.isCheck,expression:"item.isCheck !== ''"}],class:e.isCheck?"!text-primary":"!text-danger",on:{click:function(s){return h.showCheckResult(e.checkTips)}}},[c._v(" ["+c._s(e.isCheck?"正常":"异常")+"] ")]),h.checkDomainMethod?u("span",{staticClass:"!caret-medium"},[c._v(" ["),u("i",{staticClass:"el-icon-loading"}),c._v("检测中] ")]):c._e()],1)]:c._e()],2)})),1)],1),u(t,{directives:[{name:"show",rawName:"v-show",value:"CNAME_CSR_HASH"===h.sslVerifyType,expression:"sslVerifyType === 'CNAME_CSR_HASH'"}],attrs:{label:"选择DNS接口"}},[u(o,{staticClass:"mr-16x",attrs:{placeholder:"请选择"},on:{change:function(e){return h.setSslDnsApi(!0)}},model:{value:h.dnsVerify,callback:function(e){h.dnsVerify=e},expression:"dnsVerify"}},c._l(h.sslDnsApiInfo,(function(e){return u(l,{key:e.value,attrs:{label:e.label,value:e.value}},[u("span",{staticClass:"flex justify-between"},[u("span",[c._v(c._s(e.label))]),u("span",{directives:[{name:"show",rawName:"v-show",value:e.config,expression:"item.config"}],class:e.data?"text-primary":"text-orange"},[c._v(" "+c._s(e.data?"[已配置]":"[未配置]")+" ")])])])})),1),u(p,{directives:[{name:"show",rawName:"v-show",value:"dns"!==h.dnsVerify,expression:"dnsVerify !== 'dns'"}],staticClass:"ml-8x",attrs:{type:"defalut"},on:{click:function(e){return h.setSslDnsApi(!1)}}},[c._v(" 配置 ")])],1),u("div",{staticClass:"px-40x"},[u(n,[u("span",{staticClass:"text-primary cursor-pointer",on:{click:h.cutCretUserBase}},[u("i",{class:"el-icon-arrow-".concat(h.userBaseShow?"up":"down")}),u("span",{staticClass:"text-[1.2rem] ml-4x"},[c._v(c._s(h.userBaseShow?"收起":"展开")+"证书用户信息")])])])],1),u("div",{directives:[{name:"show",rawName:"v-show",value:h.userBaseShow,expression:"userBaseShow"}],staticClass:"pb-16x"},[u(t,{attrs:{label:"所在地区"}},[u("div",{staticClass:"flex flex-row"},[u(x,{attrs:{"custom-class":"mr-16x !w-[20rem]","placeholder-tips":"请输入所在省份，必填项"},model:{value:h.form.Administrator.state,callback:function(e){c.$set(h.form.Administrator,"state",e)},expression:"form.Administrator.state"}}),u(x,{attrs:{"custom-class":"!w-[20rem]","placeholder-tips":"请输入所在市/县，必填项"},model:{value:h.form.Administrator.city,callback:function(e){c.$set(h.form.Administrator,"city",e)},expression:"form.Administrator.city"}})],1)]),u(t,{directives:[{name:"show",rawName:"v-show",value:"dv"!==h.orderInfo.type,expression:"orderInfo.type !== 'dv'"}],attrs:{label:"公司详细地址"}},[u(x,{attrs:{"custom-class":"!w-[42rem]","placeholder-tips":"请输入公司详细地址，具体要求见说明，必填项"},model:{value:h.form.Administrator.address,callback:function(e){c.$set(h.form.Administrator,"address",e)},expression:"form.Administrator.address"}})],1),u(t,{attrs:{label:"公司名称"}},[u(x,{attrs:{"custom-class":"!w-[42rem]","placeholder-tips":"请输入公司名称，如为个人申请请输入个人姓名，必填项"},model:{value:h.form.Administrator.organation,callback:function(e){c.$set(h.form.Administrator,"organation",e)},expression:"form.Administrator.organation"}})],1),u(t,{attrs:{label:"姓名"}},[u(x,{attrs:{"custom-class":"!w-[42rem]","placeholder-tips":"请输入姓名，必填项"},model:{value:h.form.Administrator.name,callback:function(e){c.$set(h.form.Administrator,"name",e)},expression:"form.Administrator.name"}})],1),u(t,{attrs:{label:"邮箱"}},[u(x,{attrs:{"custom-class":"!w-[42rem]","placeholder-tips":"请输入邮箱地址，必填项"},model:{value:h.form.Administrator.email,callback:function(e){c.$set(h.form.Administrator,"email",e)},expression:"form.Administrator.email"}})],1),u(t,{attrs:{label:"手机"}},[u(x,{attrs:{"custom-class":"!w-[42rem]","placeholder-tips":"请输入手机号码，若为空，则使用当前绑定手机号"},model:{value:h.form.Administrator.mobile,callback:function(e){c.$set(h.form.Administrator,"mobile",e)},expression:"form.Administrator.mobile"}})],1)],1),u(t,{attrs:{label:" "}},[u(p,{on:{click:h.sslInfoSubmit}},[c._v("提交资料")])],1),u(t,[u(e,{staticClass:"mt-20x pl-20x text-left text-[1.2rem]",attrs:{list:h.sslVerifyHelp,listStyle:"disc"}})],1)],1),u(f,{attrs:{title:"选择域名",visible:h.selectExistDomainPopup,area:57,"show-footer":!0},on:{"update:visible":function(e){h.selectExistDomainPopup=e},confirm:h.selectExistDomainConfirm}},[u("div",{staticClass:"p-20x"},[u(m,{staticClass:"!w-[53rem] mb-16x",attrs:{placeholder:"支持字段模糊搜索",clearable:""},on:{input:h.serachExistDomain},model:{value:h.existDomainSerach,callback:function(e){h.existDomainSerach=e},expression:"existDomainSerach"}}),u("div",{staticClass:"mb-8x border-light"},[u("div",{staticClass:"flex justify-between items-center bg-[#f6f6f6] py-[1rem] pl-[1rem]"},[c._v("域名")]),u(a,{staticClass:"custom-radio-group 1111 py-2x",model:{value:h.existDomainActive,callback:function(e){h.existDomainActive=e},expression:"existDomainActive"}},c._l(h.existDomainList,(function(e){return u(r,{attrs:{label:e.name}},[c._v(c._s(e.name))])})),1)],1),u(e,{staticClass:"ml-20x",attrs:{list:h.addDomainHelp,listStyle:"disc"}})],1)]),u(f,{attrs:{title:"自定义域名",visible:h.customDomainPopup,area:57,"show-footer":!0},on:{"update:visible":function(e){h.customDomainPopup=e},confirm:h.submitCustomDomain}},[u("div",{staticClass:"p-20x"},[u(s,{staticClass:"mb-16x",model:{value:h.customDomainForm,callback:function(e){h.customDomainForm=e},expression:"customDomainForm"}},[u(t,{attrs:{label:"自定义域名",prop:"domain"}},[u(m,{staticClass:"!w-[40rem] mb-8x",attrs:{autofocus:"",placeholder:"请输入需要申请证书的域名（单域名证书），必填项，例如：www.bt.cn"},model:{value:h.customDomainForm.domain,callback:function(e){c.$set(h.customDomainForm,"domain",e)},expression:"customDomainForm.domain"}})],1)],1),u(e,{staticClass:"ml-20x",attrs:{list:h.addDomainHelp,listStyle:"disc"}})],1)])],1)}),[],!1,null,"8d24f1cb",null,null).exports;export{T as default};
