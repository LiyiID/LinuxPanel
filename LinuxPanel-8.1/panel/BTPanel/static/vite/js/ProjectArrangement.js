import{q as e,s as t}from"./element-lib.js?v=1714377894636";import{l as a,n as s,q as l,b as r,r as i}from"./main.js?v=1714377894636";import{_ as o}from"./index53.js?v=1714377894636";import{_ as n}from"./index39.js?v=1714377894636";import{_ as c}from"./index55.js?v=1714377894636";import{_ as u}from"./index85.js?v=1714377894636";import{_ as p}from"./index59.js?v=1714377894636";import{_ as m}from"./preload-helper.js?v=1714377894636";import{e as d,b as v,v as f,h as y,j as b}from"./vue-lib.js?v=1714377894636";import{g as j,a as g,e as _}from"./index38.js?v=1714377894636";import{g as h,bg as x,bh as C,bi as P,j as k,bj as w,bk as S,bl as L,bm as T,bn as q,bo as G}from"./site.store.js?v=1714377894636";import{o as R}from"./index61.js?v=1714377894636";import{a as D}from"./confirm.js?v=1714377894636";import{c as B}from"./check.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./config.js?v=1714377894636";const F=s(d({__name:"ProjectArrangement",setup(e){const{proxy:t}=b(),{refs:{modulesTableParams:s}}=h(),l=v([j(),{prop:"group_name",label:"分组名称"},g({event:e=>{U(e)},data:["未启动","运行中"]}),_([{onClick:e=>{c.value=!0,N.value=e,K(e.id)},title:"编辑"},{onClick:e=>{z(e.id)},title:"删除"}])]),r=v([]),i=v(!1),o=v([]),n=v(!1),c=v(!1),u=v([j(),{prop:"project_name",label:"项目名称"},g({event:e=>{W(e)},data:["未启动","运行中"]}),_([{onClick:e=>{Q(e.project_name)},title:"删除"}])]),p=v([]),d=v(!1),F=v(""),N=v([]),$=v(!1),E=v(""),O=v(""),A=v([]),J=f({isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:""}}),V=v([{label:"停止项目组",value:"stopGroup",diyBatch:()=>{R({title:"批量停止选中项目组后，将依次停止项目组内的项目，是否继续操作？",dataList:p.value,titleType:"批量停止选中项目组",requestFun:async e=>await x({id:e.id,status:e.status?0:1,interval:e.interval,group_name:e.group_name}),isRecurrence:!0,tableColumn:[{prop:"group_name",label:"分组名称"},{prop:"result",label:"状态"}],callback:async()=>{M()}})}},{label:"删除项目组",value:"delGroup",diyBatch:()=>{R({title:"批量删除选中项目组后，是否继续操作？",dataList:p.value,titleType:"批量删除选中项目组",requestFun:async e=>await C({id:e.id}),isRecurrence:!0,tableColumn:[{prop:"group_name",label:"分组名称"},{prop:"result",label:"状态"}],callback:async()=>{M()}})}}]),H=v([{label:"启动项目",value:"startProject",diyBatch:()=>{R({diyRes:!0,title:"批量启用选中的项目后，项目将恢复正常访问，是否继续操作？",dataList:p.value,titleType:"批量启动项目",requestFun:async e=>{await I(e,"start")},tableColumn:[{prop:"project_name",label:"分组名称"},{prop:"result",label:"状态"}],isRecurrence:!1})}},{label:"停止项目",value:"stopProject",diyBatch:()=>{R({diyRes:!0,title:"批量停用选中的项目后，项目将无法正常访问，用户访问会显示当前项目停用页面，是否继续操作？",dataList:p.value,titleType:"批量停用选中的项目",requestFun:async e=>await I(e,"stop"),isRecurrence:!1,tableColumn:[{prop:"project_name",label:"分组名称"},{prop:"result",label:"状态"}]})}},{label:"删除项目",value:"delProject",diyBatch:()=>{R({title:"批量删除选中的项目后，分组下将不会存在该项目，是否继续操作？",dataList:p.value,titleType:"批量删除选中项目组",requestFun:async e=>await P({id:N.value.id,project_name:e.project_name}),isRecurrence:!0,tableColumn:[{prop:"project_name",label:"分组名称"},{prop:"result",label:"状态"}],callback:async()=>{K(N.value.id)}})}}]),I=async(e,s)=>{let l=t.$load("正在处理中,请稍后...");try{let e=p.value.map((e=>e.project_name));const t=await k({data:JSON.stringify({operation:s,project_names:e})});let l=t.data.project_names.map((e=>({name:e,status:t.data.status})));K(N.value.id),await a({title:"批量"+("stop"===s?"停止":"启动")+"结果",area:46,component:()=>m((()=>import("./index63.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url),compData:{resultData:l}})}catch(r){}finally{l.close()}},M=async()=>{try{i.value=!0;const e=await w(),t=B(e.data.value,"array",[]);r.value=t}catch(e){}finally{i.value=!1}},z=async e=>{try{const a=await C({id:e});t.$message.request(a),M()}catch(a){}},K=async e=>{try{e||(e=N.value.id),n.value=!0;const t=await S({id:e});o.value=t.data.value}catch(t){}finally{n.value=!1}},Q=async e=>{D({confirm:{title:"删除项目",icon:"warning",message:"删除项目后，[ "+N.value.group_name+" ]分组下将不会存在该项目，是否继续操作？?"},loading:"正在删除备份，请稍后...",request:async()=>await P({id:N.value.id,project_name:e}),async complete(){K(N.value.id)}})},U=async e=>{D({confirm:{title:"修改分组状态",icon:"warning",message:"修改分组状态后，将依次 "+(1===e.status?"停止":"启动")+"["+e.group_name+" ]分组下的项目，是否继续操作？"},loading:"正在修改分组状态，请稍后...",request:async()=>await x({id:e.id,status:0===e.status?1:0}),complete:M})},W=async e=>{D({confirm:{title:"修改项目状态",icon:"warning",message:(e.status?"停止":"开启")+"项目【"+e.project_name+" 】"+(e.status?"停止将无法":"开启可以")+"正常访问项目,是否继续操作？"},loading:"正在修改状态，请稍后...",request:async()=>{const t=await L({data:JSON.stringify({project_name:e.project_name})},e.status);return t.data.status&&(t.msg="".concat(e.status?"停止":"开启","成功，如果状态未改变，").concat(e.status?"可能由于项目关闭需要一定的时间":"可能由于项目还在启动中","，请 1-2 分钟后手动刷新页面")),t},complete:M})};return y((async()=>{await M()})),{__sfc:!0,vm:t,modulesTableParams:s,tableColumns:l,tableData:r,tableLoading:i,editData:o,editLoading:n,editPopup:c,editColumns:u,checkedList:p,addProjectPopup:d,projectSelect:F,projectData:N,visible:$,projectStartTime:E,group_name:O,siteNameList:A,batchConfig:J,batchGroup:V,projectBatchGroup:H,handleMultiSetProject:I,handleSelectionChange:e=>{p.value=e},batchEvent:(e,t,a)=>{},getList:M,addGroup:async()=>{let e=t.$load("正在添加分组,请稍后...");try{const e=await T({group_name:O.value});t.$message.request(e),O.value="",M()}catch(a){}finally{e.close()}},delGroup:z,getGroupProject:K,addProject:()=>{d.value=!0,A.value=[],A.value=s.value.list.map((e=>e.name)),F.value=A.value[0]},handleConfirmProject:async()=>{try{const e=await q({project_name:F.value,id:N.value.id});t.$message.request(e),d.value=!1,K(N.value.id)}catch(e){}},delProject:Q,openTimeSettins:()=>{$.value=!$.value,E.value=N.value.interval},setProjectStartTime:async()=>{try{const e=await G({id:N.value.id,interval:E.value});t.$message.request(e),$.value=!1,await M(),N.value=r.value.find((e=>e.id===N.value.id))}catch(e){}},changeGroupStatus:U,changeProjectStatus:W}}}),(function(){var a=this,s=a._self._c,m=a._self._setupProxy;return s("div",{staticClass:"p-20x"},[s(p,{scopedSlots:a._u([{key:"header-left",fn:function(){return[s("div",{staticClass:"flex items-center"},[s(u,{attrs:{placeholder:"请输入分组名"},model:{value:m.group_name,callback:function(e){m.group_name=e},expression:"group_name"}}),s(l,{staticClass:"!ml-8x",on:{click:m.addGroup}},[a._v("添加分组")])],1)]},proxy:!0},{key:"header-right",fn:function(){return[s(c,{attrs:{refresh:m.getList}})]},proxy:!0},{key:"content",fn:function(){return[s(n,{directives:[{name:"loading",rawName:"v-loading",value:m.tableLoading,expression:"tableLoading"}],attrs:{height:"300",column:m.tableColumns,data:m.tableData},on:{"selection-change":m.handleSelectionChange}})]},proxy:!0},{key:"footer-left",fn:function(){return[s(o,{attrs:{data:m.batchGroup,config:m.batchConfig,"batch-fn":m.batchEvent}})]},proxy:!0},{key:"popup",fn:function(){return[s(r,{attrs:{title:"编辑分组",visible:m.editPopup,area:56},on:{"update:visible":function(e){m.editPopup=e}}},[s("div",{staticClass:"p-20x"},[s(p,{scopedSlots:a._u([{key:"header-left",fn:function(){return[s(l,{on:{click:m.addProject}},[a._v("添加项目")]),s(i,{attrs:{placement:"bottom",width:"360","popper-class":"white-tips-popover",trigger:"manual"},model:{value:m.visible,callback:function(e){m.visible=e},expression:"visible"}},[s("div",{staticClass:"flex items-center p-20x"},[s(u,{attrs:{"text-type":"秒",type:"number",min:1},model:{value:m.projectStartTime,callback:function(e){m.projectStartTime=e},expression:"projectStartTime"}}),s(l,{staticClass:"!ml-8x",on:{click:m.setProjectStartTime}},[a._v("保存")])],1),s(l,{staticClass:"!ml-8x",attrs:{slot:"reference",type:"default"},on:{click:m.openTimeSettins},slot:"reference"},[a._v("启动间隔")])],1)]},proxy:!0},{key:"header-right",fn:function(){return[s(c,{attrs:{refresh:m.getGroupProject}})]},proxy:!0},{key:"content",fn:function(){return[s(n,{directives:[{name:"loading",rawName:"v-loading",value:m.editLoading,expression:"editLoading"}],attrs:{height:"300",column:m.editColumns,data:m.editData},on:{"selection-change":m.handleSelectionChange}})]},proxy:!0},{key:"footer-left",fn:function(){return[s(o,{attrs:{data:m.projectBatchGroup,config:m.batchConfig,"batch-fn":m.batchEvent}})]},proxy:!0},{key:"popup",fn:function(){return[s(r,{attrs:{title:"添加项目",visible:m.addProjectPopup,showFooter:"",area:42},on:{"update:visible":function(e){m.addProjectPopup=e},confirm:m.handleConfirmProject}},[s("div",{staticClass:"p-20x flex items-center justify-center"},[s(e,{model:{value:m.projectSelect,callback:function(e){m.projectSelect=e},expression:"projectSelect"}},a._l(m.siteNameList,(function(e){return s(t,{key:e,attrs:{label:e,value:e}})})),1)],1)])]},proxy:!0}])}),s("ul",{staticClass:"mt-8x leading-8 text-[1.2rem] list-disc ml-20x"},[s("li",[a._v("注意：停用和启动项目后，可能需要一定的时间，请操作后 1-2 分钟再手动刷新页面")])])],1)])]},proxy:!0}])},[s("ul",{staticClass:"mt-8x leading-8 text-[1.2rem] list-disc ml-20x"},[s("li",[a._v(" 启动项目组会将组内项目全部停止再按顺序启动，可能会影响正在运行的项目，请您谨慎操作！ ")])])]),a._m(0)],1)}),[function(){var e=this,t=e._self._c;return e._self._setupProxy,t("ul",{staticClass:"mt-8x leading-8 text-[1.2rem] list-disc ml-20x"},[t("li",[e._v("启动项目组会将组内项目全部停止再按顺序启动，可能会影响正在运行的项目，请您谨慎操作！")])])}],!1,null,"90decf8c",null,null).exports;export{F as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index63.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./vue-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./element-lib.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
