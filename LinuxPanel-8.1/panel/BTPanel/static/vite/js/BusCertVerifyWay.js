import{a as t,$ as e,n as s,q as a}from"./main.js?v=1714377894636";import{_ as l}from"./index118.js?v=1714377894636";import{_ as r}from"./index39.js?v=1714377894636";import{w as o,x as n,o as i}from"./element-lib.js?v=1714377894636";import{e as m,b as c,v as u,H as p,h as f,j as d}from"./vue-lib.js?v=1714377894636";import{_ as y}from"./index45.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{a4 as v}from"./site.popup.js?v=1714377894636";import{g as C,bv as _}from"./site.store.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";import"./check.js?v=1714377894636";const b=s(m({__name:"BusCertVerifyWay",setup(s,{expose:a}){const{refs:{certVerifyInfo:l,isRefreshSSL:r},verifyBusCert:o}=C(),{proxy:n}=d(),i=c(""),m=c(""),b=u({dnsHost:"",dnsType:"",dnsValue:"",filePath:"/.well-known/pki-validation/",fileName:"",fileContent:""}),x=c([]),h=c([{label:"URL",prop:"url"},{label:"验证结果",prop:"status",width:100,render:t=>1==t.status?p("span",{class:"text-[#20a53a]"},["通过"]):p("span",{class:"text-[red]"},["失败[",t.status,"]",p("a",{attrs:{href:"https://www.bt.cn/bbs/thread-56802-1-1.html",target:"_blank"},class:"el-icon-question text-warning"})])},{label:"操作",align:"right",width:150,render:(e,s)=>[p("div",{class:"flex items-center justify-end"},[p(t,{on:{click:()=>w(e.url)}},["复制"]),p(y),p(t,{attrs:{href:e.url,target:"_blank"}},["打开"]),p(y),p(t,{on:{click:()=>k(e,s)}},["重新验证"])])]}]),j=c([{text:"本次验证结果是由【本服务器验证】，实际验证将由【CA服务器】进行验证，请耐心等候"},{text:"请确保以上列表所有项都验证成功后点击【验证域名】重新提交验证"},{text:"如长时间验证不通过，请通过【修改验证方式】更改为【DNS验证】"},{useHtml:!0,content:'如何添加域名解析，《<a href="https://cloud.tencent.com/document/product/302/3446" class="text-primary" target="__blink">点击查看教程</a>》，和咨询服务器运营商'}]),k=async(t,e)=>{let s=null;try{s=n.$load("正在验证商用证书，请稍后...");const{data:a}=await _({url:t.url,content:t.content});x.value[e].status=a}catch(a){}finally{s&&s.close()}},w=t=>{e({value:t}),n.$message.success("复制成功")},V=()=>{n.$emit("close")},H=()=>{var t;if(null==(t=l.value)?void 0:t.data){const{data:{dcvList:t,DCVdnsHost:e,DCVdnsType:s,DCVdnsValue:a,DCVfileName:r,DCVfileContent:o},paths:n}=l.value.data;i.value=null==t?void 0:t.map((t=>t.domainName)).join(","),m.value=t[0].dcvMethod,b.dnsHost=e,b.dnsType=s,b.dnsValue=a,b.fileName=r,b.fileContent=o,"CNAME_CSR_HASH"!==m.value&&(x.value=null==n?void 0:n.map((t=>({url:t.url,status:t.status,content:o}))),j.value.splice(3,1,{useHtml:!0,content:'SSL添加文件验证方式 ->> <a href="https://www.bt.cn/bbs/thread-56802-1-1.html" target="_blank" class="text-primary" >查看教程</a>'}))}};return f((()=>{H()})),a({onCancel:V}),{__sfc:!0,certVerifyInfo:l,isRefreshSSL:r,verifyBusCert:o,vm:n,domains:i,type:m,form:b,urlTableData:x,tableColumn:h,helpList:j,verifyDomain:async()=>{var t;await o(l.value.oid),await H(),"PENDING"===(null==(t=l.value)?void 0:t.data.certStatus)&&n.$message.success("验证中，请耐心等待！"),n.$emit("close"),r.value=!0},resultsVerify:k,setVerifyType:()=>{n.$emit("close"),v({oid:l.value.oid,type:m.value})},copyResult:w,onCancel:V,initCertData:H}}}),(function(){var t=this,e=t._self._c,s=t._self._setupProxy;return e("div",{staticClass:"p-[5rem]"},[e("div",{staticClass:"text-[1.4rem] mb-[2rem]"},[t._v(" 请给以下域名【 "),e("span",{staticClass:"text-primary"},[t._v(t._s(s.domains))]),t._v(" 】 "),"CNAME_CSR_HASH"===s.type?[t._v("添加“"+t._s(s.form.dnsType)+"”解析，解析参数如下： ")]:[t._v("添加验证文件，验证信息如下：")]],2),"CNAME_CSR_HASH"===s.type?[e(o,{staticClass:"mb-20x"},[e(n,{attrs:{label:"主机记录："}},[e(i,{staticClass:"!w-[36rem] mr-[1rem]",attrs:{type:"text",readonly:""},model:{value:s.form.dnsHost,callback:function(e){t.$set(s.form,"dnsHost",e)},expression:"form.dnsHost"}}),e(a,{on:{click:function(t){return s.copyResult(s.form.dnsHost)}}},[t._v("复制")])],1),e(n,{attrs:{label:"记录类型："}},[e(i,{staticClass:"!w-[42rem]",attrs:{type:"text",readonly:""},model:{value:s.form.dnsType,callback:function(e){t.$set(s.form,"dnsType",e)},expression:"form.dnsType"}})],1),e(n,{attrs:{label:"记录值："}},[e(i,{staticClass:"!w-[36rem] mr-[1rem]",attrs:{type:"textarea",rows:3,readonly:""},model:{value:s.form.dnsValue,callback:function(e){t.$set(s.form,"dnsValue",e)},expression:"form.dnsValue"}}),e(a,{staticClass:"align-top",on:{click:function(t){return s.copyResult(s.form.dnsValue)}}},[t._v("复制")])],1)],1)]:[e(o,{staticClass:"mb-20x"},[e(n,{attrs:{label:"文件位置："}},[e(i,{staticClass:"!w-[36rem] mr-[1rem]",attrs:{type:"text",readonly:""},model:{value:s.form.filePath,callback:function(e){t.$set(s.form,"filePath",e)},expression:"form.filePath"}}),e(a,{on:{click:function(t){return s.copyResult(s.form.filePath)}}},[t._v("复制")])],1),e(n,{attrs:{label:"文件名："}},[e(i,{staticClass:"!w-[36rem] mr-[1rem]",attrs:{type:"text",readonly:""},model:{value:s.form.fileName,callback:function(e){t.$set(s.form,"fileName",e)},expression:"form.fileName"}}),e(a,{on:{click:function(t){return s.copyResult(s.form.fileName)}}},[t._v("复制")])],1),e(n,{attrs:{label:"记录值："}},[e(i,{staticClass:"!w-[36rem] mr-[1rem]",attrs:{type:"textarea",rows:3,readonly:""},model:{value:s.form.fileContent,callback:function(e){t.$set(s.form,"fileContent",e)},expression:"form.fileContent"}}),e(a,{staticClass:"align-top",on:{click:function(t){return s.copyResult(s.form.fileContent)}}},[t._v("复制")])],1)],1),e(r,{attrs:{column:s.tableColumn,data:s.urlTableData}})],e(l,{staticClass:"ml-20x mt-12x",attrs:{list:s.helpList,"list-style":"disc"}}),e("div",{staticClass:"mt-20x"},[e(a,{on:{click:function(t){return s.verifyDomain()}}},[t._v("验证域名")]),e(a,{attrs:{type:"defalut"},on:{click:s.setVerifyType}},[t._v("修改验证方式")]),e(a,{attrs:{type:"defalut"},on:{click:s.onCancel}},[t._v("返回列表")])],1)],2)}),[],!1,null,null,null,null).exports;export{b as default};
