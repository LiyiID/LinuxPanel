import{_ as e}from"./index52.js?v=1714377894636";import{_ as t}from"./index53.js?v=1714377894636";import{_ as a}from"./index39.js?v=1714377894636";import{_ as r}from"./index54.js?v=1714377894636";import{_ as o}from"./index58.js?v=1714377894636";import{_ as n}from"./index59.js?v=1714377894636";import{e as i,b as s,v as l,L as c,h as m,j as p,H as u}from"./vue-lib.js?v=1714377894636";import{g as d,P as g,n as h}from"./main.js?v=1714377894636";import{a as f}from"./docker.table.js?v=1714377894636";import{p as b,h as v,i as j,S as x,j as D,N as y,k,l as _}from"./docker.popup.js?v=1714377894636";import{e as C}from"./docker.api.js?v=1714377894636";import{g as T}from"./docker.store.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./element-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";import"./check.js?v=1714377894636";const P=h(i({__name:"DockerImages",setup(e){var t;const{proxy:a}=p(),r=s(),o=s(JSON.parse(null!=(t=localStorage.getItem("dockerMirrorTableColumn"))?t:"[]")||[]),{refs:{mirrorTableData:n},getMList:i}=T(),{refs:{mainHeight:h}}=d(),P=l({selectList:[]}),S=s("");c("mirrorRowData",(()=>n.value.rowData)),c("selectList",(()=>P.selectList));const L=s([{label:"批量删除",value:"delete",event:()=>{}}]),w=s([{active:!0,content:a.$t("Docker.stashPull"),event:()=>{b()}},{active:!1,content:a.$t("Docker.importMirror"),event:()=>{v()}},{active:!1,content:a.$t("Docker.buildMirror"),event:()=>{j()}},{active:!1,content:"线上镜像",event:()=>{x()}},{active:!1,content:a.$t("Docker.clearMirror"),event:async()=>{D()}}]);let $=[],B=!1,E=0;const M=l({isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>u("span",{class:0!==$.length||B?$.includes(e.id)?"text-primary":"text-danger":"text-warning"},(()=>{if(0!==$.length||B){let t=$.includes(e.id)?"执行成功":"执行失败";return E++,t}return"等待执行"})())}}),N=async e=>{const t={id:e.id,name:e.name,force:"0"};try{await a.$confirm({type:"calc",title:"删除镜像【".concat(e.name,"】"),width:"35rem",message:"您真的要删除镜像【".concat(e.name,"】吗？")});const{data:r}=await C({data:JSON.stringify(t)});r.status?(a.$message.success(r.msg),i()):a.$message.error(r.msg)}catch(r){}},H=e=>{k(e)},z=e=>{_(e)},I=async({id:e,name:t})=>{try{const a={id:e,name:t,force:"0"},{data:r}=await C({data:JSON.stringify(a)});return r.status?($.push(e),r):Promise.reject(r)}catch(a){return Promise.reject(!1)}},J=f({pushDataEvent:H,exportDataEvent:z,deleteDataEvent:N});return m((async()=>{i(),J.value=g(o.value,J.value)})),{__sfc:!0,vm:a,Table:r,dockerMirrorTableColumnLocal:o,mirrorTableData:n,getMList:i,mainHeight:h,select:P,batchType:S,tableBatchData:L,tableBtnGroup:w,list:$,isComplete:B,index:E,batchConfig:M,batchEvent:(e,t,a)=>{if("delete"===e)return I(t)},handleBathComplete:e=>{B=!0,i()},changePageLimit:e=>{n.value.limit=e,n.value.p=1,i("page")},changePageSize:e=>{n.value.p=e,i("page")},deleteDataEvent:N,pushDataEvent:H,exportDataEvent:z,batchDeleteData:I,handleBatch:e=>{B=!1,$=[],E=0;let t=[];if("delete"===e)t=["删除","彻底失去访问和操作权限"];S.value=e,M.isRecurrence=!0,M.describe.th="镜像名",M.describe.title="批量".concat(t[0],"镜像"),M.describe.message="批量".concat(t[0],"已选的镜像，是否继续操作！")},handleSelectionChange:e=>{P.selectList=e},tableColumn:J,NPSDialog:y}}}),(function(){var i=this,s=i._self._c,l=i._self._setupProxy;return s("div",{staticClass:"relative"},[s(n,{scopedSlots:i._u([{key:"header-left",fn:function(){return[s("div",{staticClass:"flex items-center"},[s(o,{attrs:{group:l.tableBtnGroup}}),s("a",{staticClass:"cursor-pointer ml-[1rem] text-[#20a53a] hover:text-[#1d9534]",on:{click:function(e){return l.NPSDialog()}}},[i._v("需求反馈")])],1)]},proxy:!0},{key:"header-right",fn:function(){return[s(r,{attrs:{name:"dockerMirrorTableColumn",column:l.tableColumn}})]},proxy:!0},{key:"content",fn:function(){return[s(a,{directives:[{name:"loading",rawName:"v-loading",value:l.mirrorTableData.loading,expression:"mirrorTableData.loading"}],key:"ImageTable",ref:"Table",attrs:{column:l.tableColumn,"max-height":l.mainHeight-220,data:l.mirrorTableData.showList,description:"镜像列表为空","element-loading-text":"正在加载镜像列表，请稍后..."},on:{"selection-change":l.handleSelectionChange}})]},proxy:!0},{key:"footer-left",fn:function(){return[s(t,{attrs:{data:l.tableBatchData,config:l.batchConfig,"batch-fn":l.batchEvent},on:{"handle-batch":l.handleBatch,"handle-complete":l.handleBathComplete}})]},proxy:!0},{key:"footer-right",fn:function(){return[s(e,{attrs:{total:l.mirrorTableData.total,"current-page":l.mirrorTableData.p,"page-size":l.mirrorTableData.limit},on:{"update:currentPage":function(e){return i.$set(l.mirrorTableData,"p",e)},"update:current-page":function(e){return i.$set(l.mirrorTableData,"p",e)},"size-change":l.changePageLimit,"current-change":l.changePageSize}})]},proxy:!0},{key:"popup",fn:function(){},proxy:!0}])})],1)}),[],!1,null,"59953820",null,null).exports;export{P as default};
