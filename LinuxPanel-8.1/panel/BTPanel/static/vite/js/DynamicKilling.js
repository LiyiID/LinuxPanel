import{_ as t}from"./index120.js?v=1714377894636";import{n as e,q as a,b as s}from"./main.js?v=1714377894636";import{_ as o}from"./index39.js?v=1714377894636";import{_ as i}from"./index55.js?v=1714377894636";import{_ as r}from"./index46.js?v=1714377894636";import{L as l}from"./element-lib.js?v=1714377894636";import"./index45.js?v=1714377894636";import{_ as n}from"./index59.js?v=1714377894636";import{e as c,b as p,h as m,j as u}from"./vue-lib.js?v=1714377894636";import{b as d,e as f}from"./index38.js?v=1714377894636";import{eI as h,eJ as y,al as v,eK as w,eL as x,ai as g}from"./site.store.js?v=1714377894636";import{r as _}from"./firewall.popup.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";import"./check.js?v=1714377894636";const j=e(c({__name:"DynamicKilling",props:{compData:{default:{}}},setup(t){const e=t,{proxy:a}=u(),s=p([]),o=p(!1),i=p(""),r=p(!1),l=p({}),n=p(!1),c=async()=>{try{const t=await h({path:"/www/wwwroot/"+e.compData.name});n.value=t.data.is_run}catch(t){}},j=async()=>{o.value=!0;try{const t=await w({path:"/www/wwwroot/"+e.compData.name+"/"});s.value=t.data}catch(t){}o.value=!1},b=async t=>{try{await a.$confirm({title:"删除文件",message:"是否要删除关联的源文件?",type:"checkConfirm",icon:"warning",checkText:"源文件",checkEvent:async e=>{let s=a.$load("正在删除文件中，请稍后..."),o="";e&&(o="delete");const i=await x({data:JSON.stringify({path:t.path,md5:t.md5,type:o})});a.$message.request(i),j(),s.close()}})}catch(e){}},k=p([{label:"隔离时间",prop:"time"},d(),f([{onClick:async t=>{try{l.value=t;const e=await g({path:t.path});if(!e.data.status)return a.$message.request(e),!1;i.value=e.data.data||e.data.msg,r.value=!0}catch(e){i.value=""}},title:"样本文件"},{onClick:b,title:"删除"}])]);return m((()=>{c(),j()})),{__sfc:!0,props:e,vm:a,tableData:s,tableLoading:o,editorValue:i,editorPopup:r,rowData:l,onShellStatus:n,checkMessage:c,onChangeSpywareDetection:async t=>{let s=a.$load("正在设置中，请稍后...");try{const s=await y(!t,{path:"/www/wwwroot/"+e.compData.name});a.$message.request(s)}catch(o){}finally{s.close()}},saveFile:async()=>{let t=a.$load("正在保存文件中，请稍后...");try{const t=await v({path:l.value.path,data:i.value,encoding:"utf-8"});a.$message.request(t)}catch(e){}finally{t.close()}},getList:j,delEvent:b,tableColumns:k,spywareWhiteListDialog:_}}}),(function(){var e=this,c=e._self._c,p=e._self._setupProxy;return c("div",{staticClass:"py-20x"},[c(n,{scopedSlots:e._u([{key:"header-left",fn:function(){return[c("div",{staticClass:"flex items-center"},[c(a,{attrs:{type:"default"},on:{click:p.spywareWhiteListDialog}},[e._v("白名单")]),c(l,{attrs:{direction:"vertical"}}),c("div",{staticClass:"mr-8x"},[e._v("动态查杀站点")]),c("div",[c(r,{attrs:{width:36},on:{change:p.onChangeSpywareDetection},model:{value:p.onShellStatus,callback:function(t){p.onShellStatus=t},expression:"onShellStatus"}})],1)],1)]},proxy:!0},{key:"header-right",fn:function(){return[c(i,{attrs:{refresh:p.getList}})]},proxy:!0},{key:"content",fn:function(){return[c(o,{directives:[{name:"loading",rawName:"v-loading",value:p.tableLoading,expression:"tableLoading"}],attrs:{column:p.tableColumns,height:"400",data:p.tableData}})]},proxy:!0},{key:"footer-left",fn:function(){return[c("ul",{staticClass:"mt-8x leading-8 text-[1.2rem] list-disc ml-20x"},[c("li",[e._v("注意：隔离文件后的数字表示隔离文件总数。")]),c("li",{staticClass:"text-orange"},[e._v(" 动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离 ")])])]},proxy:!0},{key:"footer-right",fn:function(){},proxy:!0},{key:"popup",fn:function(){return[c(s,{attrs:{title:"在线编辑",showFooter:"",visible:p.editorPopup,area:70},on:{"update:visible":function(t){p.editorPopup=t},confirm:p.saveFile}},[c("div",{staticClass:"p-20x"},[c(t,{staticClass:"!h-[40rem]",model:{value:p.editorValue,callback:function(t){p.editorValue=t},expression:"editorValue"}})],1)])]},proxy:!0}])})],1)}),[],!1,null,"1f69f3c4",null,null).exports;export{j as default};
