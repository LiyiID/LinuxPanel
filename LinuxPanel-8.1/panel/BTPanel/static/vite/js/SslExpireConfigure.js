import{g as e,k as s,n as a,D as l}from"./main.js?v=1714377894636";import{w as r,x as i,o as t}from"./element-lib.js?v=1714377894636";import{_ as o}from"./index40.js?v=1714377894636";import{_ as u}from"./index46.js?v=1714377894636";import{e as p,b as n,h as c,j as m}from"./vue-lib.js?v=1714377894636";import{o as d}from"./confirm.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import{g as f}from"./site.store.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./config.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";import"./check.js?v=1714377894636";const g=a(p({__name:"SslExpireConfigure",props:{compData:{default:{cycle:""}}},setup(a,{expose:l}){const r=a,{proxy:i}=m(),{refs:{siteInfo:t,sslInfo:o},getSslInfoConfig:u}=f(),{refs:{checkedLoad:p}}=e(),g=n(),v=n(!1),x=n({cycle:[{required:!0,message:"请输入证书到期提示时间",trigger:["blur","change"]},{validator:(e,s,a)=>{/^[1-9]\d*$/.test(s)?a():a(new Error("请输入大于0的整数"))},trigger:["blur","change","input"]}],push:[{required:!0,message:"请选择通知方式",trigger:["blur","change"]}]}),h=n({id:0,dueAlarm:!1,domainName:"",cycle:1,allSsl:!1,push:[]}),b=()=>{try{h.value.domainName=t.value.name,h.value.cycle=r.compData.cycle,o.value.push&&(o.value.push.status,1)&&(h.value.cycle=o.value.push.cycle||1,h.value.push=o.value.push.module.split(",")||[],h.value.dueAlarm=o.value.push.status,h.value.id=o.value.push.id||(new Date).getTime()),"all"===r.compData.project&&r.compData.status&&(h.value.allSsl=!0)}catch(e){}},C=()=>({name:"site_push",id:h.value.id,data:JSON.stringify({status:h.value.dueAlarm,type:"ssl",project:h.value.allSsl?"all":t.value.name,cycle:parseInt(h.value.cycle),title:"网站SSL到期提醒",module:h.value.push.join(","),interval:600,push_count:parseInt(h.value.cycle)})}),_=()=>{d({$refs:g.value,loading:v,request:async()=>{const e=C(),a=await s(e);i.$message.request(a),u(),i.$emit("close")}})};return c((()=>{b()})),l({onConfirm:_}),{__sfc:!0,props:r,vm:i,siteInfo:t,sslInfo:o,getSslInfoConfig:u,checkedLoad:p,sslExpire:g,formDisabled:v,rules:x,expireConfigure:h,mergeConfig:b,getParams:C,onConfirm:_}}}),(function(){var e=this,s=e._self._c,a=e._self._setupProxy;return s("div",{staticClass:"p-16x"},[s(r,{directives:[{name:"bt-loading",rawName:"v-bt-loading",value:a.checkedLoad,expression:"checkedLoad"}],ref:"sslExpire",attrs:{disabled:a.formDisabled,rules:a.rules,model:a.expireConfigure,"label-width":"100px"}},[s(i,{attrs:{label:"到期提醒"}},[s(u,{model:{value:a.expireConfigure.dueAlarm,callback:function(s){e.$set(a.expireConfigure,"dueAlarm",s)},expression:"expireConfigure.dueAlarm"}})],1),s(i,{attrs:{label:"设置站点"}},[s(t,{staticClass:"!w-[28rem]",attrs:{disabled:""},model:{value:a.expireConfigure.domainName,callback:function(s){e.$set(a.expireConfigure,"domainName",s)},expression:"expireConfigure.domainName"}})],1),s(i,{attrs:{label:"证书有效期",prop:"cycle"}},[s("div",{staticClass:"text-[1.2rem]"},[e._v(" 小于 "),s(t,{staticClass:"!w-[10rem]",attrs:{type:"number"},model:{value:a.expireConfigure.cycle,callback:function(s){e.$set(a.expireConfigure,"cycle",s)},expression:"expireConfigure.cycle"}}),e._v(" 天，将每天发送1次提醒。 ")],1)]),s(i,{attrs:{label:"通知方式",prop:"push"}},[s(o,{model:{value:a.expireConfigure.push,callback:function(s){e.$set(a.expireConfigure,"push",s)},expression:"expireConfigure.push"}})],1),s(i,{attrs:{label:"应用配置"}},[s(l,{attrs:{name:"type"},model:{value:a.expireConfigure.allSsl,callback:function(s){e.$set(a.expireConfigure,"allSsl",s)},expression:"expireConfigure.allSsl"}},[e._v(" 将当前配置应用到所有"),s("span",{staticClass:"text-danger"},[e._v("未设置过的站点")])])],1)],1)],1)}),[],!1,null,"100f5530",null,null).exports;export{g as default};
