System.register(["./vue-lib-legacy.js?v=1714377894636","./index-legacy46.js?v=1714377894636","./main-legacy.js?v=1714377894636","./firewall.popup-legacy.js?v=1714377894636","./check-legacy.js?v=1714377894636","./index-legacy38.js?v=1714377894636"],(function(e,t){"use strict";var n,r,l,a,i,o,p,s,u,c,d,f,b,m,v,k;return{setters:[function(e){n=e.v,r=e.b,l=e.H},function(e){a=e._},function(e){i=e.g,o=e.a,p=e.aL,s=e.aM,u=e.f,c=e.p},function(e){d=e.b,f=e.k},function(e){b=e.c},function(e){m=e.g,v=e.a,k=e.e}],execute:function(){var t=n({3306:"MySQL服务默认端口",888:"phpMyAdmin默认端口",22:"SSH远程服务",20:"FTP主动模式数据端口",21:"FTP协议默认端口","39000-40000":"FTP被动模端口范围","30000-40000":"FTP被动模端口范围",11211:"Memcached服务端口",873:"rsync数据同步服务",8888:"宝塔Linux面板默认端口"}),h=n({title:"标题",body:"网页内",keywords:"关键词",descriptions:"描述",title_update:"标题更新",keywords_update:"关键词更新",description_update:"描述更新",tail_hash_update:"尾部script代码块更新",title_hash_update:"头部head代码块更新"}),_=n({1:"全站扫描",2:"快速扫描",3:"单URL"}),y=(e("s",[{title:"高风险",value:0,class:"text-[#F50606]",name:"risk_high"},{title:"中危",value:0,class:"text-[#FF9900]",name:"risk_mod"},{title:"低危",value:0,class:"text-[#DDC400]",name:"risk_low"},{title:"网站数量",value:0,class:"text-[#333]",name:"site_count"},{title:"告警次数",value:0,class:"text-[#333]",name:"risk_count"}]),i().refs),g=y.authType,w=y.tencentDataG,C=(y.tencentCVM,y.panelType);e("u",(function(e){var n=e.updatePolicy,a=e.updataEvent,i=e.deleteRow,p=e.showPortDetails,s=e.openTencentPort;return r([m(),{label:"协议",prop:"protocol"},{label:"端口",prop:"ports",width:300,render:function(e,n){e.brief=t[e.ports]||e.brief;var r=e.type||"";return l("div",[l("span",{class:"mr-[1rem]"},[e.ports]),"tencent"!=r&&Object.keys(w).length>0&&C.value.includes("tencent")?l(o,{on:{click:function(){s(e)}}},["点击放行，腾讯轻量云防火墙端口"]):""])}},{label:"状态",renderHeader:function(){return l("div",[l("span",["状态"]),l(o,{class:"ml-4x bt-ico-ask",on:{click:function(){window.open("https://www.bt.cn/bbs/thread-4708-1-1.html")}}},["?"])])},prop:"status",render:function(e,t){return l("div",[l("span",[0===e.status?"未使用":1===e.status?"外网不通":"正常"]),l(o,{class:2!==e.status?"!hidden":"",on:{click:function(){p(e)}}},["（详情）"])])}},{label:"策略",prop:"types",render:function(e,t){return l(o,{attrs:{type:"accept"===e.types?"primary":"danger"},on:{click:function(){n(e)}}},["accept"==e.types?"允许":"拒绝"])}},{label:"来源",prop:"address",render:function(e,t){return l("div",[e.sid>0?l("span",{attrs:{title:e.domain}},[e.domain]):""===e.address?l("span",["所有IP"]):l("span",{attrs:{title:e.address}},[e.address])])}},{label:"备注",prop:"brief",render:function(e){return l("span",[t[e.ports]||e.brief])}},{label:"时间",prop:"addtime"},k([{onClick:a,title:"修改"},{onClick:i,title:"删除"}])])})),e("e",(function(e){var t=e.updatePolicy,n=e.updataEvent,a=e.deleteRow;return r([m(),{label:"IP地址",prop:"address"},{label:"IP归属地",prop:"area",render:function(e){if("ltd"!=g.value)return l(o,{on:{click:function(){c({sourceId:116})}}},["点击查看"]);var t=e.area;return l("span",[(t.continent||"")+(t.info||"--")])}},{label:"策略",prop:"types",render:function(e){return l(o,{attrs:{type:"accept"===e.types?"primary":"danger"},on:{click:function(){t(e)}}},["accept"==e.types?"放行":"屏蔽"])}},{label:"备注",prop:"brief"},{label:"时间",prop:"addtime"},k([{onClick:n,title:"修改"},{onClick:a,title:"删除"}])])})),e("f",(function(e){var t=e.updataEvent,n=e.deleteRow;return r([m(),{label:"协议",prop:"protocol"},{label:"源端口",prop:"start_port"},{label:"目标IP",prop:"ended_ip",render:function(e){return""==e.ended_ip&&(e.ended_ip="127.0.0.1"),l("span",[e.ended_ip])}},{label:"目标端口",prop:"ended_port"},{label:"时间",prop:"addtime"},k([{onClick:t,title:"修改"},{onClick:n,title:"删除"}])])})),e("g",(function(e){var t=e.updataEvent,n=e.deleteRow;return r([m(),{label:"地区",prop:"country",render:function(e){return l("span",[e.country+"("+e.brief+")"])}},{label:"策略",prop:"types",render:function(e){return l(o,{attrs:{type:"accept"===e.types?"primary":"danger"},class:"cursor-default"},["accept"==e.types?"放行":"屏蔽"])}},{label:"端口",prop:"ports",render:function(e){return l("span",[e.ports?e.ports:"全部"])}},{label:"时间",prop:"addtime"},k([{onClick:t,title:"修改"},{onClick:n,title:"删除"}])])})),e("o",(function(e){var t=e.changeIpStatus;return r([{label:"IP地址:端口",prop:"address",render:function(e){return l(o,{on:{click:function(){return t(e)}},class:e.deny_status?"!text-[#999] line-through":""},[e.address,":",l("span",{class:"text-[#666] cursor-default !no-underline"},e.port)])}},{label:"归属地",prop:"area",render:function(e){var t=e.area;return l("span",[t.info||"--"])}},{label:"用户",prop:"user"},{label:"状态",prop:"status",render:function(e,t){return l(o,{props:{type:e.status?"primary":"danger"}},e.status?"登录成功":"登录失败")}},{label:"操作时间",prop:"time"}])})),e("p",(function(e){var t=e.changeStatus,n=e.setPsEvent,a=e.scanRow,i=e.deleteRow;return r([m(),{label:"目录",prop:"path"},v({prop:"open",event:t,data:["已停止","运行中"]}),{label:"备注",prop:"ps",minWidth:200,isCustom:!0,render:function(e){var t,r={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e.ps=null===(t=e.ps)||void 0===t?void 0:t.replace(/&(lt|gt|nbsp|amp|quot);/gi,(function(e,t){return r[t]})),l("input",{attrs:{type:"text",placeholder:"点击编辑备注"},domProps:{value:e.ps},class:"bt-table-input w-full",on:{blur:function(t){if(e.ps===t.target.value)return!1;e.ps=t.target.value,n(e)}}})}},k([{onClick:a,title:"扫描"},{onClick:i,title:"删除"}])])})),e("a",(function(e){var t=e.showRiskDetails;return r([{label:"巡检时间",prop:"time",render:function(e){var t=b(e.time,"number",0);return l("span",[u(t)])}},{label:"检测域名",prop:"site_name"},{label:"检测方式",prop:"method",render:function(e){return _[e.method]}},{label:"检测页面数",prop:"scans"},{label:"巡检结果",render:function(e){return[0===e.risks?l("span",{class:"text-[#20a53a]"},["无风险 "]):l(o,{attrs:{type:"danger"},on:{click:function(){t(e)}}},[e.risks])]}}])})),e("b",(function(e){var t=e.showFileEvent;return r([{label:"巡检时间",prop:"time",width:"150px",render:function(e){var t=b(e.time,"number",0);return l("span",[u(t)])}},{label:"URL",prop:"url",render:function(e){return[l(o,{attrs:{title:e.url},on:{click:function(){window.open(e.url)}}},[e.url])]}},{label:"关键词",prop:"content",width:"200px",render:function(e){return l("span",{class:"flex"},[l("span",{class:"min-w-[13rem] flex-1",attrs:{title:e.content}},[e.content])])}},{label:"类型",prop:"risk_content",width:"200px",render:function(e){return l("span",[e.risk_content])}},{label:"风险位置",prop:"risk_type",width:"150px",render:function(e){return l("span",[h[e.risk_type]])}},k([{onClick:t,title:"详情"}])])})),e("r",(function(e){var t=e.getScanEvent,n=e.updataRow,a=e.deleteRow;return r([{label:"监控名",prop:"name"},{label:"网站/URL",prop:"url"},{label:"监控方式",prop:"method",render:function(e){return l("span",[_[e.method]])}},{label:"上一次检测时间",prop:"last_scan_time",render:function(e){return[e.last_scan_time>0?l("span",[p(e.last_scan_time)]):l("span",["未检测"])]}},{label:"上一次风险",prop:"last_risk_count",render:function(e){return[e.last_risk_count>0?l(o,{attrs:{type:"danger"},on:{click:function(){d(e)}}},[e.last_risk_count]):l("span",["无风险"])]}},{label:"计划任务状态",prop:"crontab_status",render:function(e){return[1===e.crontab_status?l("span",["正常"]):l(o,{attrs:{type:"warning",title:"点击设置"},on:{click:function(){f(e)}}},["未设置"])]}},{label:"发送告警",prop:"send_msg",render:function(e){return l(o,{attrs:{type:1===e.send_msg?"primary":"warning"},on:{click:function(){n(e)}}},[1===e.send_msg?"已开启":"未开启"])}},{label:"检测频率",prop:"crontab_info",render:function(e){return e.crontab_info?e.crontab_info.cycle:e.crontab_info}},k([{onClick:t,title:"立即检测",width:70},{onClick:n,title:"编辑"},{onClick:a,title:"删除"}])])})),e("j",(function(e){var t=e.showHistoryDetails,n=e.openHistoryReport;return r([{label:"网站列表",prop:"site_name"},{label:"扫描URL总数",prop:"scans"},{label:"扫描耗时",prop:"time",render:function(e){return[e.end_time<=1||e.end_time-e.start_time<=0?l("span",["0秒"]):l("span",[s(e.end_time-e.start_time)])]}},{label:"风险次数",prop:"risks",render:function(e){return[0==e.risks?l("span",["无风险"]):l(o,{attrs:{type:"danger"},on:{click:function(){t(e)}}},[e.risks])]}},{label:"状态",prop:"status",render:function(e){return[0===e.is_status&&0===e.end_time||1===e.end_time?l("span",{class:"text-red"},["扫描未完成"]):1===e.is_status&&0===e.end_time?l("span",{class:"text-[#fc6d26]"},["扫描中"]):l("span",["扫描完成"])]}},{label:"扫描时间",prop:"start_time",render:function(e){var t=b(e.start_time,"number",0);return l("span",[u(t)])}},{label:"操作",align:"right",width:200,render:function(e){return[0===e.is_status&&0===e.end_time||1===e.end_time||1===e.is_status&&0===e.end_time?l("div",{class:"flex items-center justify-end"},[l("span",{class:"text-[#c8c9cc] cursor-not-allowed"},["扫描未完成"])]):l("div",{class:"flex items-center justify-end"},[l(o,{on:{click:function(){n(e)}}},["查看报告"])])]}}])})),e("c",(function(e){var t=e.changeIntrusion,n=e.changeOpen,i=e.getLogs;return r([{label:"用户",prop:"0"},{label:"总次数",prop:"4",render:function(e){return l("span",{class:e[4].totla>0?"!text-danger":""},e[4].totla)}},{label:"当日次数",prop:"4",render:function(e){return l("span",{class:e[4].day_totla>0?"!text-danger":""},e[4].day_totla)}},{label:"防入侵",prop:"3",render:function(e){return l(a,{props:{value:e[3],size:"mini",change:function(n){return t(e,n)}}})}},{label:"日志状态",prop:"5",render:function(e,t){return l(a,{props:{value:e[5],size:"mini",change:function(r){return n(e,t,r)}}})}},{label:"描述",prop:"6"},k([{onClick:i,title:"命令日志",width:70}])])})),e("z",(function(e){var t=e.deleteRow;return r([{label:"进程名",prop:"",render:function(e,t){return l("span",[e])}},k([{onClick:t,title:"删除"}])])})),e("A",(function(){return r([{label:"操作",prop:"log"},{label:"时间",prop:"addtime"}])})),e("d",(function(e){var t=e.changeOpen,n=e.updateRow;return r([{label:"名称",prop:"name"},{label:"描述",prop:"ps"},{label:"状态",prop:"open",render:function(e){return l(a,{props:{value:e.open,size:"mini",change:function(n){return t(e,n)}}})}},k([{onClick:n,title:"配置"}])])})),e("B",(function(e){var t=e.removeSshLimitEvent;return r([{label:"名称",prop:"address"},{label:"封锁时间",prop:"end",render:function(e){return 0==e.end?l("span","永久封禁"):l("span",s(e.end-e.start))}},k([{onClick:t,title:"立即解封",width:70}])])})),e("C",(function(){return r([{label:"时间",prop:"addtime"},{label:"详情",prop:"log"}])})),e("D",(function(e){var t=e.deleteRow;return r([{label:"IP地址",prop:"ip"},k([{onClick:t,title:"删除"}])])})),e("h",(function(e){var t=e.deleteRow;return r([m(),{label:"路径",prop:"path"},{label:"类型",prop:"typeTitle"},k([{onClick:t,title:"删除"}])])})),e("i",(function(e){var t=e.deleteRow;return r([{label:"关键词\t",prop:"0",render:function(e){return l("span",{class:"text-blue-500"},[e])}},k([{onClick:t,title:"删除"}])])})),e("t",(function(e){var t=e.setFileMonitor,n=e.lookSiteSafeLog,i=e.changeOpen;return r([{label:"网站名称",prop:"site_name"},{label:"防护状态",prop:"open",render:function(e){return l(a,{props:{value:e.open,change:function(t){return i(e.site_name,t)},size:"mini"}})}},{label:"今日触发",prop:"total.day_total"},{label:"触发总数",prop:"total.total"},{label:"PHP版本",prop:"version",render:function(e){return e.version.includes("不兼容")?l("span",{class:"!text-warning"},e.version):l("span",e.version)}},k([{onClick:t,title:"设置"},{onClick:n,title:"日志"}])])})),e("E",(function(){return r([{label:"路径",prop:"path",render:function(e){return l(o,e.path)}},{label:"类型",prop:"type",render:function(e){return"".concat("dir"===e.type?"文件夹":"文件")}},{label:"告警操作",render:function(e){var t=[];return parseInt(e.read)&&t.push("读取"),parseInt(e.del)&&t.push("写入"),parseInt(e.reit)&&(t.push("修改"),t.push("增加")),"".concat(t.join("/"))}}])})),e("v",(function(e){var t=e.fileEditorOpen,n=e.recycleBinRecover,r=e.recycleBinDelete;return[{label:"文件名",prop:"name"},{label:"原路径",prop:"dname",render:function(e){return l(o,{on:{click:function(){return t(e)}}},e.dname)}},{label:"被隔离时间",prop:"time",width:150,render:function(e){return l("span",{},u(e.time))}},k([{onClick:n,title:"恢复"},{onClick:r,title:"永久删除"}])]})),e("w",(function(e){var t=e.deleteWhite;return[{label:"起始IP",prop:"start",render:function(e){return l("span",{},e.at(0))}},{label:"结束IP",prop:"end",render:function(e){return l("span",{},e.at(1))}},k([{onClick:t,title:"删除"}])]})),e("x",(function(e){var t=e.deleteWhite;return[{label:"URL",render:function(e){return l("span",{},e)}},k([{onClick:t,title:"删除"}])]})),e("y",(function(e){var t=e.toggleState;return[{label:"版本",prop:"version"},{label:"站点数量",prop:"site_count"},{label:"防护状态",prop:"state",render:function(e){return l(a,{props:{value:1==e.state,change:function(n){return t(e,n)},size:"mini"}})}}]})),e("n",(function(e){var t=e.logEvent,n=e.setPassEvent,i=e.deleteEvent,o=e.changeStatusEvent;return r([{label:"用户名",render:function(e){return l("span",{},e[0])}},{label:"防入侵",width:100,render:function(e){return l(a,{props:{value:e[3],size:"mini",change:function(t){return o(t,e,3)}}})}},{label:"记录日志",width:100,render:function(e){return l(a,{props:{value:e[5],size:"mini",change:function(t){return o(t,e,5)}}})}},{label:"备注",render:function(e){return l("span",e[6])}},k([{onClick:t,title:"命令日志",width:70},{onClick:n,title:"重置密码",width:70},{onClick:i,title:"删除"}])])})),e("F",(function(e){var t=e.urlWhiteEvent,n=e.detailEvent,a=e.HttpEvent,i=e.addIpWhiteEvent;return r([{label:"时间",render:function(e){return l("span",{},u(e.addtime))}},{label:"用户IP",render:function(e){return l(o,{on:{click:function(){return i(e)}}},e.address)}},{label:"恶意类型",prop:"intercept"},{label:"URL地址",prop:"url"},k([{onClick:t,title:"URL加白",width:70},{onClick:n,title:"详情"},{onClick:a,title:"HTTP"}])])})),e("k",(function(e){var t=e.openFileEvent,n=e.falseAlarmEvent,l=e.deleteEvent;return r([m(),{label:"文件名",prop:"name",width:160},{label:"文件路径",prop:"path"},k([{onClick:n,title:"误报"},{onClick:t,title:"打开文件",width:70},{onClick:l,title:"删除"}])])})),e("q",(function(e){var t=e.optFileResult,n=e.getResultDetails;return r([{label:"所在目录",prop:"File"},{label:"描述",prop:"Describe"},{label:"状态",prop:"Status",render:function(e){return l("span",{class:1!==e.Status?"text-primary":"text-warning"},1!==e.Status?"正常":"异常")}},{label:"最后一次修改时间",prop:"Mtime"},k([{onClick:t,title:"已处理"},{onClick:n,title:"详情"}])])})),e("l",(function(e){var t=e.deleteRow;return r([{label:"所在目录",prop:"path"},k([{onClick:t,title:"删除",isHide:function(e){return["/bin/","/sbin/","/usr/bin/","/usr/sbin/"].includes(e.path)}}])])})),e("m",(function(e){var t=e.deleteRow;return r([{label:"应用类型",prop:"AppType"},{label:"来源",prop:"CidrBlock"},{label:"协议",prop:"Protocol"},{label:"端口",prop:"Port"},{label:"策略",prop:"Action",render:function(e,t){return l(o,{attrs:{type:"ACCEPT"===e.Action?"primary":"danger"}},["ACCEPT"==e.Action?"允许":"拒绝"])}},k([{onClick:t,title:"删除"}])])}))}}}));
