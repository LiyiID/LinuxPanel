import{_ as t}from"./index53.js?v=1714377894636";import{_ as e}from"./index39.js?v=1714377894636";import{n as a,q as s}from"./main.js?v=1714377894636";import{j as r}from"./element-lib.js?v=1714377894636";import{_ as o}from"./index85.js?v=1714377894636";import{_ as n}from"./index59.js?v=1714377894636";import{e as c,b as i,v as l,H as u,h as m,j as p}from"./vue-lib.js?v=1714377894636";import{X as d,Y as f}from"./site.popup.js?v=1714377894636";import{g,aI as h,aJ as j,aK as v}from"./site.store.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";import"./check.js?v=1714377894636";const b=a(c({__name:"index",setup(t){const{proxy:e}=p(),a=i(),s=i(""),{refs:{projectGroupData:r},getProjectGroup:o}=g(),n=i(""),c=i([{label:"停止项目组",value:"stop",event:()=>{}},{label:"删除项目组",value:"delete",event:()=>{}}]);let b=[],y=!1,x=0;const _=l({isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:t=>{var e;return u("span",{class:"block truncate "+(0!==b.length||y?(null==(e=b.find((e=>e.name===t.name)))?void 0:e.status)?"text-primary":"text-danger":"text-warning")},(()=>{var e;if(0!==b.length||y){let a=null==(e=b.find((e=>e.name===t.name)))?void 0:e.msg;return x++,a}return"等待执行"})())}}}),C=async t=>{try{const a=t.status?"停止":"开启";await e.$confirm({title:"".concat(a,"【").concat(t.name,"】项目组"),icon:"question",iconColor:"#E6A23C",message:"".concat(a,"项目组状态后，将依次").concat(a,"该项目组内的项目，是否继续操作？")}),r.value.loading=!0;const s=await j({group_name:t.name,status:t.status?"stop":"start"});if(r.value.loading=!1,t.status||s.status||-1===s.msg.indexOf("强制停止"))e.$message.request(s),s.status&&o();else{await e.$confirm({title:"提示",icon:"question",iconColor:"#E6A23C",message:s.msg});const a=await j({group_name:t.name,status:t.status?"stop":"start",force_stop:"Ture"});e.$message.request(a),a.status&&o()}}catch(a){}},G=async({name:t})=>{try{const e=await v({group_name:t});return b.push({name:t,msg:e.msg,status:e.status}),e.status?e:Promise.reject(e)}catch(e){return Promise.reject(!1)}},k=async({name:t})=>{try{const e=await j({group_name:t,status:"stop"});return b.push({name:t,msg:e.msg,status:e.status}),e.status?e:Promise.reject(e)}catch(e){return Promise.reject(!1)}},w=t=>{f(t)},D=async t=>{try{const a=await v({group_name:t.name});e.$message.request(a),a.status&&o()}catch(a){}},E=d({changeStatusEvent:C,editGroupEvent:w,deleteGroupEvent:D});return m((async()=>{o()})),{__sfc:!0,vm:e,Table:a,groupName:s,projectGroupData:r,getProjectGroup:o,batchType:n,tableBatchData:c,list:b,isComplete:y,index:x,batchConfig:_,addGroup:async()=>{if(""===s.value)return e.$message.error("请输入分组名");try{const t=e.$load("正在添加分组，请稍后..."),a=await h({group_name:s.value});t.close(),e.$message.request(a),a.status&&(o(),s.value="")}catch(t){}},batchEvent:(t,e,a)=>{switch(t){case"stop":return k(e);case"delete":return G(e)}},handleBathComplete:t=>{y=!0,o()},changeStatusEvent:C,batchDeleteData:G,batchStopData:k,handleBatch:t=>{y=!1,b=[],x=0;let e=[];switch(t){case"stop":e=["停止","停止项目组内的所有项目"];break;case"delete":e=["删除","彻底失去访问和操作权限"]}n.value=t,_.isRecurrence=!0,_.describe.th="分组名",_.describe.title="批量".concat(e[0],"项目组"),_.describe.message="批量".concat(e[0],"已选的项目组，是否继续操作！")},editGroupEvent:w,deleteGroupEvent:D,tableColumn:E}}}),(function(){var a=this,c=a._self._c,i=a._self._setupProxy;return c("div",{staticClass:"p-[2rem]"},[c(n,{scopedSlots:a._u([{key:"header-left",fn:function(){return[c("div",{staticClass:"flex items-center"},[c(o,{attrs:{placeholder:"请输入分组名"},model:{value:i.groupName,callback:function(t){i.groupName=t},expression:"groupName"}}),c(s,{staticClass:"!ml-[1rem]",on:{click:function(t){return i.addGroup()}}},[a._v("添加分组")])],1)]},proxy:!0},{key:"header-right",fn:function(){return[c(r,{staticClass:"item",attrs:{effect:"dark",content:"点击刷新数据",placement:"top-start"}},[c(s,{attrs:{type:"default",icon:"el-icon-refresh"},on:{click:i.getProjectGroup}})],1)]},proxy:!0},{key:"content",fn:function(){return[c(e,{directives:[{name:"loading",rawName:"v-loading",value:i.projectGroupData.loading,expression:"projectGroupData.loading"}],ref:"Table",attrs:{column:i.tableColumn,"max-height":340,data:i.projectGroupData.list,description:"项目组列表为空","element-loading-text":"正在加载分组列表，请稍后..."},on:{"selection-change":function(t){}}})]},proxy:!0},{key:"footer-left",fn:function(){return[c(t,{attrs:{data:i.tableBatchData,config:i.batchConfig,"batch-fn":i.batchEvent},on:{"handle-batch":i.handleBatch,"handle-complete":i.handleBathComplete}})]},proxy:!0},{key:"popup",fn:function(){},proxy:!0}])})],1)}),[],!1,null,"45c2f82f",null,null).exports;export{b as default};
