import{_ as a}from"./index85.js?v=1714377894636";import{L as s,w as e,x as t}from"./element-lib.js?v=1714377894636";import{a as l,n as o,q as r,b as i}from"./main.js?v=1714377894636";import{_ as n}from"./index39.js?v=1714377894636";import{_ as p}from"./index59.js?v=1714377894636";import"./index45.js?v=1714377894636";import{e as m,A as c,b as d,v as u,H as f,h as v,j as b}from"./vue-lib.js?v=1714377894636";import{m as y,ay as j,az as x,aA as _}from"./mysql.store.js?v=1714377894636";import{g}from"./index28.js?v=1714377894636";import{c as C}from"./check.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./index77.js?v=1714377894636";import"./index42.js?v=1714377894636";const h=o(m({__name:"ClassfySetting",props:{compData:{default:{}}},setup(a){const e=a,{proxy:t}=b(),{getDatabaseType:o}=y(),{mysqlData:r}=c(y()),{refs:{tabActive:i,tableParam:n}}=g(),p=d(!1),m=u({ps:"",id:0}),h=d(),D=d(!1),w=d(!1),k=d([{label:"分类名称",prop:"ps"},{label:"操作",align:"right",render:a=>a.id>=0?"不可操作":f("div",[f(l,{on:{click:()=>{m.id=a.id,m.ps=a.ps,D.value=!0}}},["编辑"]),f(s,{attrs:{direction:"vertical"}}),f(l,{on:{click:async()=>{try{await t.$confirm({title:"提示",icon:"warning",message:"确认删除该分类吗？该分类下的计划任务将会被移动至默认分类下，是否继续？"});const s=await j({id:a.id,db_type:i.value});t.$message.request(s),F(),e.compData.refreshEvent()}catch(s){}}}},["删除"])])}]),q=d([]),F=async()=>{var a,s;try{w.value=!0,await o(i.value),q.value=C("mysql"==i.value?r.value.typeList:n.value.serverList,"array",[]),""!==(null==(a=q.value[0])?void 0:a.id)&&(null==(s=q.value)||s.unshift({id:"",ps:"全部"})),w.value=!1}catch(e){}finally{w.value=!1}},L=()=>{m.id=0,m.ps=""};return v((()=>{F()})),{__sfc:!0,props:e,vm:t,getDatabaseType:o,mysqlData:r,tabActive:i,tableParam:n,formDisabled:p,classForm:m,crontabClassForm:h,addClassPopup:D,tableLoading:w,tableColumns:k,tableData:q,getClassfyList:F,addClassEvent:async()=>{let a,s;try{a=t.$load(t.$t("正在操作分类，请稍后...")),s=m.id?await _({...m,db_type:i.value}):await x({ps:m.ps,db_type:i.value}),L(),t.$message.request(s),D.value=!1,F()}catch(e){}finally{a&&a.close()}},onCancel:L}}}),(function(){var s=this,l=s._self._c,o=s._self._setupProxy;return l("div",{staticClass:"p-20x"},[l(p,{scopedSlots:s._u([{key:"header-left",fn:function(){return[l(r,{on:{click:function(a){o.addClassPopup=!0}}},[s._v("添加分类")])]},proxy:!0},{key:"content",fn:function(){return[l(n,{directives:[{name:"loading",rawName:"v-loading",value:o.tableLoading,expression:"tableLoading"}],attrs:{"max-height":400,column:o.tableColumns,data:o.tableData}})]},proxy:!0},{key:"popup",fn:function(){return[l(i,{attrs:{visible:o.addClassPopup,area:40,showFooter:"",title:"添加分类"},on:{"update:visible":function(a){o.addClassPopup=a},cancel:o.onCancel,confirm:o.addClassEvent}},[l("div",{staticClass:"p-20x"},[l(e,{ref:"crontabClassForm",attrs:{model:o.classForm,disabled:o.formDisabled}},[l(t,{attrs:{label:"分类名称",prop:"ps"}},[l(a,{attrs:{placeholder:"请输入分类名称"},model:{value:o.classForm.ps,callback:function(a){s.$set(o.classForm,"ps",a)},expression:"classForm.ps"}})],1)],1)],1)])]},proxy:!0}])})],1)}),[],!1,null,"5c37e16f",null,null).exports;export{h as default};
