import{_ as e}from"./index85.js?v=1714377894636";import{g as t,o as a,n as s,D as r,r as l}from"./main.js?v=1714377894636";import{w as o,x as i,q as n,s as m}from"./element-lib.js?v=1714377894636";import{_ as u}from"./index134.js?v=1714377894636";import{_ as c}from"./index41.js?v=1714377894636";import{b as p,e as v,w as h,h as y,j as w}from"./vue-lib.js?v=1714377894636";import{i as d}from"./locales-lib.js?v=1714377894636";import{m as b}from"./mysql.store.js?v=1714377894636";p([{title:"全部",key:"all"},{title:"数据库",key:"databases"},{title:"表",key:"tables"}]),p([{title:"服务器磁盘",key:"localhost"},{title:"阿里云OSS",key:"alioss"},{title:"腾讯云OSS",key:"txcos"},{title:"七牛云存储",key:"qiniu"},{title:"华为云存储",key:"obs"},{title:"百度云存储",key:"bos"},{title:"天翼云存储",key:"tianyiyun"}]);const x=p([{title:"不接收任何消息通知",key:0},{title:"任务执行失败接收通知",key:1}]);p([{value:"Synchronization",label:d.t("BtnGroup.Synchronization"),event:()=>{}},{value:"BackDatabase",label:d.t("BtnGroup.BackDatabase"),event:()=>{}},{value:"delete",label:d.t("BtnGroup.DeleteDatabase"),isRefBatch:!0,event:()=>{}}]);const f=s(v({__name:"AlertForm",props:{isCronTab:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},showKeyword:{type:Boolean,default:!1},showNotice:{type:Boolean,default:!0},needAll:{type:Boolean,default:!1}},setup(e,{expose:s}){const r=e,{proxy:l}=w(),{refs:{timeForm:o,noticeForm:i,msgData:n,timeFormRules:m},clearTimeForm:u}=t(),c=p(),{getMsgConfig:v}=b(),d=p(0);let f=p([{type:"day",text:"每天",showDay:!1,showHour:!0,showMinute:!0},{type:"day-n",text:"N天",showDay:!0,showHour:!0,showMinute:!0},{type:"hour",text:"每小时",showDay:!1,showHour:!1,showMinute:!0},{type:"hour-n",text:"N小时",showDay:!1,showHour:!0,showMinute:!0},{type:"minute-n",text:"N分钟",showDay:!1,showHour:!1,showMinute:!0},{type:"week",text:"每周",showDay:!1,showHour:!0,showMinute:!0},{type:"month",text:"每月",showDay:!0,showHour:!0,showMinute:!0}]);const F={where1:[{validator:(e,t,a)=>{"day-n"===o.value.type||"month"===o.value.type?Number.parseInt(t)>31||Number.parseInt(t)<1?a(new Error("请输入1-31的整数")):""===t?a(new Error("请输入天数")):a():a()},trigger:"blur"}],hour:[{validator:(e,t,a)=>{"minute-n"!==o.value.type&&"hour"!==o.value.type||a(),Number.parseInt(t)>23||Number.parseInt(t)<0?a(new Error("请输入0-23的整数")):""===t?a(new Error("请输入小时")):"hour-n"===o.value.type&&0===Number.parseInt(t)&&0===Number.parseInt(o.value.minute)?a(new Error("小时和分钟不能同时为0")):a()},trigger:"blur"}],minute:[{validator:(e,t,a)=>{Number.parseInt(t)>59||Number.parseInt(t)<0?a(new Error("请输入0-59的整数")):""===t?a(new Error("请输入分钟")):"hour-n"===o.value.type&&0===Number.parseInt(t)&&0===Number.parseInt(o.value.hour)?a(new Error("小时和分钟不能同时为0")):"minute-n"===o.value.type&&Number.parseInt(t)<1?a(new Error("请输入1-59的整数")):a()},trigger:"blur"}],timeSet:[{validator:(e,t,a)=>{"sweek"!==o.value.type||t.length?a():a(new Error("请选择时间"))},trigger:"change"}],specialHour:[{validator:(e,t,a)=>{"sweek"!==o.value.type||t.length?a():a(new Error("请选择小时"))},trigger:"change"}],specialMinute:[{validator:(e,t,a)=>{"sweek"!==o.value.type||t.length?a():a(new Error("请选择分钟"))},trigger:"change"}]},C=(e,t=!1)=>{r.isEdit||(i.value.notice=0,t&&u()),o.value.type=e,d.value=f.value.findIndex((t=>t.type===e)),"minute-n"===o.value.type&&(o.value.where1=o.value.minute),"hour-n"===o.value.type&&(o.value.where1=o.value.hour),c.value&&c.value.clearValidate()};return h((()=>{C(o.value.type)})),y((()=>{C(o.value.type,!0),r.isCronTab&&!a&&f.value.push({type:"sweek",text:"自定义",showDay:!1,showHour:!0,showMinute:!0})})),s({form:c}),{__sfc:!0,vm:l,props:r,timeForm:o,noticeForm:i,msgData:n,timeFormRules:m,clearTimeForm:u,form:c,getMsgConfig:v,cycleTime:d,timeType:f,rule:F,onGiveSelect:e=>{i.value.noticeChannel=e},timeTypeChange:e=>{c.value.clearValidate()},handleChange:e=>{i.value.notice=e,1===e&&(v(),i.value.noticeChannel="all")},handleTypeChange:C,noticeOptions:x,isRelease:a}}}),(function(){var t,a,s,p=this,v=p._self._c,h=p._self._setupProxy;return v("div",[v(o,{ref:"form",staticClass:"demo-form-inline",attrs:{rules:h.rule,inline:!0,model:h.timeForm}},[v(i,{staticClass:"!w-full"},[v(i,{attrs:{label:"执行周期"}},[v("div",{staticClass:"flex items-center"},[v(n,{staticClass:"w-[8rem] mr-4x",on:{change:function(e){return h.handleTypeChange(h.timeForm.type,!0)}},model:{value:h.timeForm.type,callback:function(e){p.$set(h.timeForm,"type",e)},expression:"timeForm.type"}},p._l(h.timeType,(function(e,t){return v(m,{key:t,attrs:{label:e.text,value:e.type}})})),1),p.isCronTab&&!h.isRelease&&"sweek"==h.timeForm.type?[v(n,{staticClass:"ml-8x mr-4x !w-[8rem]",on:{change:h.timeTypeChange},model:{value:h.timeForm.timeType,callback:function(e){p.$set(h.timeForm,"timeType",e)},expression:"timeForm.timeType"}},[v(m,{attrs:{label:"每天",value:"sday"}}),v(m,{attrs:{label:"每周",value:"sweek"}}),v(m,{attrs:{label:"每月",value:"smonth"}})],1),v(i,{staticClass:"el-form-item-item",attrs:{prop:"timeSet"}},["sweek"===h.timeForm.timeType?v(n,{staticClass:"ml-8x mr-4x !w-[20rem]",attrs:{multiple:""},model:{value:h.timeForm.timeSet,callback:function(e){p.$set(h.timeForm,"timeSet",e)},expression:"timeForm.timeSet"}},[v(m,{attrs:{label:"周一",value:"1"}}),v(m,{attrs:{label:"周二",value:"2"}}),v(m,{attrs:{label:"周三",value:"3"}}),v(m,{attrs:{label:"周四",value:"4"}}),v(m,{attrs:{label:"周五",value:"5"}}),v(m,{attrs:{label:"周六",value:"6"}}),v(m,{attrs:{label:"周日",value:"7"}})],1):p._e()],1),"smonth"===h.timeForm.timeType?v(i,{staticClass:"el-form-item-item",attrs:{prop:"timeSet"}},[v(n,{staticClass:"ml-8x mr-4x !w-[11rem]",attrs:{multiple:"","collapse-tags":""},model:{value:h.timeForm.timeSet,callback:function(e){p.$set(h.timeForm,"timeSet",e)},expression:"timeForm.timeSet"}},p._l(30,(function(e,t){return v(m,{key:e,attrs:{label:e,value:"".concat(e)}})})),1),v("span",[p._v("号")])],1):p._e(),v(i,{staticClass:"el-form-item-item",attrs:{prop:"specialHour"}},[v(n,{staticClass:"ml-8x mr-4x !w-[12rem]",attrs:{textType:"点",multiple:"","collapse-tags":""},model:{value:h.timeForm.specialHour,callback:function(e){p.$set(h.timeForm,"specialHour",e)},expression:"timeForm.specialHour"}},p._l(24,(function(e,t){return v(m,{key:t,attrs:{label:t,value:t}})})),1),v("span",[p._v("点")])],1),v(i,{staticClass:"el-form-item-item",attrs:{prop:"specialMinute"}},[v(n,{staticClass:"ml-8x mr-4x !w-[12rem]",attrs:{multiple:"","collapse-tags":""},model:{value:h.timeForm.specialMinute,callback:function(e){p.$set(h.timeForm,"specialMinute",e)},expression:"timeForm.specialMinute"}},[p._l(60,(function(e,t){return[t%5==0?v(m,{key:t,attrs:{label:t,value:t}}):p._e()]}))],2),v("span",[p._v("分")])],1)]:["week"==h.timeForm.type?v(i,{staticClass:"el-form-item-item"},[v(n,{staticClass:"ml-8x mr-4x !w-[8rem]",model:{value:h.timeForm.week,callback:function(e){p.$set(h.timeForm,"week",e)},expression:"timeForm.week"}},[v(m,{attrs:{label:"周一",value:"1"}}),v(m,{attrs:{label:"周二",value:"2"}}),v(m,{attrs:{label:"周三",value:"3"}}),v(m,{attrs:{label:"周四",value:"4"}}),v(m,{attrs:{label:"周五",value:"5"}}),v(m,{attrs:{label:"周六",value:"6"}}),v(m,{attrs:{label:"周日",value:"7"}})],1)],1):p._e(),v(i,{staticClass:"el-form-item-item",attrs:{prop:"where1"}},[(null==(t=h.timeType[h.cycleTime])?void 0:t.showDay)?v(e,{staticClass:"mr-4x ml-8x",attrs:{min:1,width:"9.2rem",textType:"天",type:"number"},model:{value:h.timeForm.where1,callback:function(e){p.$set(h.timeForm,"where1",e)},expression:"timeForm.where1"}}):p._e()],1),v(i,{staticClass:"el-form-item-item",attrs:{prop:"hour"}},[(null==(a=h.timeType[h.cycleTime])?void 0:a.showHour)?v(e,{staticClass:"mr-4x ml-8x",attrs:{width:"10rem",textType:"小时",max:"23",min:"0",type:"number"},model:{value:h.timeForm.hour,callback:function(e){p.$set(h.timeForm,"hour",e)},expression:"timeForm.hour"}}):p._e()],1),v(i,{staticClass:"el-form-item-item",attrs:{prop:"minute"}},[(null==(s=h.timeType[h.cycleTime])?void 0:s.showMinute)?v(e,{staticClass:"mr-4x ml-8x",attrs:{width:"10rem",textType:"分钟",max:"59",min:"0",type:"number"},model:{value:h.timeForm.minute,callback:function(e){p.$set(h.timeForm,"minute",e)},expression:"timeForm.minute"}}):p._e()],1)]],2)]),p.isCronTab&&!h.isRelease?v(i,{staticClass:"!mt-0",attrs:{label:" "}},[v("div",{staticClass:"flex items-center"},[v(r,{attrs:{disabled:p.isEdit},model:{value:h.noticeForm.flock,callback:function(e){p.$set(h.noticeForm,"flock",e)},expression:"noticeForm.flock"}},[p._v(" 开启进程锁")]),v(l,{attrs:{placement:"right-start",width:"440","popper-class":"white-tips-popover",trigger:"hover",content:""}},[v("div",{staticClass:"p-12x"},[v("span",{staticClass:"text-[#666]"},[p._v(" 在同一时间内只用一个进程在执行，若上一个进程未执行结束，下一次不执行 ")])]),v("i",{staticClass:"el-icon-question text-warning ml-12x",attrs:{slot:"reference"},slot:"reference"})])],1)]):p._e()],1),p.showNotice?v(i,{attrs:{label:"备份提醒",prop:"notice"}},[v("div",{staticClass:"flex items-center"},[v(c,{staticClass:"w-[20rem]",attrs:{options:h.noticeOptions,change:h.handleChange},model:{value:h.noticeForm.notice,callback:function(e){p.$set(h.noticeForm,"notice",e)},expression:"noticeForm.notice"}}),v(i,{directives:[{name:"show",rawName:"v-show",value:1===h.noticeForm.notice,expression:"noticeForm.notice === 1"}],attrs:{label:"消息通道"}},[v(u,{attrs:{needAll:p.needAll},on:{change:h.onGiveSelect},model:{value:h.noticeForm.noticeChannel,callback:function(e){p.$set(h.noticeForm,"noticeChannel",e)},expression:"noticeForm.noticeChannel"}})],1),h.isRelease?p._e():v(i,{directives:[{name:"show",rawName:"v-show",value:p.showKeyword&&1===h.noticeForm.notice,expression:"showKeyword && noticeForm.notice === 1"}],staticClass:"!mt-0",attrs:{label:"关键词匹配"}},[v("div",{staticClass:"flex items-center"},[v(l,{attrs:{placement:"top-start",width:"290","popper-class":"white-tips-popover",trigger:"focus",content:""}},[v("div",{staticClass:"p-12x"},[v("div",[p._v(" 1、在shell程序中不要"),v("span",{staticClass:"text-danger"},[p._v("中断")]),p._v("执行如（exit等） ")]),v("div",[p._v(" 2、输出"),v("span",{staticClass:"text-danger"},[p._v("关键词")]),p._v("（建议5位且程序中不会出现） ")]),v("div",[p._v("3、匹配到关键词"),v("span",{staticClass:"text-danger"},[p._v("发送告警")])])]),v(e,{staticClass:"mr-4x",attrs:{slot:"reference",disabled:p.isEdit,width:"16rem",placeholder:"请输入关键词",type:"text"},slot:"reference",model:{value:h.noticeForm.keyword,callback:function(e){p.$set(h.noticeForm,"keyword",e)},expression:"noticeForm.keyword"}})],1)],1)])],1)]):p._e()],1)],1)}),[],!1,null,"a00a6be7",null,null).exports;export{f as _};
