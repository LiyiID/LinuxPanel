import{w as e,u as t}from"./element-lib.js?v=1714377894636";import{a1 as s,aS as a,n as o,D as l,q as i}from"./main.js?v=1714377894636";import{_ as r}from"./index77.js?v=1714377894636";import{e as c,A as m,v as n,b as p,f as d,j as f}from"./vue-lib.js?v=1714377894636";import u from"./AddComposeTemplate.js?v=1714377894636";import{_ as h}from"./index39.js?v=1714377894636";import{_ as v}from"./index85.js?v=1714377894636";import{u as b}from"./docker.store.js?v=1714377894636";import{j}from"./docker.table.js?v=1714377894636";import{ac as x,ad as g}from"./docker.api.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./index42.js?v=1714377894636";import"./index120.js?v=1714377894636";import"./check.js?v=1714377894636";import"./index38.js?v=1714377894636";import"./index45.js?v=1714377894636";import"./element-ui.common.js?v=1714377894636";import"./date-util.js?v=1714377894636";import"./vdom.js?v=1714377894636";import"./index62.js?v=1714377894636";import"./cascader-panel.js?v=1714377894636";const _=o(c({__name:"SearchLocalTemplate",props:{compData:{default:()=>({})}},setup(e,{expose:t}){const o=e,{proxy:l}=f(),{fileSelectionPath:i}=m(s()),{getTList:r}=b(),c=n({path:"",checked:!1}),u=n({loading:!1,list:[],selection:[],historySearch:[],rowData:{},total:0}),h=j(),v=p(!1),_=p(),C=n({selectList:[]});d((()=>i.value),((e,t)=>{c.path=e}));const y=()=>{_.value.validate((async e=>{if(e){if(0===C.selectList.length)return void l.$message.error("请选择模板");const e=await g({data:JSON.stringify({template_list:C.selectList})});e.status?(l.$emit("close"),r(),l.$message.success(e.msg)):l.$message.error(e.msg)}}))};return t({confirm:y}),{__sfc:!0,vm:l,props:o,fileSelectionPath:i,getTList:r,cmdForm:c,tableData:u,tableColumn:h,more:v,cmdFormRef:_,cmdRules:{},select:C,openFile:()=>{a({type:"dir",change:e=>{c.path=e}})},search:async()=>{if(""===c.path)return l.$message.error("请选择路径"),!1;try{u.loading=!0;const e=await x({data:JSON.stringify({path:c.path,sub_dir:c.checked?"1":"0"})});u.list=e.data}catch(e){u.list=[]}finally{u.loading=!1}},handleSelectionChange:e=>{C.selectList=e},clearSpace:e=>{c.path=c.path.replace(/\s+/g,"")},confirm:y}}}),(function(){var t=this,s=t._self._c,a=t._self._setupProxy;return s("div",{staticClass:"container-dialog"},[s(e,{ref:"cmdFormRef",staticClass:"relative w-full",attrs:{size:"small",model:a.cmdForm,rules:a.cmdRules,"label-position":"right"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"flex items-center relative"},[s(v,{attrs:{width:"51rem","icon-type":"folder",placeholder:"请输入镜像路径"},on:{folder:a.openFile,"&change":function(e){return a.clearSpace("path")}},model:{value:a.cmdForm.path,callback:function(e){t.$set(a.cmdForm,"path",e)},expression:"cmdForm.path"}}),s(l,{staticClass:"!absolute top-[.4rem] left-[36rem]",model:{value:a.cmdForm.checked,callback:function(e){t.$set(a.cmdForm,"checked",e)},expression:"cmdForm.checked"}},[t._v("包含子目录")]),s(i,{staticClass:"!ml-[1.5rem]",attrs:{type:"primary"},on:{click:a.search}},[t._v("搜索")])],1),s("div",{staticClass:"table w-full mt-[1rem]"},[s(h,{directives:[{name:"loading",rawName:"v-loading",value:a.tableData.loading,expression:"tableData.loading"}],ref:"ftpTable",attrs:{column:a.tableColumn,height:"33rem",data:a.tableData.list,description:"模板列表为空","element-loading-text":"正在加载模板列表，请稍后..."},on:{"selection-change":a.handleSelectionChange}})],1),s("div",{staticClass:"pl-[2rem]"},[s("ul",{staticClass:"help-info-text c7 list-disc text-[#ff0000] mt-[1.5rem]"},[s("li",[t._v("选中需要添加的Compose 【已选中："+t._s(a.select.selectList.length)+"个】")])])])])],1)}),[],!1,null,"4b9921de",null,null).exports;const C=o(c({__name:"index",setup(e,{expose:t}){const{proxy:s}=f(),a=p("first"),o=p(),l=p(),i=async()=>{try{"first"==a.value?o.value.onConfirm():l.value.confirm()}catch(e){}};return t({onConfirm:i}),{__sfc:!0,vm:s,tabActive:a,first:o,second:l,onConfirm:i,close:()=>{s.$emit("close")},AddComposeTemplate:u,SearchLocalTemplate:_}}}),(function(){var e=this._self._c,s=this._self._setupProxy;return e("div",{staticClass:"flex flex-col p-16x lib-box"},[e(r,{attrs:{type:"navtwo"},model:{value:s.tabActive,callback:function(e){s.tabActive=e},expression:"tabActive"}},[e(t,{attrs:{label:"添加Compose模板",name:"first"}},[e(s.AddComposeTemplate,{ref:"first",on:{close:s.close}})],1),e(t,{attrs:{label:"搜索本地模板",name:"second"}},[e(s.SearchLocalTemplate,{ref:"second",on:{close:s.close}})],1)],1)],1)}),[],!1,null,"8c16759a",null,null).exports;export{C as default};
