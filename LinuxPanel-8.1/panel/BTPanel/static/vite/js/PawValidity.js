import{g as t,f as e,n as s,a}from"./main.js?v=1714377894636";import{_ as o}from"./index40.js?v=1714377894636";import{w as i,x as r}from"./element-lib.js?v=1714377894636";import{_ as l}from"./index117.js?v=1714377894636";import{_ as n}from"./date-picker.js?v=1714377894636";import{e as p,b as m,v as c,c as u,j as d,l as f}from"./vue-lib.js?v=1714377894636";import{g as y,k as _,l as h}from"./ftp.store.js?v=1714377894636";import{o as b}from"./confirm.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./config.js?v=1714377894636";import"./radio-button.js?v=1714377894636";import"./date-util.js?v=1714377894636";const j=s(p({__name:"PawValidity",props:{compData:{default:()=>{}}},setup(s,{expose:a}){const o=s,{end_time:i,id:r,show:l}=o.compData,{getPushConfigInfo:n}=t(),{getFtpList:p}=y(),{proxy:j}=d(),g=m(),v=m(!1),F={disabledDate:t=>t.getTime()<Date.now(),shortcuts:[{text:"永久",onClick(t){t.$emit("pick",0),f((()=>{T()}))}}]},k=m(e(new Date,"yyyy-MM-dd")),w=c({status:"1",channel:[]}),x=m([{title:"仅发送通知",value:"1"},{title:"停用当前FTP账号",value:"2"},{title:"自动修改FTP密码并发送",value:"3"},{title:"不触发",value:"0"}]),C=u((()=>k.value===e(new Date,"yyyy-MM-dd")?"0"===i:k.value===e(new Date,"yyyy-MM-dd"))),T=()=>{const t=document.querySelector(".date .el-input__inner");t&&(t.value="永久")},D=async()=>{try{const{data:{channel:t,push_action:e}}=await _({id:r});w.channel=t.split(","),w.status=e}catch(t){}},P=async t=>{w.channel=w.channel.filter((t=>""!==t)),b({$refs:g.value,loading:{disable:v,text:"修改中..."},request:async()=>await h({id:JSON.stringify([r]),end_time:new Date(k.value).getTime()/1e3,push_action:w.status,channel:w.channel.join(",")}),complete:p})},M=async()=>{await D(),"0"===i?T():k.value=e(Number(i),"yyyy-MM-dd")};return a({onConfirm:P,onOpen:M}),{__sfc:!0,props:o,end_time:i,id:r,show:l,getPushConfigInfo:n,getFtpList:p,vm:j,updateFtpInfo:g,formDisabled:v,pickerOptions:F,datePicker:k,ftpForm:w,typeOptions:x,rule:{channel:[{type:"array",required:!0,message:"请至少选择一个告警方式",trigger:"change"}]},isTime:C,setTimeText:T,setConfigData:D,onConfirm:P,onOpen:M}}}),(function(){var t=this,e=t._self._c,s=t._self._setupProxy;return e("div",{staticClass:"container-dialog"},[e(i,{ref:"updateFtpInfo",class:s.isTime?"bt-custom-form":"bt-custom-form bt-custom-form1",style:"0"==s.ftpForm.status||s.isTime?"":"padding-left: 1rem",attrs:{rules:s.rule,disabled:s.formDisabled,model:s.ftpForm,"label-width":"8rem"}},[e(r,{class:s.isTime?"typeClass":"",attrs:{label:"密码有效期"}},[e(n,{staticClass:"date",attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":s.pickerOptions},model:{value:s.datePicker,callback:function(t){s.datePicker=t},expression:"datePicker"}})],1),s.isTime?t._e():[e(r,{attrs:{label:"到期动作"}},[e(l,{staticClass:"w-[35rem] radio",attrs:{type:"radio",options:s.typeOptions,size:"small"},model:{value:s.ftpForm.status,callback:function(e){t.$set(s.ftpForm,"status",e)},expression:"ftpForm.status"}})],1),"0"!==s.ftpForm.status&&"2"!==s.ftpForm.status?e(r,{attrs:{label:"告警方式",prop:"channel"}},[e(o,{staticClass:"w-[35rem]",model:{value:s.ftpForm.channel,callback:function(e){t.$set(s.ftpForm,"channel",e)},expression:"ftpForm.channel"}})],1):t._e()]],2),"0"===s.ftpForm.status||"2"===s.ftpForm.status||s.isTime?t._e():e("div",{staticClass:"tip"},[e("ul",[e("li",[t._v(" 点击配置后状态未更新，尝试点击【 "),e(a,{on:{click:s.getPushConfigInfo}},[t._v("手动刷新")]),t._v(" 】 ")],1)])])],1)}),[],!1,null,"c7ad20d0",null,null).exports;export{j as default};
