System.register(["./index-legacy51.js?v=1714377894636","./main-legacy.js?v=1714377894636","./element-lib-legacy.js?v=1714377894636","./progress-legacy.js?v=1714377894636","./vue-lib-legacy.js?v=1714377894636","./modulepreload-polyfill-legacy.js?v=1714377894636","./preload-helper-legacy.js?v=1714377894636","./request-lib-legacy.js?v=1714377894636","./__commonjsHelpers__-legacy.js?v=1714377894636","./locales-lib-legacy.js?v=1714377894636","./public-lib-legacy.js?v=1714377894636"],(function(e,t){"use strict";var s,a,n,i,r,c,l,o,m,d,u,g,p;return{setters:[function(e){s=e._},function(e){a=e.g,n=e.Q,i=e.n,r=e._,c=e.q},function(e){l=e.F,o=e.j},null,function(e){m=e.e,d=e.v,u=e.h,g=e.i,p=e.j},null,null,null,null,null,null],execute:function(){var t=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("section",{staticClass:"p-2rem"},["ltd"===a.authType?[t("div",{staticClass:"scanHead flex justify-between mb-2rem"},[t("div",{staticClass:"scanHead__left flex"},[t("div",{staticClass:"w-[8rem] h-[8rem]"},[a.scanParam.isFirst&&!a.scanParam.isScan?t(r,{staticClass:"w-full",attrs:{src:"/firewall/icon-safe-detect.svg"}}):t(l,{attrs:{type:"circle",percentage:a.scanParam.score,format:a.format,color:a.colors,width:80}})],1),t("div",{staticClass:"pt-[2rem] pl-2rem w-[40rem]"},[t("div",{staticClass:"text-[1.8rem] font-bold",domProps:{innerHTML:e._s(a.scanParam.title)}}),t("div",{staticClass:"text-[#666] mt-1rem"},[e._v(" "+e._s(a.scanParam.msg.length>35?a.scanParam.msg.substring(0,35)+"...":a.scanParam.msg)+" ")])])]),t("div",{staticClass:"scanHead__right pt-[2.6rem]"},[t(c,{attrs:{type:a.scanParam.btnObj.type,disabled:a.scanParam.btnObj.disabled},on:{click:a.scanDetectEvent}},[e._v(" "+e._s(a.scanParam.btnObj.text)+" ")])],1)]),t("div",{staticClass:"scanBody h-[50rem] overflow-auto"},e._l(a.scanParam.imageList,(function(s,n){return t("div",{key:n,staticClass:"bg-[#FCFCFC] mb-1rem",class:s.active?"active":""},[t("div",{staticClass:"scanBody__title flex justify-between cursor-pointer rounded-[0.4rem] px-[2rem] h-[3.5rem] leading-[3.5rem] text-[1.3rem]",on:{click:function(e){return a.titleClick(n)}}},[t(o,{staticClass:"item",attrs:{effect:"dark",content:s.name,placement:"top-start"}},[t("span",{staticClass:"text-[1.4rem] font-bold leading-[3.5rem]"},[e._v(e._s(s.name.length>50?s.name.substring(0,50)+"...":s.name))])]),a.scanParam.isEnd||a.scanParam.isScan?t("div",{staticClass:"flex"},[s.riskList&&s.riskList.length>0?[t("span",{staticClass:"text-danger"},[e._v("发现"+e._s(s.riskList.length)+"项风险")])]:s.noWarring||s.riskList?[t("span",{staticClass:"text-primary"},[e._v("无风险项")])]:[t("span",[e._v("检测中")])],t(r,{staticClass:"w-[1.6rem] ml-2rem",attrs:{src:"/firewall/arrow-down.svg"}})],2):e._e()],1),t("div",{staticClass:"scanBody__content mb-[2rem] mx-[2rem]"},e._l(s.riskList,(function(s,a){return t("div",{key:a,staticClass:"bg-[#ff00000a] text-[#666] py-1rem px-[1.5rem] mb-[0.8rem] rounded-[0.4rem]"},[t("div",{staticClass:"scanBody__content__title border-b border-[#ececec] pb-4x mb-4x"},[e._v(" "+e._s(s.msg)+" ")]),t("div",{staticClass:"scanBody__content__desc flex border-b border-[#ececec] pb-4x mb-4x"},[t("span",{staticClass:"w-[6rem] flex-shrink-0 inline-block"},[e._v("详情：")]),t("span",{domProps:{innerHTML:e._s(s.detail)}})]),t("div",{staticClass:"scanBody__content__repair flex"},[t("span",{staticClass:"w-[6rem] flex-shrink-0 inline-block"},[e._v("修复方案：")]),t("span",{domProps:{innerHTML:e._s(s.repair)}})])])})),0)])})),0)]:[t(s,{attrs:{data:a.productData}})]],2)};e("default",i(m({__name:"index",setup:function(e){var t=a().refs.authType,s=p().proxy,i=d({title:"容器安全一键检测-功能介绍",ps:"检测敏感信息、后门、漏洞、可疑操作等常见风险。",source:151,desc:["异常历史命令","敏感信息泄露","后门排查","容器逃逸"],tabImgs:[{title:"容器检测",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/docker/dockerContainerScan.png"}]}),r=d({title:"立即进行镜像检测,确保您的项目安全。",isFirst:!0,isScan:!1,isEnd:!1,iconType:"normal",detect:0,imageList:[],msg:"",btnObj:{text:"一键检测",type:"primary",disabled:!1},score:100,scanTime:0}),c=[],l=0,o=null,m=null,f=function(){m=n({route:"/ws_model",onMessage:b})},b=function(e,t){var s=JSON.parse(t.data);if(s.hasOwnProperty("image_list"))return r.imageList=s.image_list.map((function(e){return e.active=!1,e})),void(c=JSON.parse(JSON.stringify(s.image_list)));if(s.hasOwnProperty("end")){r.msg=s.msg,r.score=r.score-s.score;var a,n=r.imageList[l-1];1!=s.status&&(r.detect++,null==n.riskList&&(n.riskList=[]),null===(a=n.riskList)||void 0===a||a.push(s)),s.end&&l>0&&(void 0===n.riskList&&(n.noWarring=!0),_())}},_=function(){var e;l<r.imageList.length?(null===(e=m)||void 0===e||e.send({model_index:"btdocker",mod_name:"security",def_name:"image_safe_scan",image_id:r.imageList[l].id,ws_callback:"123"}),l++):(r.isScan=!1,r.isEnd=!0,r.imageList=r.imageList.sort((function(e,t){return e.noWarring?1:t.noWarring?-1:0})),clearInterval(o),v("end"))},v=function(e){switch(e){case"scan":r.title="正在检测镜像，请稍候...",r.isEnd=!1,r.btnObj.text="取消检测",r.btnObj.type="default";break;case"restart":r.title="立即进行镜像检测,确保您的项目安全。",r.btnObj.text="重新检测",r.btnObj.type="primary";break;case"end":var t="";t=0==r.detect?"未发现安全漏洞":'一共发现<span class="text-[#fc6d26]">'.concat(r.detect,"</span>项风险"),r.title="检测完成,"+t,r.msg="检测完成，共耗时"+r.scanTime+"秒",r.btnObj.text="重新检测",r.btnObj.type="primary"}},y=function(){r.title="立即进行镜像检测,确保您的项目安全。",r.msg="",r.isFirst=!0,r.isScan=!1,r.isEnd=!1,r.iconType="normal",r.detect=0,r.imageList=JSON.parse(JSON.stringify(c)),r.btnObj.text="一键检测",r.btnObj.type="primary",r.btnObj.disabled=!1,r.score=100},x=function(){var e;null===(e=m)||void 0===e||e.send({model_index:"btdocker",mod_name:"security",def_name:"get_image_list",ws_callback:"123"})};return u((function(){f(),x()})),g((function(){clearInterval(o)})),{__sfc:!0,authType:t,vm:s,productData:i,colors:[{color:"#ff0000",percentage:20},{color:"#ff0000",percentage:40},{color:"#fc6d26",percentage:60},{color:"#fc6d26",percentage:80},{color:"#20a53a",percentage:100}],scanParam:r,defaultImageList:c,currentIndex:l,timer:o,format:function(e){return e+"分"},titleClick:function(e){r.imageList[e].active=!r.imageList[e].active},useSocket:m,createWebSocket:f,onWSReceive:b,scanDetectEvent:function(){if(l=0,r.scanTime=0,r.detect=0,r.score=100,o=setInterval((function(){r.scanTime++}),1e3),r.isFirst){if(0==r.imageList.length)return s.$message.error("请先添加镜像");r.isScan||f(),_(),r.isScan=!0,r.isFirst=!1,v("scan")}else{var e;r.isScan?(null===(e=m)||void 0===e||e.close(),y()):(r.imageList=JSON.parse(JSON.stringify(c)),_(),r.isScan=!0,v("scan"))}},sendImageId:_,switchBtnStatus:v,resetData:y,getImageList:x}}}),t,[],!1,null,"9be6a9ae",null,null).exports)}}}));
