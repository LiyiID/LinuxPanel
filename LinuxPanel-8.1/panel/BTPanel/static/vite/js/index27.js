import{q as t,s as e,w as a,x as s,u as n}from"./element-lib.js?v=1714377894636";import{f as r,a as i,l,g as o,o as c,e as p,p as m,n as u,b as f}from"./main.js?v=1714377894636";import{_ as d}from"./index52.js?v=1714377894636";import{_}from"./index53.js?v=1714377894636";import{_ as h}from"./index39.js?v=1714377894636";import{_ as b}from"./index54.js?v=1714377894636";import{_ as v}from"./index56.js?v=1714377894636";import{_ as y}from"./index57.js?v=1714377894636";import g from"./index48.js?v=1714377894636";import{_ as T}from"./index45.js?v=1714377894636";import{_ as P}from"./index58.js?v=1714377894636";import{_ as F}from"./index59.js?v=1714377894636";import{_ as C}from"./index60.js?v=1714377894636";import{b as E,H as x,e as D,v as w,c as j,f as k,h as A,j as L,l as S}from"./vue-lib.js?v=1714377894636";import{g as V,a as I,e as R,d as O,b as $,s as B}from"./ftp.store.js?v=1714377894636";import{i as H}from"./locales-lib.js?v=1714377894636";import{g as q,h as z,a as N,i as Q,b as M,c as W,d as G,e as Z}from"./index38.js?v=1714377894636";import{_ as U}from"./preload-helper.js?v=1714377894636";import{a as J}from"./confirm.js?v=1714377894636";import{c as K}from"./check.js?v=1714377894636";import{_ as X}from"./index76.js?v=1714377894636";import{_ as Y}from"./index77.js?v=1714377894636";const tt=({deleteIpEvent:t})=>E([{label:"IP",prop:"0",render:t=>x("span",{class:"text-blue-500"},[t])},Z([{onClick:t,title:"删除"}])]),et=({maskIpEvent:t,deleteDataEvent:e,stopDataEvent:a,ignoreScanEvent:s})=>E([{label:"类型",prop:"type",minWidth:100},{label:"用户名",prop:"user",minWidth:60},{label:"IP",prop:"ip"},{label:"操作时间",prop:"time"},Z([{onClick:t,title:"IP拉黑",width:50},{onClick:e,title:"删除账号",width:60},{onClick:a,title:"停用账号",width:60},{onClick:s,title:"忽略"}])]),at=t=>l({isAsync:!0,title:"修改FTP用户【"+t.name+"】",area:50,btn:"保存",compData:t,component:()=>U((()=>import("./EditFtpPwd.js?v=1714377894636")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)}),st=t=>l({isAsync:!0,title:"快速连接",area:48,compData:t,component:()=>U((()=>import("./QuickConnect.js?v=1714377894636")),__vite__mapDeps([16,2,3,4,5,6,7,8,9,10,1,13]),import.meta.url)}),nt=t=>l({isAsync:!0,title:H.t("Ftp.FtpCapacityTitle",{name:t.name}),area:50,btn:!0,compData:t,component:()=>U((()=>import("./SetFtpCapacity.js?v=1714377894636")),__vite__mapDeps([17,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)}),rt=t=>l({isAsync:!0,title:"查看FTP日志-[".concat(t.name,"]"),area:[70,58],compData:t,component:()=>U((()=>import("./index74.js?v=1714377894636")),__vite__mapDeps([18,19,10,5,4,9,2,3,6,7,8,20,21]),import.meta.url)}),it=()=>l({isAsync:!0,title:"FTP日志扫描工具",area:[70,52],component:()=>U((()=>import("./index75.js?v=1714377894636")),__vite__mapDeps([22,23,10,5,4,9,2,3,6,7,8,24,13,14,15,25,11,12,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,20,19,21]),import.meta.url)}),lt=({type:t,form:e,refresh:a})=>l({isAsync:!0,title:"FTP日志".concat(t?"分析条件":"自动分析推送"),area:t?[66,30]:[70,42],btn:t?"立即扫描":"保存配置",component:()=>U((()=>import("./logAnalysisCondition.js?v=1714377894636")),__vite__mapDeps([43,2,3,4,5,6,7,8,9,10,44,45,15,11,46,47,48,25,1,49,50,51,52,53,54,12,13,26,27,28,23,24,29,30,31,14,32,33,34,35,36,37,38,39,40,41,42,20,19,21]),import.meta.url),compData:{type:!t,form:e,refresh:a}}),ot=t=>l({isAsync:!0,title:"FTP日志白名单",area:[70,45],component:()=>U((()=>import("./whiteTable.js?v=1714377894636")),__vite__mapDeps([55,23,10,5,4,9,2,3,6,7,8,24,1,14,15,13,25,11,12,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,20,19,21]),import.meta.url),compData:t}),ct=t=>l({isAsync:!0,title:"扫描触发条件",area:[50,34],btn:["保存","取消"],component:()=>U((()=>import("./setScanCondition.js?v=1714377894636")),__vite__mapDeps([56,1,2,3,4,5,6,7,8,9,10,11,57,58,48,25,12,59,13]),import.meta.url),compData:t});const pt=u(D({__name:"FtpView",setup(t){const{refs:{authType:e,mainHeight:a,pageSerachVal:s}}=o(),{refs:{ftpSetup:n,ftpTableData:u,ftpTableParam:f,isSearchClick:d},getFtpList:_,getFtpTypeList:h}=V(),{proxy:b}=L(),v=E(),y=E(!1),g=E(!1),T=E(!1),P=w({list:[]}),F=j((()=>{var t,e;return null==(e=K(null==(t=u.value)?void 0:t.typeList,"array",[]))?void 0:e.filter((t=>t.id>0))})),C=E(),D=w({allClassValue:""}),X=E([{name:"容量限制",ename:"ftp_capacity",callback:()=>{if(0===u.value.list.length)return b.$message.error("暂无FTP用户，请先添加FTP用户");d.value=!0,nt(u.value.list[0])}},{name:"FTP日志分析",ename:"ftp_log",callback:()=>{d.value=!0,it()}}]);k((()=>s.value),(t=>{f.value.search=s.value}));const Y=E([{active:!0,content:b.$t("Ftp.FtpAddButton"),event:()=>l({isAsync:!0,title:"添加FTP用户",area:50,btn:!0,component:()=>U((()=>import("./AddFtpData.js?v=1714377894636")),__vite__mapDeps([60,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,61,40]),import.meta.url)})},{content:b.$t("Ftp.FtpModifyButton"),event:()=>(async()=>l({isAsync:!0,title:H.t("Ftp.FtpModifyButton"),area:40,btn:!0,component:()=>U((()=>import("./EditFtpPort.js?v=1714377894636")),__vite__mapDeps([62,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,61,40]),import.meta.url)}))()},{content:"FTP日志分析",event:()=>{d.value=!1,it()}}]),tt=E([{label:"启用FTP",value:"start"},{label:"停用FTP",value:"stop"},{label:"改密FTP",value:"change",isRefBatch:!0},{label:"删除FTP",value:"delete"}]),et=async t=>{let{id:e,status:a,name:s}=t,n=Boolean(Number(a));J({confirm:{icon:"warning",title:(n?"停用":"启用")+"FTP用户【"+s+"】",width:"35rem",message:"".concat(n?"停用":"启用","选中的FTP用户后，该FTP用户将").concat(n?"失去":"恢复","访问权限，是否继续操作？")},loading:"正在设置FTP状态，请稍后...",request:async()=>await R({id:e,username:s,status:n?0:1}),complete:_})},lt=t=>{"ltd"===e.value?nt(t):m({sourceId:d.value?260:52})},ot=async({name:t,id:e})=>{J({confirm:{icon:"warning",title:"删除FTP用户【"+t+"】",message:"删除选中的FTP用户后，该FTP用户将彻底失去访问和操作权限，是否继续操作？"},loading:"正在删除FTP用户，请稍后...",request:async()=>await O({id:e,username:t}),complete:_})},ct=t=>{l({isAsync:!0,title:"设置密码有效期",area:46,btn:!0,compData:t,component:()=>U((()=>import("./PawValidity.js?v=1714377894636")),__vite__mapDeps([63,2,3,4,5,6,7,8,9,10,44,45,15,11,49,50,51,52,64,58,12,13,14]),import.meta.url)})},pt=async t=>{var e;l({isAsync:!0,title:"修改FTP权限配置-[".concat((e=t).name,"]"),area:70,btn:"保存",compData:e,component:()=>U((()=>import("./PermessionData.js?v=1714377894636")),__vite__mapDeps([65,66,4,5,2,3,6,7,8,9,10,11,46,47,12,35,58,25,13,14,15,40]),import.meta.url)})},mt=async t=>{let a;try{if("free"!==e.value){a=b.$load(b.$t("正在获取日志服务状态，请稍后..."));const{status:e,msg:s}=await $({exec_name:"getlog"});a.close(),e&&"stop"!==s?rt(t):J({confirm:{icon:"warning",title:"开启FTP日志服务",message:"开启FTP日志服务后，将记录FTP用户的访问日志，是否继续操作？"},loading:"正在开启日志服务，请稍后...",request:async()=>await $({exec_name:"start"}),async complete(){rt(t)}})}else m({sourceId:57})}catch(s){}finally{a&&a.close()}},ut=(({changeStatusEvent:t,setQuotaEvent:e,openQuickConnectEvent:a,openPawValidityEvent:s,editPasswordEvent:n,openLogEvent:l,deleteDataEvent:o,configureEvent:c})=>E([q(),{label:H.t("Username"),prop:"name",minWidth:100},z(),N({event:t,data:[H.t("Deactivated"),H.t("Enabled")]}),Q({label:"快速连接",minWidth:70,title:"复制快速连接信息",text:"点击查看",event:a}),M(),{label:"密码有效期",minWidth:84,isCustom:!0,title:"设置密码有效期",prop:"end_time",text:"永久",event:s,render:t=>{let e=(new Date).getTime()>1e3*Number(t.end_time);"0"===t.end_time&&(e=!1),(new Date).setHours(0,0,0,0);const a="0"!==t.end_time&&t.end_time-(new Date).getTime()/1e3<60480;return x(i,{on:{click:()=>s(t)},attrs:{title:"设置密码有效期"},style:e?"color:#ef0808":a?"color:#f0ad4e":""},["0"!==t.end_time?r(Number(t.end_time),"yyyy-MM-dd"):"永久"])}},W({event:e}),G({table:"ftps"}),Z([{onClick:c,title:H.t("Configure")},{onClick:n,title:"修改"},{onClick:l,title:H.t("Log")},{onClick:o,title:H.t("Delete")}])]))({changeStatusEvent:et,setQuotaEvent:lt,openQuickConnectEvent:st,openPawValidityEvent:ct,editPasswordEvent:at,openLogEvent:mt,deleteDataEvent:ot,configureEvent:pt});A((async()=>{await _()}));const ft=E(""),dt=E([]);let _t=[],ht=0;const bt=w({isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:t=>x("span",{class:0===_t.length?"text-warning":_t.includes(t.id)?"text-primary":"text-danger"},(()=>{if(0===_t.length)return"等待执行";{let e=_t.includes(t.id)?"执行成功":"执行失败";return ht===2*_t.length?(_t=[],ht=0):ht++,e}})())}}),vt=async({id:t,name:e})=>{try{const{data:a}=await R({id:t,username:e,status:1});return a.status&&_t.push(t),a}catch(a){}},yt=async({id:t,name:e})=>{try{const{data:a}=await R({id:t,username:e,status:0});return a.status&&_t.push(t),a}catch(a){}},gt=async({id:t,name:e})=>{try{const{data:a}=await O({id:t,username:e});return a.status&&_t.push(t),a}catch(a){}};return{__sfc:!0,authType:e,mainHeight:a,pageSerachVal:s,ftpSetup:n,ftpTableData:u,ftpTableParam:f,isSearchClick:d,getFtpList:_,getFtpTypeList:h,vm:b,ftpTable:v,showSearchHistory:y,hovering:g,classPopup:T,tableList:P,filteredTypeOptions:F,setClassFormRef:C,setClassForm:D,rules:{allClassValue:[{required:!0,message:"请选择分类",trigger:"change"}]},recomList:X,closeSearchHistory:()=>{S((()=>{y.value=!1}))},openInstall:async t=>{const{data:e}=await I({sName:t.name});if("-1"===e.task)return b.$message.error("当前插件正在安装，不可重复安装");p({name:e.name,type:e.type,pluginInfo:e})},tableBtnGroup:Y,tableBatchData:tt,searchValue:t=>{f.value.search=t},changePageLimit:t=>{f.value.limit=t,_()},changePageSize:t=>{f.value.p=t,_()},changeStatusEvent:et,setQuotaEvent:lt,deleteDataEvent:ot,openPawValidityEvent:ct,configureEvent:pt,openLogEvent:mt,openClassify:()=>{l({isAsync:!0,title:"分类设置",area:56,component:()=>U((()=>import("./ClassfySetting.js?v=1714377894636")),__vite__mapDeps([67,1,2,3,4,5,6,7,8,9,10,11,12,23,24,37,35,13]),import.meta.url)})},tableColumn:ut,batchType:ft,bathList:dt,list:_t,index:ht,batchConfig:bt,handleBatch:t=>{if("setClassify"==t)return void(T.value=!0);let e=[];switch(t){case"start":e=["启用","恢复访问权限"];break;case"stop":e=["停用","暂停访问权限"];break;case"change":e=["改密"];break;case"delete":e=["删除","彻底失去访问和操作权限"]}var a;ft.value=t,bt.isRecurrence=!0,bt.describe.th="FTP用户",bt.describe.title="批量".concat(e[0],"FTP用户"),bt.describe.message="批量".concat(e[0],"已选的FTP用户，").concat(e[0],"后").concat(e[1],"，是否继续操作！"),"change"===t&&(a=v.value.tableSelectList,l({isAsync:!0,title:"批量修改FTP用户密码",area:"auto",btn:!0,compData:a,component:()=>U((()=>import("./BatchFtpPwd.js?v=1714377894636")),__vite__mapDeps([68,1,2,3,4,5,6,7,8,9,10,11,23,24,49,50,51,52,12,41,42,13]),import.meta.url)}))},setAllClass:async()=>{C.value.validate((async t=>{if(t){let t=P.list.map((t=>t.name));try{const e=await B({ftp_names:t.join(","),id:D.allClassValue});b.$message.request(e),_(),T.value=!1}catch(e){}}}))},handleSelectionChange:t=>{P.list=t},batchEvent:(t,e,a)=>{switch(t){case"start":return vt(e);case"stop":return yt(e);case"delete":return gt(e)}},batchStartStatus:vt,batchStopStatus:yt,batchDeleteData:gt,isRelease:c}}}),(function(){var n=this,r=n._self._c,l=n._self._setupProxy;return r("div",{staticClass:"relative"},[r(C,{attrs:{visible:!l.ftpSetup,width:"28rem"}},[r("span",{staticClass:"ml-8x"},[n._v("未安装Pure-Ftpd")]),n._v("，"),r(i,{staticClass:"!font-bold !text-[1.4rem]",on:{click:function(t){return l.openInstall({name:"pureftpd"})}}},[n._v("立即安装")])],1),r(F,{scopedSlots:n._u([{key:"header-left",fn:function(){return[r("div",{staticClass:"flex items-center"},[r(P,{attrs:{group:l.tableBtnGroup}}),r(T),r(g,{attrs:{"plugin-name":"pureftpd","is-setup":l.ftpSetup}})],1)]},proxy:!0},{key:"header-right",fn:function(){return[l.isRelease?n._e():r(t,{staticClass:"mr-8x",attrs:{placeholder:"请选择分类"},on:{change:function(t){return l.getFtpList(!0)}},model:{value:l.ftpTableParam.id,callback:function(t){n.$set(l.ftpTableParam,"id",t)},expression:"ftpTableParam.id"}},[r("div",{staticClass:"max-h-[20rem] overflow-auto",class:{"no-hover":l.hovering}},n._l(l.ftpTableData.typeList,(function(t,a){return r(e,{key:a,attrs:{label:t.ps,value:t.id}})})),1),r("div",{staticClass:"classify-item",on:{click:l.openClassify,mouseover:function(t){l.hovering=!0},mouseout:function(t){l.hovering=!1}}},[n._v(" 分类设置 ")])]),r("div",{staticClass:"relative"},[r(y,{staticClass:"mr-12x",attrs:{placeholder:n.$t("FtpContent.FtpSearchPlaceHolder")},on:{focus:function(t){l.showSearchHistory=!0},blur:l.closeSearchHistory,clear:function(t){return l.getFtpList(!0)},search:function(t){return l.getFtpList(!0)}},model:{value:l.ftpTableParam.search,callback:function(t){n.$set(l.ftpTableParam,"search",t)},expression:"ftpTableParam.search"}}),r(v,{directives:[{name:"show",rawName:"v-show",value:l.showSearchHistory,expression:"showSearchHistory"}],attrs:{compData:{historySearch:l.ftpTableData.historySearch,recomList:l.recomList,name:"ftps",key:"ftps"}},on:{"updata:searchValue":l.searchValue}})],1),l.isRelease?r(b,{attrs:{name:"ftpTableColumn",column:l.tableColumn}}):r(b,{attrs:{name:"ftpTableColumn",column:l.tableColumn,"is-request":!l.isRelease}})]},proxy:!0},{key:"content",fn:function(){return[r(h,{directives:[{name:"loading",rawName:"v-loading",value:l.ftpTableData.loading,expression:"ftpTableData.loading"}],ref:"ftpTable",attrs:{column:l.tableColumn,data:l.ftpTableData.list,description:"FTP列表为空","max-height":l.mainHeight-276,"element-loading-text":"正在加载FTP列表，请稍后..."},on:{"selection-change":l.handleSelectionChange}})]},proxy:!0},{key:"footer-left",fn:function(){return[r(_,{attrs:{data:l.tableBatchData,config:l.batchConfig,"batch-fn":l.batchEvent},on:{"handle-batch":l.handleBatch,"handle-complete":l.getFtpList}})]},proxy:!0},{key:"footer-right",fn:function(){return[r(d,{attrs:{total:l.ftpTableData.total,"current-page":l.ftpTableParam.p,"page-size":l.ftpTableParam.limit},on:{"update:currentPage":function(t){return n.$set(l.ftpTableParam,"p",t)},"update:current-page":function(t){return n.$set(l.ftpTableParam,"p",t)},"size-change":l.changePageLimit,"current-change":l.changePageSize}})]},proxy:!0},{key:"popup",fn:function(){return[r(f,{attrs:{title:"设置FTP分类",showFooter:"",area:40,visible:l.classPopup},on:{"update:visible":function(t){l.classPopup=t},confirm:l.setAllClass}},[r(a,{ref:"setClassFormRef",staticClass:"p-[2rem]",attrs:{rules:l.rules,model:l.setClassForm}},[r(s,{attrs:{label:"FTP分类",prop:"allClassValue"}},[r(t,{staticClass:"w-[22rem]",attrs:{placeholder:"请选择您的分类"},model:{value:l.setClassForm.allClassValue,callback:function(t){n.$set(l.setClassForm,"allClassValue",t)},expression:"setClassForm.allClassValue"}},n._l(l.filteredTypeOptions,(function(t,a){return r(e,{key:a,attrs:{label:t.ps,value:t.id}})})),1)],1)],1)],1)]},proxy:!0}])})],1)}),[],!1,null,"042ce65b",null,null).exports;const mt=u(D({__name:"index",setup(t){const{refs:{serverIp:e}}=o(),{refs:{ftpPort:a,ftpTabsActive:s,ftpTabsList:n}}=V();return{__sfc:!0,serverIp:e,ftpPort:a,ftpTabsActive:s,ftpTabsList:n}}}),(function(){var t=this,e=t._self._c,a=t._self._setupProxy;return e("section",{staticClass:"relative"},[e(Y,{attrs:{type:"nav"},model:{value:a.ftpTabsActive,callback:function(t){a.ftpTabsActive=t},expression:"ftpTabsActive"}},t._l(a.ftpTabsList,(function(s,r){return e(n,{key:r,staticClass:"rounded-default",attrs:{name:s.name,label:s.label}},[e(X,{staticClass:"!mb-12x",attrs:{type:"info",closable:!1},scopedSlots:t._u([{key:"title",fn:function(){return[e("span",[t._v(" "+t._s(t.$t("Ftp.FtpAddress"))+" ftp://"+t._s(a.serverIp||"IP地址")+":"+t._s(a.ftpPort||"端口")+" ")]),e(T,{attrs:{type:"vertical"}}),e("span",[e(i,{attrs:{target:"_self",href:"https://download.bt.cn/win/filezilla/FileZilla-setup.exe"},domProps:{textContent:t._s("下载FTP连接工具(FileZilla, 免费开源)")}})],1)]},proxy:!0}],null,!0)}),e(pt)],1)})),1)],1)}),[],!1,null,null,null,null).exports,ut=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));export{lt as a,ct as b,tt as c,ot as f,ut as i,et as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./EditFtpPwd.js?v=1714377894636","./index85.js?v=1714377894636","./main.js?v=1714377894636","./modulepreload-polyfill.js?v=1714377894636","./vue-lib.js?v=1714377894636","./__commonjsHelpers__.js?v=1714377894636","./preload-helper.js?v=1714377894636","./request-lib.js?v=1714377894636","./locales-lib.js?v=1714377894636","./public-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./ftp.store.js?v=1714377894636","./confirm.js?v=1714377894636","./config.js?v=1714377894636","./QuickConnect.js?v=1714377894636","./SetFtpCapacity.js?v=1714377894636","./index74.js?v=1714377894636","./index77.js?v=1714377894636","./element-lib.js?v=1714377894636","./index42.js?v=1714377894636","./index75.js?v=1714377894636","./index39.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index52.js?v=1714377894636","./index53.js?v=1714377894636","./element-lib.js?v=1714377894636","./index54.js?v=1714377894636","./element-lib.js?v=1714377894636","./index56.js?v=1714377894636","./index57.js?v=1714377894636","./element-lib.js?v=1714377894636","./index48.js?v=1714377894636","./index45.js?v=1714377894636","./index58.js?v=1714377894636","./index59.js?v=1714377894636","./index60.js?v=1714377894636","./index38.js?v=1714377894636","./check.js?v=1714377894636","./index76.js?v=1714377894636","./element-lib.js?v=1714377894636","./logAnalysisCondition.js?v=1714377894636","./index40.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./index41.js?v=1714377894636","./index117.js?v=1714377894636","./radio-button.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./element-lib.js?v=1714377894636","./whiteTable.js?v=1714377894636","./setScanCondition.js?v=1714377894636","./time-select.js?v=1714377894636","./date-util.js?v=1714377894636","./world.js?v=1714377894636","./AddFtpData.js?v=1714377894636","./index110.js?v=1714377894636","./EditFtpPort.js?v=1714377894636","./PawValidity.js?v=1714377894636","./date-picker.js?v=1714377894636","./PermessionData.js?v=1714377894636","./index118.js?v=1714377894636","./ClassfySetting.js?v=1714377894636","./BatchFtpPwd.js?v=1714377894636"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
