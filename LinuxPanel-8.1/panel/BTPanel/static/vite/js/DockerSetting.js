import{n as t,q as s,a as e}from"./main.js?v=1714377894636";import{_ as a}from"./index60.js?v=1714377894636";import{w as i,x as r,o}from"./element-lib.js?v=1714377894636";import{_ as l}from"./index46.js?v=1714377894636";import{e as n,c,h as m,j as u}from"./vue-lib.js?v=1714377894636";import{g as p}from"./docker.store.js?v=1714377894636";import{w as _,x as g,y as d,z as v}from"./docker.popup.js?v=1714377894636";import{q as f,r as x,t as b,u as k}from"./docker.api.js?v=1714377894636";import"./modulepreload-polyfill.js?v=1714377894636";import"./preload-helper.js?v=1714377894636";import"./request-lib.js?v=1714377894636";import"./__commonjsHelpers__.js?v=1714377894636";import"./locales-lib.js?v=1714377894636";import"./public-lib.js?v=1714377894636";import"./index.vue_vue_type_style_index_0_lang.js?v=1714377894636";import"./check.js?v=1714377894636";const D=t(n({__name:"DockerSetting",setup(t,{expose:s}){const{proxy:e}=u(),{refs:{settingData:a,loading:i},getSet:r}=p(),o=c((()=>!a.value.docker_installed||!a.value.docker_compose_installed));return m((async()=>{r(!1)})),s({}),{__sfc:!0,vm:e,settingData:a,loading:i,getSet:r,isInstall:o,openStatus:async t=>{if(i.value=!0,"reset"===t)await f({data:JSON.stringify({act:"restart"})}),r();else{a.value.service_status=!a.value.service_status;const t=await f({data:JSON.stringify({act:a.value.service_status?"start":"stop"})});t.status?e.$message.success(t.msg):e.$message.error(t.msg),r()}},repair:async()=>{try{await e.$confirm({title:"修复docker模块",width:"35rem",message:"修复docker可能会导致容器异常，修复大约5分钟，是否继续修复？"});const t=await x();t.status?e.$message.success(t.msg):e.$message.error(t.msg)}catch(t){}},setMStatus:async t=>{a.value.monitor_status=t;const s=await b({data:JSON.stringify({act:a.value.monitor_status?"start":"stop"})});s.status?e.$message.success(s.msg):e.$message.error(s.msg),r()},save:async t=>{if("date"===t){const t=await k({data:JSON.stringify({save_date:a.value.monitor_save_date})});t.status?e.$message.success(t.msg):e.$message.error(t.msg),r()}},setUrl:async t=>{_(t)},setCompose:async()=>{g()},openConfig:async()=>{d(a.value.daemon_path)},goInstall:async()=>{v()}}}}),(function(){var t=this,n=t._self._c,c=t._self._setupProxy;return n("div",{directives:[{name:"bt-loading",rawName:"v-bt-loading",value:c.loading,expression:"loading"},{name:"bt-loading",rawName:"v-bt-loading:title",value:"正在获取docker设置，请稍候...",expression:"'正在获取docker设置，请稍候...'",arg:"title"}],staticClass:"w-full h-full p-[2px] text-[1.2rem]"},[n(i,{ref:"settingRef",staticClass:"relative w-full text-[1.2rem]",attrs:{size:"large",model:c.settingData,"label-position":"right",labelWidth:"9.6rem"},nativeOn:{submit:function(t){t.preventDefault()}}},[n(r,{staticClass:"text-[1.2rem]",attrs:{prop:"service_status",label:"Docker服务"}},[t._v(" 当前状态："+t._s(c.settingData.service_status?"开启":"停止")+" "),n("span",{staticClass:"iconfont",class:c.settingData.service_status?"icon-start":"icon-stop"}),n(s,{staticClass:"!ml-32x",attrs:{type:"default",title:c.settingData.service_status?"停止":"开启"},on:{click:function(t){return c.openStatus("toggle")}}},[t._v(t._s(c.settingData.service_status?"停止":"开启"))]),n(s,{attrs:{type:"default",title:"重启"},on:{click:function(t){return c.openStatus("reset")}}},[t._v("重启")]),n(s,{directives:[{name:"show",rawName:"v-show",value:!c.settingData.service_status,expression:"!settingData.service_status"}],attrs:{type:"default",title:"修复"},on:{click:function(t){return c.repair()}}},[t._v("修复")])],1),c.settingData.monitor_status?n(r,{staticClass:"mb-[1.2rem] text-[1.2rem]",attrs:{prop:"monitor_status",label:"容器监控"}},[n(l,{on:{change:c.setMStatus},model:{value:c.settingData.monitor_status,callback:function(s){t.$set(c.settingData,"monitor_status",s)},expression:"settingData.monitor_status"}}),n("span",{staticClass:"unit text-[#666] ml-[1.2rem] text-[1.2rem]"},[t._v("*设置容器页面监控开关,关闭后CPU使用率将不再监控")])],1):t._e(),c.settingData.monitor_status?n(r,{staticClass:"check mb-[1.2rem] text-[1.2rem]",attrs:{prop:"monitor_save_date",label:"监控天数"}},[n(o,{staticClass:"!w-[32rem] h-[3.2rem]",model:{value:c.settingData.monitor_save_date,callback:function(s){t.$set(c.settingData,"monitor_save_date",s)},expression:"settingData.monitor_save_date"}}),n(s,{staticClass:"!ml-[.5rem]",attrs:{title:"保存"},on:{click:function(t){return c.save("date")}}},[t._v("保存")]),n("span",{staticClass:"unit text-[#666] ml-[1rem] text-[1.2rem]"},[t._v("*设置容器页面监控保存天数")])],1):t._e(),n(r,{staticClass:"mb-[1.2rem] text-[1.2rem]",attrs:{prop:"url",label:"加速URL"}},[n(o,{staticClass:"!w-[32rem] h-[3.2rem]",attrs:{disabled:""},model:{value:c.settingData.url,callback:function(s){t.$set(c.settingData,"url",s)},expression:"settingData.url"}}),n(s,{staticClass:"!ml-[.5rem]",attrs:{title:"修改"},on:{click:function(t){return c.setUrl(c.settingData.url)}}},[t._v("修改")])],1),n(r,{staticClass:"mb-[1.2rem] text-[1.2rem]",attrs:{prop:"url",label:"docker compose"}},[n(o,{staticClass:"!w-[32rem] h-[3.2rem]",attrs:{disabled:""},model:{value:c.settingData.docker_compose_path,callback:function(s){t.$set(c.settingData,"docker_compose_path",s)},expression:"settingData.docker_compose_path"}}),n(s,{staticClass:"!ml-[.5rem]",attrs:{title:"修改"},on:{click:c.setCompose}},[t._v("修改")]),n("span",{staticClass:"unit text-[#666] ml-[1rem] text-[1.2rem]"},[t._v("*docker compose路径")])],1),n(r,{staticClass:"mb-[1.2rem] text-[1.2rem]",attrs:{prop:"url",label:"配置文件"}},[n(s,{attrs:{title:"全局配置文件"},on:{click:c.openConfig}},[t._v("打开配置文件")])],1)],1),n(a,{attrs:{visible:c.isInstall,width:c.settingData.installing?"40rem":"36rem"}},[n("span",{staticClass:"text-[1.2rem]"},[t._v("当前"+t._s(1===c.settingData.installing?"正在安装":"未安装")+"docker或docker-compose")]),t._v("， "),1!==c.settingData.installing?n(e,{staticClass:"!font-bold text-[1.2rem]",on:{click:c.goInstall}},[t._v("立即安装")]):t._e(),1===c.settingData.installing?n("span",[t._v("请稍后...")]):t._e()],1)],1)}),[],!1,null,"4956ef96",null,null).exports;export{D as default};
